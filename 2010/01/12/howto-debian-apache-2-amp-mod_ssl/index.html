<!DOCTYPE html><!--

                                      |
                                     /|
                                   ,' |
                                  .   |
                                    | |
                                 ' '| |
                                / / | |
       _,.-\"\"--._              / /  | |
     ,'          `.           j '   ' '
   ,'              `.         ||   / ,                         ___..--,
  /                  \\        ' `.'`.-.,-\".  .       _..---\"\"'' __, ,'
 /                    \\        \\` .\"`      `\"'\\   ,'\"_..--''\"\"\"'.'.'
.                      .      .'-'             \\,' ,'         ,','
|                      |      ,`               ' .`         .' /
|                      |     /          ,\"`.  ' `-. _____.-' .'
'                      |..---.|,\".      | | .  .-'\"\"   __.,-'
 .                   ,'       ||,|      |.' |    |\"\"`'\"
  `-._   `._.._____  |        || |      `._,'    |
      `.   .       `\".     ,'\"| \"  `'           ,+.
        \\  '         |    '   |   .....        .'  `.
         .'          '     7  \".              ,'     \\
                   ,'      |    `..        _,'      F
                  .        |,      `'----''         |
                  |      ,\"j  /                   | '
                  `     |  | .                 | `,'
                   .    |  `.|                 |/
                    `-..'   ,'                .'
                            | \\             ,''
                            |  `,'.      _,' /
                            |    | ^.  .'   /
                             `-'.' j` V    /
                                   |      /
                                   |     /
                                   |   ,'
                                    `\"\"

//--><html lang=en> <head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0, minimum-scale=1.0"><link rel=alternate href=https://kura.gg hreflang=en><link rel=dns-prefetch href=https://kura.gg><link href=https://kura.gg/feeds/rss.xml type=application/rss+xml rel=alternate title=kura.gg><link href=https://kura.gg/feeds/atom.xml type=application/atom+xml rel=alternate title=kura.gg><meta property=og:site_name content=kura.gg><meta property=og:type content=article><meta property=og:title content="HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert."><meta content=https://kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/ property=og:url><meta property=og:description content="This is gonna be quite a simple tutorial that should be the same (excluding pathing and apt) across other Linux distros. Installation First off we’ll get Apache and mod_ssl install sudo apt-get install apache2 SSL should be enabled by default, if not run the following sudo a2enmod ssl SSL certificate There are several ways of doing this, the first you need to figure out is if you want a self signed certificate or one signed by a provider like GeoTrust, this type is not free. In this article I’ll cover both, starting with self signed. Self signed sudp mkdir /etc/apache2/ssl sudo /usr/sbin/make-ssl-cert /usr/share/ssl-cert/ssleay.cnf /etc/apache2/ssl/apache.pem Provider signed Please note, this type of certificate has to be paid for, prices at time of writing range from £15/year to £2,000/year. There are actually some more …"><meta property=og:image content=https://kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/index.png><meta property=og:image:width content=1920><meta property=og:image:height content=1080><meta property=twitter:title content="HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert."><meta content=https://kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/ property=twitter:url><meta property=twitter:description content="This is gonna be quite a simple tutorial that should be the same (excluding pathing and apt) across other Linux distros. Installation First off we’ll get Apache and mod_ssl install sudo apt-get install apache2 SSL should be enabled by default, if not run the following sudo a2enmod ssl SSL certificate There are several ways of doing this, the first you need to figure out is if you want a self signed certificate or one signed by a provider like GeoTrust, this type is not free. In this article I’ll cover both, starting with self signed. Self signed sudp mkdir /etc/apache2/ssl sudo /usr/sbin/make-ssl-cert /usr/share/ssl-cert/ssleay.cnf /etc/apache2/ssl/apache.pem Provider signed Please note, this type of certificate has to be paid for, prices at time of writing range from £15/year to £2,000/year. There are actually some more …"><meta property=twitter:image content=https://kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/index.png><meta property=twitter:card content=summary_large_image><meta property=twitter:image:width content=1920><meta property=twitter:image:height content=1080><link rel=icon href=/favicon.png type=image/png sizes="16x16 32x32 48x48 64x64 128x128 256x256"><link rel=icon href=/favicon.ico type=image/vnd.microsoft.icon sizes="16x16 32x32 48x48 64x64 128x128 256x256"><title>HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert.</title></head> <body> <div class="eevee-layout mdl-layout mdl-js-layout mdl-color--grey-50"> <header class="eevee-header mdl-color--grey-50 mdl-color-text--grey-800" itemscope itemtype=http://schema.org/WPHeader> <div class=mdl-layout__header-row> <div aria-expanded=false role=button tabindex=0 class="mdl-layout__drawer-button mdl-color-text--accent eevee-mobile-button mdl-layout--small-screen-only"> <i class=material-icons>&#xE5D2;</i> </div> <span class="eevee-logo mdl-color-text--accent mdl-layout-title"> <h2 id=top> <a href=https://kura.gg rel=bookmark title=kura.gg> kura.gg </a> </h2> </span> <div class=mdl-layout-spacer role=presentation></div> <nav class="eevee-nav mdl-navigation mdl-layout--large-screen-only" itemscope itemtype=http://schema.org/SiteNavigationElement aria-label="Header navigation"> <a class="mdl-color-text--accent mdl-navigation__link" href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i class=material-icons aria-hidden=true>&#xE86F;</i> Blackhole </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/eevee itemprop=url rel=bookmark title=Eevee> <i class=material-icons aria-hidden=true>&#xE871;</i> Eevee </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i class=material-icons aria-hidden=true>&#xE871;</i> Hauntr </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i class=material-icons aria-hidden=true>&#xE871;</i> Ghastly </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/pelican-plugins itemprop=url rel=bookmark title="Pelican Plugins"> <i class=material-icons aria-hidden=true>&#xE86F;</i> Pelican Plugins </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/contact/ itemprop=url rel=bookmark title=Contact> <i class=material-icons aria-hidden=true>&#xE0B7;</i> Contact </a> <a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons>&#xE02F;</i> Archives </a> <a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/rss.xml title=RSS itemprop=url> <i class=material-icons>&#xE0E5;</i> RSS </a> </nav> </div> </header> <div class="eevee-mobile-header mdl-layout__drawer mdl-color--white" aria-hidden=true> <span class=mdl-layout-title> <h2 class="eevee-mobile-logo mdl-color-text--accent"> kura.gg </h2> </span> <div class="mdl-navigation mdl-color--white"> <nav class="eevee-nav mdl-navigation" itemscope itemtype=http://schema.org/SiteNavigationElement aria-label="Header navigation"> <a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg itemprop=url rel=bookmark> <i class=material-icons aria-hidden=true> &#xE88A; </i> Home </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i class=material-icons aria-hidden=true>&#xE86F;</i> Blackhole </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/eevee itemprop=url rel=bookmark title=Eevee> <i class=material-icons aria-hidden=true>&#xE871;</i> Eevee </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i class=material-icons aria-hidden=true>&#xE871;</i> Hauntr </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i class=material-icons aria-hidden=true>&#xE871;</i> Ghastly </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/pelican-plugins itemprop=url rel=bookmark title="Pelican Plugins"> <i class=material-icons aria-hidden=true>&#xE86F;</i> Pelican Plugins </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/contact/ itemprop=url rel=bookmark title=Contact> <i class=material-icons aria-hidden=true>&#xE0B7;</i> Contact </a> <a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons>&#xE02F;</i> Archives </a> <a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/rss.xml title=RSS itemprop=url> <i class=material-icons>&#xE0E5;</i> RSS </a> </nav> </div> </div> <div class="eevee-ribbon mdl-color--primary-dark" role=presentation> </div> <main class="eevee-main mdl-layout__content"> <div class="eevee-container mdl-grid"> <div role=presentation class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone"> </div> <div class="eevee-content mdl-color--white mdl-shadow--2dp mdl-color-text--grey-800 mdl-cell mdl-cell--8-col" aria-label="Main content"> <article itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content=apache,debian,mod_ssl,ssl> <meta itemprop=keywords content=tutorials> <div class=eevee-share> <ul class="social-share mdl-navigation"> <li class="social-share__link social-share__link--twitter"> <a href="https://twitter.com/intent/tweet?text=HOWTO%3A%20Debian%2C%20Apache%202%20%26%20mod_ssl%20with%20self%20signed%20cert.%20or%20officially%20signed%20cert.&url=https%3A//kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/" title="Share 'HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert.' on Twitter" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235'); return false;"> <i class=fa aria-hidden=true>&#xF099;</i> </a> </li> <li class="social-share__link social-share__link--facebook"> <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A//kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/" title="Share 'HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert.' on Facebook" onclick="window.open(this.href, 'facebook-share', 'width=580,height=296'); return false;"> <i class=fa aria-hidden=true>&#xF09A;</i> </a> </li> <li class="social-share__link social-share__link--email"> <a href="mailto:?subject=HOWTO%3A%20Debian%2C%20Apache%202%20%26%20mod_ssl%20with%20self%20signed%20cert.%20or%20officially%20signed%20cert.&body=I%20thought%20you%20might%20like%20'HOWTO%3A%20Debian%2C%20Apache%202%20%26%20mod_ssl%20with%20self%20signed%20cert.%20or%20officially%20signed%20cert.'%20--%20https%3A//kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/" title="Share 'HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert.' via email"> <i class=material-icons aria-hidden=true> &#xE0E1; </i> </a> </li> </ul> </div> <div class=eevee-article> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-01-12T22:57:00+00:00 itemprop=datePublished> 12 Jan 2010 </time>&nbsp;-- 4 min read </div> <h1 itemprop=name> <a href=https://kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/ rel=bookmark title="Permalink to 'HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert.'" itemprop=url> <span class=caps>HOWTO</span>: Debian, Apache 2 <span class=amp>&amp;</span> mod_ssl with self signed cert. or officially signed&nbsp;cert. </a> </h1> <section class=eevee-toc> <h2 id=toc> Contents </h2> <nav class=eevee-toc-ribbon> <div class=toc id> <p class=topic-title>Contents</p> <ul class=simple> <li><a class="reference internal" href=#installation id=toc-entry-1>Installation</a></li> <li><a class="reference internal" href=#ssl-certificate id=toc-entry-2><span class=caps>SSL</span> certificate</a><ul> <li><a class="reference internal" href=#self-signed id=toc-entry-3>Self signed</a></li> <li><a class="reference internal" href=#provider-signed id=toc-entry-4>Provider signed</a><ul> <li><a class="reference internal" href=#without-a-passphrase id=toc-entry-5>Without a passphrase</a></li> <li><a class="reference internal" href=#with-a-passphrase id=toc-entry-6>With a passphrase</a></li> </ul> </li> </ul> </li> <li><a class="reference internal" href=#apache-configuration id=toc-entry-7>Apache configuration</a></li> <li><a class="reference internal" href=#the-nasty-ssl-passphrase-hack id=toc-entry-8>The nasty <span class=caps>SSL</span> passphrase hack…</a></li> </ul> </div> </nav> </section> <section itemprop=articleBody class=article-content> <p>This is gonna be quite a simple tutorial that should be the same (excluding pathing and apt) across other Linux distros.</p> <div class=section id=installation> <h2>Installation</h2> <p>First off we’ll get Apache and mod_ssl install</p> <div class=highlight><pre><span></span>sudo apt-get install apache2
</pre></div> <p><span class=caps>SSL</span> should be enabled by default, if not run the following</p> <div class=highlight><pre><span></span>sudo a2enmod ssl
</pre></div> </div> <div class=section id=ssl-certificate> <h2><span class=caps>SSL</span> certificate</h2> <p>There are several ways of doing this, the first you need to figure out is if you want a self signed certificate or one signed by a provider like GeoTrust, this type is not free. In this article I’ll cover both, starting with self signed.</p> <div class=section id=self-signed> <h3>Self signed</h3> <div class=highlight><pre><span></span>sudp mkdir /etc/apache2/ssl
sudo /usr/sbin/make-ssl-cert /usr/share/ssl-cert/ssleay.cnf /etc/apache2/ssl/apache.pem
</pre></div> </div> <div class=section id=provider-signed> <h3>Provider signed</h3> <p>Please note, this type of certificate has to be paid for, prices at time of writing range from £15/year to £2,000/year.</p> <p>There are actually some more options when it comes to generating a key for this <span class=caps>CRT</span>, the first way creates a key that does not require a passphrase, the second way requires a passphrase and, unless you make a special change to your Apache config along with a small bash script (will go through later) will ask you for the passphrase for each key every time you restart Apache.</p> <div class=section id=without-a-passphrase> <h4>Without a passphrase</h4> <div class=highlight><pre><span></span>openssl genrsa -out DOMAINNAME.key <span class=m>4096</span>
</pre></div> </div> <div class=section id=with-a-passphrase> <h4>With a passphrase</h4> <div class=highlight><pre><span></span>openssl genrsa -des3 -out DOMAINNAME.key <span class=m>4096</span>
</pre></div> <p>Replace <span class=caps>DOMAINNAME</span> with your domain name, I find this makes it much easier if all of my certs and keys are named accordingly, but that’s just me. I also generally use at least a 4096bit modulus, feel free to change this to whatever you wish, some signers will only take a key of a specific size.</p> <p>Next up is actually generating the <span class=caps>CSR</span> from the key.</p> <div class=highlight><pre><span></span>openssl req -new -key DOMAINNAME.key &gt; DOMAINNAME.csr
</pre></div> <p>As a note, it’s very badly wordly but <span class=caps>COMMON</span> <span class=caps>NAME</span> is the actual fully qualified domain name that you want to use <span class=caps>SSL</span> on, if your domain name is example.com and you want this to work on www.example.com but did not buy a wildcard certificate then put www.example.com as your Common Name.</p> <p>Once generated, send this off to your signer and they will send you a <span class=caps>CRT</span> in return.</p> <p>Once you have your <span class=caps>CRT</span> it’s time to put them on the server, move your key file to Debian’s <span class=caps>SSL</span> directory.</p> <p>Put your <span class=caps>CRT</span> on the server and move it to Debian’s <span class=caps>SSL</span> directory too.</p> </div> </div> </div> <div class=section id=apache-configuration> <h2>Apache configuration</h2> <p>First thing we need to do is check your Apache ports.conf file to make sure <span class=caps>SSL</span> is enabled.</p> <p>It should have the following at the bottom.</p> <div class=highlight><pre><span></span><span class=nt>&lt;IfModule</span><span class=w> </span><span class=s>mod_ssl.c</span><span class=nt>&gt;</span><span class=w></span>
<span class=w>    </span><span class=c># SSL name based virtual hosts are not yet supported, therefore no</span><span class=w></span>
<span class=w>    </span><span class=c># NameVirtualHost statement here</span><span class=w></span>
<span class=w>    </span><span class=nb>Listen</span><span class=w> </span><span class=m>443</span><span class=w></span>
<span class=nt>&lt;/IfModule&gt;</span><span class=w></span>
</pre></div> <p>Now that’s sorted we’ll move on to your actual virtualhost.</p> <div class=highlight><pre><span></span>sudo nano /etc/apache2/sites-available/DOMAINNAME.conf
</pre></div> <p>We’ll use a config template I’ve always used, feel free to edit it at need.</p> <div class=highlight><pre><span></span><span class=nt>&lt;VirtualHost</span><span class=w> </span><span class=s>*</span><span class=nt>&gt;</span><span class=w></span>
<span class=w>    </span><span class=nb>ServerAdmin</span><span class=w> </span>webmaster@DOMAINNAME<span class=w></span>
<span class=w>    </span><span class=nb>ServerName</span><span class=w> </span>DOMAINNAME<span class=w></span>
<span class=w>    </span><span class=nb>DocumentRoot</span><span class=w> </span><span class=sx>/var/www/DOMAINNAME</span><span class=w></span>

<span class=w>    </span><span class=nt>&lt;Directory</span><span class=w> </span><span class=s>/</span><span class=nt>&gt;</span><span class=w></span>
<span class=w>        </span><span class=nb>Options</span><span class=w> </span>FollowSymLinks<span class=w></span>
<span class=w>        </span><span class=nb>AllowOverride</span><span class=w> </span><span class=k>None</span><span class=w></span>
<span class=w>    </span><span class=nt>&lt;/Directory&gt;</span><span class=w></span>

<span class=w>    </span><span class=nt>&lt;Directory</span><span class=w> </span><span class=s>/var/www/DOMAINNAME</span><span class=nt>&gt;</span><span class=w></span>
<span class=w>        </span><span class=nb>Options</span><span class=w> </span>-Indexes<span class=w> </span>FollowSymLinks<span class=w> </span>MultiViews<span class=w></span>
<span class=w>        </span><span class=nb>AllowOverride</span><span class=w> </span><span class=k>All</span><span class=w></span>
<span class=w>        </span><span class=nb>Order</span><span class=w> </span>allow,deny<span class=w></span>
<span class=w>        </span><span class=nb>allow</span><span class=w> </span>from<span class=w> </span><span class=k>all</span><span class=w></span>
<span class=w>    </span><span class=nt>&lt;/Directory&gt;</span><span class=w></span>
<span class=nt>&lt;/VirtualHost&gt;</span><span class=w></span>

<span class=nt>&lt;VirtualHost</span><span class=w> </span><span class=s>*:443</span><span class=nt>&gt;</span><span class=w></span>
<span class=w>    </span><span class=nb>ServerAdmin</span><span class=w> </span>webmaster@DOMAINNAME<span class=w></span>
<span class=w>    </span><span class=nb>ServerName</span><span class=w> </span>DOMAINNAME<span class=w></span>
<span class=w>    </span><span class=nb>DocumentRoot</span><span class=w> </span><span class=sx>/var/www/DOMAINNAME</span><span class=w></span>

<span class=w>    </span><span class=nt>&lt;Directory</span><span class=w> </span><span class=s>/</span><span class=nt>&gt;</span><span class=w></span>
<span class=w>        </span><span class=nb>Options</span><span class=w> </span>FollowSymLinks<span class=w></span>
<span class=w>        </span><span class=nb>AllowOverride</span><span class=w> </span><span class=k>None</span><span class=w></span>
<span class=w>    </span><span class=nt>&lt;/Directory&gt;</span><span class=w></span>

<span class=w>    </span><span class=nt>&lt;Directory</span><span class=w> </span><span class=s>/var/www/DOMAINNAME</span><span class=nt>&gt;</span><span class=w></span>
<span class=w>        </span><span class=nb>Options</span><span class=w> </span>-Indexes<span class=w> </span>FollowSymLinks<span class=w> </span>MultiViews<span class=w></span>
<span class=w>        </span><span class=nb>AllowOverride</span><span class=w> </span><span class=k>All</span><span class=w></span>
<span class=w>        </span><span class=nb>Order</span><span class=w> </span>allow,deny<span class=w></span>
<span class=w>        </span><span class=nb>allow</span><span class=w> </span>from<span class=w> </span><span class=k>all</span><span class=w></span>
<span class=w>    </span><span class=nt>&lt;/Directory&gt;</span><span class=w></span>

<span class=w>     </span><span class=nb>SSLEngine</span><span class=w> </span><span class=k>On</span><span class=w></span>
<span class=w>     </span><span class=nb>SSLCertificateFile</span><span class=w> </span><span class=sx>/etc/apache2/ssl/apache.pem</span><span class=w></span>
<span class=nt>&lt;/VirtualHost&gt;</span><span class=w></span>
</pre></div> <p>If you used the self signed approach then the above <strong>SSLCertificateFile</strong> will be correct, if not replace it with what is shown below.</p> <div class=highlight><pre><span></span><span class=nb>SSLCertificateFile</span><span class=w> </span><span class=sx>/etc/ssl/certs/DOMAINANE.crt</span><span class=w></span>
<span class=nb>SSLCertificateKeyFile</span><span class=w> </span><span class=sx>/etc/ssl/private/DOMAINNAME.key</span><span class=w></span>
</pre></div> <p>If you received a bundle file as well as your domains <span class=caps>CRT</span> then copy it to /etc/ssl/certs/ on your server and add the following line after <strong>SSLCertificateKeyFile</strong>.</p> <div class=highlight><pre><span></span><span class=nb>SSLCertificateChainFile</span><span class=w> </span><span class=sx>/etc/ssl/certs/DOMAINNAME.bundle.crt</span><span class=w></span>
</pre></div> <p>Save and exit, with that done we need to enable the site.</p> <div class=highlight><pre><span></span>sudo a2ensite DOMAINNAME.conf
</pre></div> <p>If you used a self signed certificate or passphrase-free key, this should be all you need to do, feel free to test your config and restart Apache and test your site.</p> <div class=highlight><pre><span></span>sudo apache2ctrl configtest
sudo /etc/init.d/apache2 restart
</pre></div> <p>If you used a key with a passphrase you will either have to type your passphrase in each time you restart Apache or, use this wonderful Apache supported “hack” below…</p> </div> <div class=section id=the-nasty-ssl-passphrase-hack> <h2>The nasty <span class=caps>SSL</span> passphrase hack…</h2> <div class=highlight><pre><span></span>sudo nano /etc/apache2/apache2.conf
</pre></div> <p>Place the following at the end of the file</p> <div class=highlight><pre><span></span><span class=nb>SSLPassPhraseDialog</span><span class=w> </span>exec:/etc/apache2/ssl.sh<span class=w></span>
</pre></div> <p>Now we need to create this bash file, so…</p> <div class=highlight><pre><span></span>sudo nano /etc/apache2/ssl.sh
</pre></div> <p>Place the following in it</p> <div class=highlight><pre><span></span><span class=ch>#!/bin/bash</span>
<span class=k>if</span> <span class=o>[</span> <span class=nv>$1</span> <span class=o>=</span> <span class=s1>'DOMAINNAME:443'</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
    <span class=nb>echo</span> <span class=s2>"PASSPHRASE"</span>
<span class=k>fi</span>
</pre></div> <p>This is actually supported by Apache, when it’s restarted it will call this script for every <span class=caps>SSL</span> virtualhost you have enabled, passing the hostname and the port through to the script as $1, so you can add multiple sites to this file.</p> <p>Now save and make it only usable by root.</p> <div class=highlight><pre><span></span>sudo chmod <span class=m>0700</span> /etc/apache2/ssl.sh
sudo chown root:root /etc/apache2/ssl.sh
</pre></div> <p>Now we can follow the config test and restart call from above.</p> <div class=highlight><pre><span></span>sudo apache2ctl configtest
sudo /etc/init.d/apache2 restart
</pre></div> <p>And that is it, we should be done!</p> </div> </section> </div> <div class=eevee-related> <section> <h2>Related articles</h2> <ul> <li> <a href=https://kura.gg/2010/01/15/howto-debian-apache2-ssl-multiple-vhosts/ rel=bookmark title="Permalink to 'HOWTO: Debian - Apache 2 SSL on multiple virtual hosts'" itemprop=url> <span class=caps>HOWTO</span>: Debian - Apache 2 <span class=caps>SSL</span> on multiple virtual&nbsp;hosts </a> </li> <li> <a href=https://kura.gg/2010/03/03/convert-der-certificate-to-pem/ rel=bookmark title="Permalink to 'Convert DER certificate to PEM'" itemprop=url> Convert <span class=caps>DER</span> certificate to <span class=caps>PEM</span> </a> </li> <li> <a href=https://kura.gg/2010/02/14/more-nginx-proxy_cache-optimizations-and-nginx-load-balancing/ rel=bookmark title="Permalink to 'More nginx proxy_cache optimizations and nginx load balancing'" itemprop=url> More nginx proxy_cache optimizations and nginx load&nbsp;balancing </a> </li> <li> <a href=https://kura.gg/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/ rel=bookmark title="Permalink to 'nginx, proxy_cache and reverse proxying explained & benchmarked'" itemprop=url> nginx, proxy_cache and reverse proxying explained <span class=amp>&amp;</span>&nbsp;benchmarked </a> </li> <li> <a href=https://kura.gg/2010/01/14/howto-debian-server-security/ rel=bookmark title="Permalink to 'HOWTO: Debian server security'" itemprop=url> <span class=caps>HOWTO</span>: Debian server&nbsp;security </a> </li> </ul> </section> </div> <div class=eevee-ac> <header class=eevee-ac__header> <div class=eevee-ac-author__text> <h2>Kura</h2> <p>Anarchist. Pessimist. Bipolar. Hacker. Hyperpolyglot. Musician. Ex-(semi-)pro gamer. They/Them.</p> <p> <a href=https://kura.gg/authors/kura/ itemprop=url title="Read more articles by Kura"> Read more articles by Kura </a> </p> <nav> <ul class=eevee-ac-author__social> <li class=eevee-ac-author-social__link> <a class="mdl-color-text--accent mdl-navigation__link" href=https://github.com/kura itemprop=url rel=bookmark title="kura on GitHub"> <i class=fa aria-hidden=true>&#xF09B;</i> </a> </li> </ul> </nav> </div> <img src=/images/avatar.png class=eevee-ac-author__avatar alt=Kura> </header> </div> </article> <a href=https://github.com/kura/kura.gg/blob/main/content/howto-debian-apache-2-amp-mod_ssl.rst id=view-source title="View 'HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert.' on GitHub" class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--raised mdl-color--accent mdl-color-text--white"> <i class=material-icons>&#xE86F;</i> View Source </a> </div> </div> </main> <div class="eevee-pagination__container eevee-container mdl-grid"> <div role=presentation class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone"> </div> <div class="mdl-color-text--grey-800 mdl-cell mdl-cell--8-col"> <nav class="eevee-pagination mdl-cell mdl-cell--12-col" itemscope itemtype=http://schema.org/SiteNavigationElement aria-label=Pagination> <a href=https://kura.gg/2010/01/13/howto-debian-sudoers-explained/ class=eevee-nav__button itemprop=url rel=bookmark title=Newer> <button class="mdl-button mdl-button--icon mdl-color--white mdl-color-text--grey-900" role=presentation> <i class=material-icons>&#xE5C4;</i> </button> Newer </a> <div class=eevee-spacer></div> <a href=https://kura.gg/2010/01/12/apache-2-nginx-wordpress-mu-follow-up/ class=eevee-nav__button itemprop=url rel=bookmark title=Older> Older <button class="mdl-button mdl-button--icon mdl-color--white mdl-color-text--grey-900" role=presentation> <i class=material-icons>&#xE5C8;</i> </button> </a> </nav> </div> </div> <footer class=mdl-mega-footer itemscope itemtype=http://schema.org/SiteNavigationElement> <div class=mdl-mega-footer--top-section> <div class=mdl-mega-footer--drop-down-section> <ul class=mdl-mega-footer--link-list> <li> <a href=#top itemprop=url title="Back to the top of the page"> Back to the top of the page </a> </li> </ul> </div> </div> <div class=mdl-mega-footer--middle-section itemscope itemtype=http://schema.org/SiteNavigationElement aria-label="Footer navigation"> <div class=mdl-mega-footer--drop-down-section> <h1 class=mdl-mega-footer--heading>Menu</h1> <ul class=mdl-mega-footer--link-list> <li> <a href=/contact/ itemprop=url rel=bookmark title=Contact> <i class=material-icons aria-hidden=true>&#xE0B7;</i> Contact </a> </li> <li> <a href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons>&#xE02F;</i> Archives </a> </li> <li> <a href=https://kura.gg/feeds/rss.xml title=RSS itemprop=url> <i class=material-icons>&#xE0E5;</i> RSS </a> </li> </ul> </div> <div class=mdl-mega-footer--drop-down-section> <h1 class=mdl-mega-footer--heading>Social</h1> <ul class=mdl-mega-footer--link-list> <li> <a href=https://github.com/kura itemprop=url rel=bookmark title=GitHub> <i class=fa aria-hidden=true>&#xF09B;</i> Github </a> </li> </ul> </div> <div class=mdl-mega-footer--drop-down-section> <h1 class=mdl-mega-footer--heading>Links</h1> <ul class=mdl-mega-footer--link-list> <li> <a href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i class=material-icons aria-hidden=true>&#xE86F;</i> Blackhole </a> </li> <li> <a href=/eevee itemprop=url rel=bookmark title=Eevee> <i class=material-icons aria-hidden=true>&#xE871;</i> Eevee </a> </li> <li> <a href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i class=material-icons aria-hidden=true>&#xE871;</i> Hauntr </a> </li> <li> <a href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i class=material-icons aria-hidden=true>&#xE871;</i> Ghastly </a> </li> <li> <a href=/pelican-plugins itemprop=url rel=bookmark title="Pelican Plugins"> <i class=material-icons aria-hidden=true>&#xE86F;</i> Pelican Plugins </a> </li> </ul> </div> </div> <div class=mdl-mega-footer--bottom-section> <div class=mdl-logo> <a href=https://kura.gg rel=bookmark itemprop=url title=kura.gg> kura.gg </a> </div> <ul class="eevee-footer mdl-mega-footer--link-list"> <li>Powered by love &amp; rainbow sparkles.</li> <li>Source code and content released under the <a href=/license/ title="MIT license">MIT license</a>.</li> </ul> </div> </footer> </div> <link rel=stylesheet href=https://kura.gg/theme/css/eevee.min.css?1c9d8344> <script async src=https://kura.gg/theme/js/eevee.min.js?1841d254></script> </body> </html>