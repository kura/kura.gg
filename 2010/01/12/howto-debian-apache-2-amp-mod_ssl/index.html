<!doctype html><html lang=en><meta charset=utf-8><meta content=width=device-width,initial-scale=1.0,minimum-scale=1.0 name=viewport><link href=https://kura.gg hreflang=en rel=alternate><link href=https://kura.gg rel=dns-prefetch><link href=https://kura.gg/theme/css/eevee.min.css?1c9d8344 rel=stylesheet><script async src=https://kura.gg/theme/js/eevee.min.js?1841d254></script><link href=https://kura.gg/feeds/rss.xml rel=alternate title=kura.gg type=application/rss+xml><link href=https://kura.gg/feeds/atom.xml rel=alternate title=kura.gg type=application/atom+xml><meta content=kura.gg property=og:site_name><meta content=article property=og:type><meta content="HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert." property=og:title><meta content=https://kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/ property=og:url><meta content="This is gonna be quite a simple tutorial that should be the same (excluding pathing and apt) across other Linux distros. Installation First off we’ll get Apache and mod_ssl install sudo apt-get install apache2 SSL should be enabled by default, if not run the following sudo a2enmod ssl SSL certificate There are several ways of doing this, the first you need to figure out is if you want a self signed certificate or one signed by a provider like GeoTrust, this type is not free. In this article I’ll cover both, starting with self signed. Self signed sudp mkdir /etc/apache2/ssl sudo /usr/sbin/make-ssl-cert /usr/share/ssl-cert/ssleay.cnf /etc/apache2/ssl/apache.pem Provider signed Please note, this type of certificate has to be paid for, prices at time of writing range from £15/year to £2,000/year. There are actually some more options …" property=og:description><meta content=https://kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/index.png property=og:image><meta content=1920 property=og:image:width><meta content=1080 property=og:image:height><meta content="HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert." property=twitter:title><meta content=https://kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/ property=twitter:url><meta content="This is gonna be quite a simple tutorial that should be the same (excluding pathing and apt) across other Linux distros. Installation First off we’ll get Apache and mod_ssl install sudo apt-get install apache2 SSL should be enabled by default, if not run the following sudo a2enmod ssl SSL certificate There are several ways of doing this, the first you need to figure out is if you want a self signed certificate or one signed by a provider like GeoTrust, this type is not free. In this article I’ll cover both, starting with self signed. Self signed sudp mkdir /etc/apache2/ssl sudo /usr/sbin/make-ssl-cert /usr/share/ssl-cert/ssleay.cnf /etc/apache2/ssl/apache.pem Provider signed Please note, this type of certificate has to be paid for, prices at time of writing range from £15/year to £2,000/year. There are actually some more options …" property=twitter:description><meta content=https://kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/index.png property=twitter:image><meta content=summary_large_image property=twitter:card><meta content="Written by" property=twitter:label1><meta content=Kura property=twitter:data1><meta content="Estimated reading time" property=twitter:label2><meta content="4 min read" property=twitter:data2><meta content=1920 property=twitter:image:width><meta content=1080 property=twitter:image:height><script type=application/ld+json>
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "HOWTO: Debian, Apache 2 &amp; mod_ssl with self signed cert. or officially signed cert.",
    "url": "https://kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/",
    "description": "This is gonna be quite a simple tutorial that should be the same (excluding pathing and apt) across other Linux distros. Installation First off we’ll get Apache and mod_ssl install sudo apt-get install apache2 SSL should be enabled by default, if not run the following sudo a2enmod ssl SSL certificate There are several ways of doing this, the first you need to figure out is if you want a self signed certificate or one signed by a provider like GeoTrust, this type is not free. In this article I’ll cover both, starting with self signed. Self signed sudp mkdir /etc/apache2/ssl sudo /usr/sbin/make-ssl-cert /usr/share/ssl-cert/ssleay.cnf /etc/apache2/ssl/apache.pem Provider signed Please note, this type of certificate has to be paid for, prices at time of writing range from £15/year to £2,000/year. There are actually some more options …",
    "author": {
        "@type": "Person",
        "name": "Kura",
        "url": "https://kura.gg/authors/kura/"
    },
    "publisher": {
        "@type": "Organization",
        "name": "kura.gg",
        "url": "https://kura.gg/authors/kura/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://kura.gg/favicon.png"
        }
    },
    "mainEntityOfPage": "https://kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/",
    "image": "https://kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/index.png",
    "datePublished": "2010-01-12T22:57:00+00:00"
}
</script><link sizes="16x16 32x32 48x48 64x64 128x128 256x256" href=/favicon.png rel=icon type=image/png><link sizes="16x16 32x32 48x48 64x64 128x128 256x256" href=/favicon.ico rel=icon type=image/vnd.microsoft.icon><title>HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert.</title><body><div class="eevee-layout mdl-layout mdl-js-layout mdl-color--grey-50"><header class="eevee-header mdl-color--grey-50 mdl-color-text--grey-800" itemscope itemtype=http://schema.org/WPHeader><div class=mdl-layout__header-row><div class="mdl-layout__drawer-button mdl-color-text--accent eevee-mobile-button mdl-layout--small-screen-only" aria-expanded=false role=button tabindex=0><i class=material-icons></i></div><span class="eevee-logo mdl-color-text--accent mdl-layout-title"> <h2 id=top><a href=https://kura.gg rel=bookmark title=kura.gg> kura.gg </a></h2> </span><div class=mdl-layout-spacer role=presentation></div><nav aria-label="Header navigation" class="eevee-nav mdl-navigation mdl-layout--large-screen-only" itemscope itemtype=http://schema.org/SiteNavigationElement><a class="mdl-color-text--accent mdl-navigation__link" href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons></i> Blackhole </a><a class="mdl-color-text--accent mdl-navigation__link" href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons></i> Eevee </a><a class="mdl-color-text--accent mdl-navigation__link" href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons></i> Hauntr </a><a class="mdl-color-text--accent mdl-navigation__link" href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons></i> Ghastly </a><a class="mdl-color-text--accent mdl-navigation__link" title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons></i> Pelican Plugins </a><a class="mdl-color-text--accent mdl-navigation__link" href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons></i> Contact </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons></i> Archives </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons></i> RSS </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons></i> Atom </a></nav></div></header><div class="eevee-mobile-header mdl-layout__drawer mdl-color--white" aria-hidden=true><span class=mdl-layout-title> <h2 class="eevee-mobile-logo mdl-color-text--accent">kura.gg</h2> </span><div class="mdl-navigation mdl-color--white"><nav aria-label="Header navigation" class="eevee-nav mdl-navigation" itemscope itemtype=http://schema.org/SiteNavigationElement><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons>  </i> Home </a><a class="mdl-color-text--accent mdl-navigation__link" href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons></i> Blackhole </a><a class="mdl-color-text--accent mdl-navigation__link" href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons></i> Eevee </a><a class="mdl-color-text--accent mdl-navigation__link" href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons></i> Hauntr </a><a class="mdl-color-text--accent mdl-navigation__link" href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons></i> Ghastly </a><a class="mdl-color-text--accent mdl-navigation__link" title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons></i> Pelican Plugins </a><a class="mdl-color-text--accent mdl-navigation__link" href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons></i> Contact </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons></i> Archives </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons></i> RSS </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons></i> Atom </a></nav></div></div><div class="eevee-ribbon mdl-color--primary-dark" role=presentation></div><main class="eevee-main mdl-layout__content"><div class="eevee-container mdl-grid"><div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone" role=presentation></div><div aria-label="Main content" class="eevee-content mdl-color--white mdl-shadow--2dp mdl-color-text--grey-800 mdl-cell mdl-cell--8-col"><article itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=apache,debian,mod_ssl,ssl itemprop=keywords><meta content=tutorials itemprop=keywords><div class=eevee-share><ul class="social-share mdl-navigation"><li class="social-share__link social-share__link--twitter"><a onclick="window.open(this.href, 'twitter-share', 'width=550,height=235'); return false;" title="Share 'HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert.' on Twitter" href=https://twitter.com/intent/tweet?text=HOWTO%3A%20Debian%2C%20Apache%202%20%26%20mod_ssl%20with%20self%20signed%20cert.%20or%20officially%20signed%20cert.&url=https%3A//kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/> <i aria-hidden=true class=fa></i> </a><li class="social-share__link social-share__link--facebook"><a onclick="window.open(this.href, 'facebook-share', 'width=580,height=296'); return false;" title="Share 'HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert.' on Facebook" href=https://www.facebook.com/sharer/sharer.php?u=https%3A//kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/> <i aria-hidden=true class=fa></i> </a><li class="social-share__link social-share__link--email"><a title="Share 'HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert.' via email" href=mailto:?subject=HOWTO%3A%20Debian%2C%20Apache%202%20%26%20mod_ssl%20with%20self%20signed%20cert.%20or%20officially%20signed%20cert.&body=I%20thought%20you%20might%20like%20'HOWTO%3A%20Debian%2C%20Apache%202%20%26%20mod_ssl%20with%20self%20signed%20cert.%20or%20officially%20signed%20cert.'%20--%20https%3A//kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/> <i aria-hidden=true class=material-icons>  </i> </a></ul></div><div class=eevee-article><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2010-01-12T22:57:00+00:00 itemprop=datePublished> 12 Jan 2010 </time> — 4 min read</div><h1 itemprop=name><a title="Permalink to 'HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert.'" href=https://kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/ itemprop=url rel=bookmark> <span class=caps>HOWTO</span>: Debian, Apache 2 <span class=amp>&</span> mod_ssl with self signed cert. or officially signed cert. </a></h1><section class=eevee-toc><h2 id=toc>Contents</h2><nav class=eevee-toc-ribbon><div class=toc><p class=topic-title><a class="reference internal" href=#top>Contents</a><ul class=simple><li><a class="reference internal" href=#installation id=toc-entry-1>Installation</a><li><a class="reference internal" href=#ssl-certificate id=toc-entry-2><span class=caps>SSL</span> certificate</a><ul><li><a class="reference internal" href=#self-signed id=toc-entry-3>Self signed</a><li><a class="reference internal" href=#provider-signed id=toc-entry-4>Provider signed</a><ul><li><a class="reference internal" href=#without-a-passphrase id=toc-entry-5>Without a passphrase</a><li><a class="reference internal" href=#with-a-passphrase id=toc-entry-6>With a passphrase</a></ul></ul><li><a class="reference internal" href=#apache-configuration id=toc-entry-7>Apache configuration</a><li><a class="reference internal" href=#the-nasty-ssl-passphrase-hack id=toc-entry-8>The nasty <span class=caps>SSL</span> passphrase hack…</a></ul></div></nav></section><section class=article-content itemprop=articleBody><p>This is gonna be quite a simple tutorial that should be the same (excluding pathing and apt) across other Linux distros.<div class=section id=installation><h2>Installation</h2><p>First off we’ll get Apache and mod_ssl install<div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>apache2
</pre></div><p><span class=caps>SSL</span> should be enabled by default, if not run the following<div class=highlight><pre><span></span>sudo<span class=w> </span>a2enmod<span class=w> </span>ssl
</pre></div></div><div class=section id=ssl-certificate><h2><span class=caps>SSL</span> certificate</h2><p>There are several ways of doing this, the first you need to figure out is if you want a self signed certificate or one signed by a provider like GeoTrust, this type is not free. In this article I’ll cover both, starting with self signed.<div class=section id=self-signed><h3>Self signed</h3><div class=highlight><pre><span></span>sudp<span class=w> </span>mkdir<span class=w> </span>/etc/apache2/ssl
sudo<span class=w> </span>/usr/sbin/make-ssl-cert<span class=w> </span>/usr/share/ssl-cert/ssleay.cnf<span class=w> </span>/etc/apache2/ssl/apache.pem
</pre></div></div><div class=section id=provider-signed><h3>Provider signed</h3><p>Please note, this type of certificate has to be paid for, prices at time of writing range from £15/year to £2,000/year.<p>There are actually some more options when it comes to generating a key for this <span class=caps>CRT</span>, the first way creates a key that does not require a passphrase, the second way requires a passphrase and, unless you make a special change to your Apache config along with a small bash script (will go through later) will ask you for the passphrase for each key every time you restart Apache.<div class=section id=without-a-passphrase><h4>Without a passphrase</h4><div class=highlight><pre><span></span>openssl<span class=w> </span>genrsa<span class=w> </span>-out<span class=w> </span>DOMAINNAME.key<span class=w> </span><span class=m>4096</span>
</pre></div></div><div class=section id=with-a-passphrase><h4>With a passphrase</h4><div class=highlight><pre><span></span>openssl<span class=w> </span>genrsa<span class=w> </span>-des3<span class=w> </span>-out<span class=w> </span>DOMAINNAME.key<span class=w> </span><span class=m>4096</span>
</pre></div><p>Replace <span class=caps>DOMAINNAME</span> with your domain name, I find this makes it much easier if all of my certs and keys are named accordingly, but that’s just me. I also generally use at least a 4096bit modulus, feel free to change this to whatever you wish, some signers will only take a key of a specific size.<p>Next up is actually generating the <span class=caps>CSR</span> from the key.<div class=highlight><pre><span></span>openssl<span class=w> </span>req<span class=w> </span>-new<span class=w> </span>-key<span class=w> </span>DOMAINNAME.key<span class=w> </span>><span class=w> </span>DOMAINNAME.csr
</pre></div><p>As a note, it’s very badly wordly but <span class=caps>COMMON</span> <span class=caps>NAME</span> is the actual fully qualified domain name that you want to use <span class=caps>SSL</span> on, if your domain name is example.com and you want this to work on www.example.com but did not buy a wildcard certificate then put www.example.com as your Common Name.<p>Once generated, send this off to your signer and they will send you a <span class=caps>CRT</span> in return.<p>Once you have your <span class=caps>CRT</span> it’s time to put them on the server, move your key file to Debian’s <span class=caps>SSL</span> directory.<p>Put your <span class=caps>CRT</span> on the server and move it to Debian’s <span class=caps>SSL</span> directory too.</div></div></div><div class=section id=apache-configuration><h2>Apache configuration</h2><p>First thing we need to do is check your Apache ports.conf file to make sure <span class=caps>SSL</span> is enabled.<p>It should have the following at the bottom.<div class=highlight><pre><span></span><span class=nt>&LTIfModule</span><span class=w> </span><span class=s>mod_ssl.c</span><span class=nt>></span>
<span class=w>    </span><span class=c># SSL name based virtual hosts are not yet supported, therefore no</span>
<span class=w>    </span><span class=c># NameVirtualHost statement here</span>
<span class=w>    </span><span class=nb>Listen</span><span class=w> </span><span class=m>443</span>
<span class=nt>&LT/IfModule></span>
</pre></div><p>Now that’s sorted we’ll move on to your actual virtualhost.<div class=highlight><pre><span></span>sudo<span class=w> </span>nano<span class=w> </span>/etc/apache2/sites-available/DOMAINNAME.conf
</pre></div><p>We’ll use a config template I’ve always used, feel free to edit it at need.<div class=highlight><pre><span></span><span class=nt>&LTVirtualHost</span><span class=w> </span><span class=s>*</span><span class=nt>></span>
<span class=w>    </span><span class=nb>ServerAdmin</span><span class=w> </span>webmaster@DOMAINNAME
<span class=w>    </span><span class=nb>ServerName</span><span class=w> </span>DOMAINNAME
<span class=w>    </span><span class=nb>DocumentRoot</span><span class=w> </span><span class=sx>/var/www/DOMAINNAME</span>

<span class=w>    </span><span class=nt>&LTDirectory</span><span class=w> </span><span class=s>/</span><span class=nt>></span>
<span class=w>        </span><span class=nb>Options</span><span class=w> </span>FollowSymLinks
<span class=w>        </span><span class=nb>AllowOverride</span><span class=w> </span><span class=k>None</span>
<span class=w>    </span><span class=nt>&LT/Directory></span>

<span class=w>    </span><span class=nt>&LTDirectory</span><span class=w> </span><span class=s>/var/www/DOMAINNAME</span><span class=nt>></span>
<span class=w>        </span><span class=nb>Options</span><span class=w> </span>-Indexes<span class=w> </span>FollowSymLinks<span class=w> </span>MultiViews
<span class=w>        </span><span class=nb>AllowOverride</span><span class=w> </span><span class=k>All</span>
<span class=w>        </span><span class=nb>Order</span><span class=w> </span>allow,deny
<span class=w>        </span><span class=nb>allow</span><span class=w> </span>from<span class=w> </span><span class=k>all</span>
<span class=w>    </span><span class=nt>&LT/Directory></span>
<span class=nt>&LT/VirtualHost></span>

<span class=nt>&LTVirtualHost</span><span class=w> </span><span class=s>*:443</span><span class=nt>></span>
<span class=w>    </span><span class=nb>ServerAdmin</span><span class=w> </span>webmaster@DOMAINNAME
<span class=w>    </span><span class=nb>ServerName</span><span class=w> </span>DOMAINNAME
<span class=w>    </span><span class=nb>DocumentRoot</span><span class=w> </span><span class=sx>/var/www/DOMAINNAME</span>

<span class=w>    </span><span class=nt>&LTDirectory</span><span class=w> </span><span class=s>/</span><span class=nt>></span>
<span class=w>        </span><span class=nb>Options</span><span class=w> </span>FollowSymLinks
<span class=w>        </span><span class=nb>AllowOverride</span><span class=w> </span><span class=k>None</span>
<span class=w>    </span><span class=nt>&LT/Directory></span>

<span class=w>    </span><span class=nt>&LTDirectory</span><span class=w> </span><span class=s>/var/www/DOMAINNAME</span><span class=nt>></span>
<span class=w>        </span><span class=nb>Options</span><span class=w> </span>-Indexes<span class=w> </span>FollowSymLinks<span class=w> </span>MultiViews
<span class=w>        </span><span class=nb>AllowOverride</span><span class=w> </span><span class=k>All</span>
<span class=w>        </span><span class=nb>Order</span><span class=w> </span>allow,deny
<span class=w>        </span><span class=nb>allow</span><span class=w> </span>from<span class=w> </span><span class=k>all</span>
<span class=w>    </span><span class=nt>&LT/Directory></span>

<span class=w>     </span><span class=nb>SSLEngine</span><span class=w> </span><span class=k>On</span>
<span class=w>     </span><span class=nb>SSLCertificateFile</span><span class=w> </span><span class=sx>/etc/apache2/ssl/apache.pem</span>
<span class=nt>&LT/VirtualHost></span>
</pre></div><p>If you used the self signed approach then the above <strong>SSLCertificateFile</strong> will be correct, if not replace it with what is shown below.<div class=highlight><pre><span></span><span class=nb>SSLCertificateFile</span><span class=w> </span><span class=sx>/etc/ssl/certs/DOMAINANE.crt</span>
<span class=nb>SSLCertificateKeyFile</span><span class=w> </span><span class=sx>/etc/ssl/private/DOMAINNAME.key</span>
</pre></div><p>If you received a bundle file as well as your domains <span class=caps>CRT</span> then copy it to /etc/ssl/certs/ on your server and add the following line after <strong>SSLCertificateKeyFile</strong>.<div class=highlight><pre><span></span><span class=nb>SSLCertificateChainFile</span><span class=w> </span><span class=sx>/etc/ssl/certs/DOMAINNAME.bundle.crt</span>
</pre></div><p>Save and exit, with that done we need to enable the site.<div class=highlight><pre><span></span>sudo<span class=w> </span>a2ensite<span class=w> </span>DOMAINNAME.conf
</pre></div><p>If you used a self signed certificate or passphrase-free key, this should be all you need to do, feel free to test your config and restart Apache and test your site.<div class=highlight><pre><span></span>sudo<span class=w> </span>apache2ctrl<span class=w> </span>configtest
sudo<span class=w> </span>/etc/init.d/apache2<span class=w> </span>restart
</pre></div><p>If you used a key with a passphrase you will either have to type your passphrase in each time you restart Apache or, use this wonderful Apache supported “hack” below…</div><div class=section id=the-nasty-ssl-passphrase-hack><h2>The nasty <span class=caps>SSL</span> passphrase hack…</h2><div class=highlight><pre><span></span>sudo<span class=w> </span>nano<span class=w> </span>/etc/apache2/apache2.conf
</pre></div><p>Place the following at the end of the file<div class=highlight><pre><span></span><span class=nb>SSLPassPhraseDialog</span><span class=w> </span>exec:/etc/apache2/ssl.sh
</pre></div><p>Now we need to create this bash file, so…<div class=highlight><pre><span></span>sudo<span class=w> </span>nano<span class=w> </span>/etc/apache2/ssl.sh
</pre></div><p>Place the following in it<div class=highlight><pre><span></span><span class=ch>#!/bin/bash</span>
<span class=k>if</span><span class=w> </span><span class=o>[</span><span class=w> </span><span class=nv>$1</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=s1>'DOMAINNAME:443'</span><span class=w> </span><span class=o>]</span><span class=p>;</span><span class=w> </span><span class=k>then</span>
<span class=w>    </span><span class=nb>echo</span><span class=w> </span><span class=s2>"PASSPHRASE"</span>
<span class=k>fi</span>
</pre></div><p>This is actually supported by Apache, when it’s restarted it will call this script for every <span class=caps>SSL</span> virtualhost you have enabled, passing the hostname and the port through to the script as $1, so you can add multiple sites to this file.<p>Now save and make it only usable by root.<div class=highlight><pre><span></span>sudo<span class=w> </span>chmod<span class=w> </span><span class=m>0700</span><span class=w> </span>/etc/apache2/ssl.sh
sudo<span class=w> </span>chown<span class=w> </span>root:root<span class=w> </span>/etc/apache2/ssl.sh
</pre></div><p>Now we can follow the config test and restart call from above.<div class=highlight><pre><span></span>sudo<span class=w> </span>apache2ctl<span class=w> </span>configtest
sudo<span class=w> </span>/etc/init.d/apache2<span class=w> </span>restart
</pre></div><p>And that is it, we should be done!</div></section></div><div class=eevee-related><section><h2>Related articles</h2><ul><li><a title="Permalink to 'HOWTO: Debian - Apache 2 SSL on multiple virtual hosts'" href=https://kura.gg/2010/01/15/howto-debian-apache2-ssl-multiple-vhosts/ itemprop=url rel=bookmark> <span class=caps>HOWTO</span>: Debian - Apache 2 <span class=caps>SSL</span> on multiple virtual hosts </a><li><a title="Permalink to 'Convert DER certificate to PEM'" href=https://kura.gg/2010/03/03/convert-der-certificate-to-pem/ itemprop=url rel=bookmark> Convert <span class=caps>DER</span> certificate to <span class=caps>PEM</span> </a><li><a title="Permalink to 'More nginx proxy_cache optimizations and nginx load balancing'" href=https://kura.gg/2010/02/14/more-nginx-proxy_cache-optimizations-and-nginx-load-balancing/ itemprop=url rel=bookmark> More nginx proxy_cache optimizations and nginx load balancing </a><li><a title="Permalink to 'nginx, proxy_cache and reverse proxying explained & benchmarked'" href=https://kura.gg/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/ itemprop=url rel=bookmark> nginx, proxy_cache and reverse proxying explained <span class=amp>&</span> benchmarked </a><li><a title="Permalink to 'HOWTO: Debian server security'" href=https://kura.gg/2010/01/14/howto-debian-server-security/ itemprop=url rel=bookmark> <span class=caps>HOWTO</span>: Debian server security </a></ul></section></div><div class=eevee-ac><header class=eevee-ac__header><div class=eevee-ac-author__text><h2>Kura</h2><p>Anarchist. Pessimist. Bipolar. Hacker. Hyperpolyglot. Musician. Ex-(semi-)pro gamer. They/Them.<p><a title="Read more articles by Kura" href=https://kura.gg/authors/kura/ itemprop=url> Read more articles by Kura </a><nav><ul class=eevee-ac-author__social><li class=eevee-ac-author-social__link><a class="mdl-color-text--accent mdl-navigation__link" title="kura on GitHub" href=https://github.com/kura itemprop=url rel=bookmark> <i aria-hidden=true class=fa></i> </a><li class=eevee-ac-author-social__link><a class="mdl-color-text--accent mdl-navigation__link" title="kura on @kura@noc.social" href=https://noc.social/@kura itemprop=url rel=bookmark> <i aria-hidden=true class=fa>🦣</i> </a></ul></nav></div><img alt=Kura class=eevee-ac-author__avatar src=/images/avatar.png></header></div></article><a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--raised mdl-color--accent mdl-color-text--white" title="View 'HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert.' on GitHub" href=https://github.com/kura/kura.gg/blob/main/content/howto-debian-apache-2-amp-mod_ssl.rst id=view-source> <i class=material-icons></i> View Source </a></div></div></main><div class="eevee-pagination__container eevee-container mdl-grid"><div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone" role=presentation></div><div class="mdl-color-text--grey-800 mdl-cell mdl-cell--8-col"><nav class="eevee-pagination mdl-cell mdl-cell--12-col" aria-label=Pagination itemscope itemtype=http://schema.org/SiteNavigationElement><a class=eevee-nav__button href=https://kura.gg/2010/01/13/howto-debian-sudoers-explained/ itemprop=url rel=bookmark title=Newer> <button class="mdl-button mdl-button--icon mdl-color--white mdl-color-text--grey-900" role=presentation><i class=material-icons></i></button> Newer </a><div class=eevee-spacer></div><a class=eevee-nav__button href=https://kura.gg/2010/01/12/apache-2-nginx-wordpress-mu-follow-up/ itemprop=url rel=bookmark title=Older> Older <button class="mdl-button mdl-button--icon mdl-color--white mdl-color-text--grey-900" role=presentation><i class=material-icons></i></button> </a></nav></div></div><footer class=mdl-mega-footer itemscope itemtype=http://schema.org/SiteNavigationElement><div class=mdl-mega-footer--top-section><div class=mdl-mega-footer--drop-down-section><ul class=mdl-mega-footer--link-list><li><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></ul></div></div><div aria-label="Footer navigation" class=mdl-mega-footer--middle-section itemscope itemtype=http://schema.org/SiteNavigationElement><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Menu</h1><ul class=mdl-mega-footer--link-list><li><a href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons></i> Contact </a><li><a href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons></i> Archives </a><li><a href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons></i> RSS </a><li><a href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons></i> Atom </a></ul></div><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Social</h1><ul class=mdl-mega-footer--link-list><li><a href=https://github.com/kura itemprop=url rel=bookmark title=GitHub> <i aria-hidden=true class=fa></i> Github </a><li><a href=https://noc.social/@kura itemprop=url rel=me title=@kura@noc.social> <i aria-hidden=true class=fa>🦣</i> @kura@noc.social </a></ul></div><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Links</h1><ul class=mdl-mega-footer--link-list><li><a href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons></i> Blackhole </a><li><a href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons></i> Eevee </a><li><a href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons></i> Hauntr </a><li><a href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons></i> Ghastly </a><li><a title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons></i> Pelican Plugins </a></ul></div></div><div class=mdl-mega-footer--bottom-section><div class=mdl-logo><a href=https://kura.gg itemprop=url rel=bookmark title=kura.gg> kura.gg </a></div><ul class="eevee-footer mdl-mega-footer--link-list"><li>Powered by love & rainbow sparkles.<li>Source code and content released under the <a title="MIT license" href=/license/>MIT license</a>.</ul></div></footer></div>