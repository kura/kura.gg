<!doctype html><html lang=en><meta charset=utf-8><meta content=width=device-width,initial-scale=1.0,minimum-scale=1.0 name=viewport><link href=https://kura.gg hreflang=en rel=alternate><link href=https://kura.gg rel=dns-prefetch><link href=https://kura.gg/theme/css/eevee.min.css?1c9d8344 rel=stylesheet><script async src=https://kura.gg/theme/js/eevee.min.js?1841d254></script><link href=https://kura.gg/feeds/rss.xml rel=alternate title=kura.gg type=application/rss+xml><link href=https://kura.gg/feeds/atom.xml rel=alternate title=kura.gg type=application/atom+xml><meta content=kura.gg property=og:site_name><meta content=article property=og:type><meta content="nginx, proxy_cache and reverse proxying explained &Â benchmarked" property=og:title><meta content=https://kura.gg/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/ property=og:url><meta content="The beginning Where to begin? nginx would be a good start I suppose. Itâ€™s far easier and makes much for sense for you to actually read about nginx from itâ€™s own website - https://nginx.org/en/ - but just to give a simple explanation too; `nginx is king of static content HTTP servers.` Anyone that has dealt with Apache on medium to high traffic websites will know that Apache is bit of a `wheezy, old geezer` when it comes to content serving using itâ€™s mpm-worker (threaded). Very often high traffic will cause server load to go through the roof but for serving dynamic content, there really is no better HTTP server than Apache, so this leaves us in a bit of a predicament; a high powered website with dynamic content and lots of static files like JS, CSS and imagery, what do we do?! In this example `dynamic â€¦" property=og:description><meta content=https://kura.gg/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/index.png property=og:image><meta content=1920 property=og:image:width><meta content=1080 property=og:image:height><meta content="nginx, proxy_cache and reverse proxying explained &Â benchmarked" property=twitter:title><meta content=https://kura.gg/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/ property=twitter:url><meta content="The beginning Where to begin? nginx would be a good start I suppose. Itâ€™s far easier and makes much for sense for you to actually read about nginx from itâ€™s own website - https://nginx.org/en/ - but just to give a simple explanation too; `nginx is king of static content HTTP servers.` Anyone that has dealt with Apache on medium to high traffic websites will know that Apache is bit of a `wheezy, old geezer` when it comes to content serving using itâ€™s mpm-worker (threaded). Very often high traffic will cause server load to go through the roof but for serving dynamic content, there really is no better HTTP server than Apache, so this leaves us in a bit of a predicament; a high powered website with dynamic content and lots of static files like JS, CSS and imagery, what do we do?! In this example `dynamic â€¦" property=twitter:description><meta content=https://kura.gg/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/index.png property=twitter:image><meta content=summary_large_image property=twitter:card><meta content="Written by" property=twitter:label1><meta content=Kura property=twitter:data1><meta content="Estimated reading time" property=twitter:label2><meta content="7 min read" property=twitter:data2><meta content=1920 property=twitter:image:width><meta content=1080 property=twitter:image:height><script type=application/ld+json>
{
    "@context": "https://schema.org",
    "@type": "BlogPosting",
    "headline": "nginx, proxy_cache and reverse proxying explained &amp;Â benchmarked",
    "url": "https://kura.gg/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/",
    "description": "The beginning Where to begin? nginx would be a good start I suppose. Itâ€™s far easier and makes much for sense for you to actually read about nginx from itâ€™s own website - https://nginx.org/en/ - but just to give a simple explanation too; `nginx is king of static content HTTP servers.` Anyone that has dealt with Apache on medium to high traffic websites will know that Apache is bit of a `wheezy, old geezer` when it comes to content serving using itâ€™s mpm-worker (threaded). Very often high traffic will cause server load to go through the roof but for serving dynamic content, there really is no better HTTP server than Apache, so this leaves us in a bit of a predicament; a high powered website with dynamic content and lots of static files like JS, CSS and imagery, what do we do?! In this example `dynamic â€¦",
    "author": {
        "@type": "Person",
        "name": "Kura",
        "url": "https://kura.gg/authors/kura/"
    },
    "publisher": {
        "@type": "Organization",
        "name": "kura.gg",
        "url": "https://kura.gg/authors/kura/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://kura.gg/favicon.png"
        }
    },
    "mainEntityOfPage": "https://kura.gg/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/",
    "image": "https://kura.gg/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/index.png",
    "datePublished": "2010-02-07T10:27:00+00:00"
}
</script><link sizes="16x16 32x32 48x48 64x64 128x128 256x256" href=/favicon.png rel=icon type=image/png><link sizes="16x16 32x32 48x48 64x64 128x128 256x256" href=/favicon.ico rel=icon type=image/vnd.microsoft.icon><title>nginx, proxy_cache and reverse proxying explained &Â benchmarked</title><body><div class="eevee-layout mdl-layout mdl-js-layout mdl-color--grey-50"><header class="eevee-header mdl-color--grey-50 mdl-color-text--grey-800" itemscope itemtype=http://schema.org/WPHeader><div class=mdl-layout__header-row><div class="mdl-layout__drawer-button mdl-color-text--accent eevee-mobile-button mdl-layout--small-screen-only" aria-expanded=false role=button tabindex=0><i class=material-icons>î—’</i></div><span class="eevee-logo mdl-color-text--accent mdl-layout-title"> <h2 id=top><a href=https://kura.gg rel=bookmark title=kura.gg> kura.gg </a></h2> </span><div class=mdl-layout-spacer role=presentation></div><nav aria-label="Header navigation" class="eevee-nav mdl-navigation mdl-layout--large-screen-only" itemscope itemtype=http://schema.org/SiteNavigationElement><a class="mdl-color-text--accent mdl-navigation__link" href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons>î¡¯</i> Blackhole </a><a class="mdl-color-text--accent mdl-navigation__link" href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons>î¡±</i> Eevee </a><a class="mdl-color-text--accent mdl-navigation__link" href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons>î¡±</i> Hauntr </a><a class="mdl-color-text--accent mdl-navigation__link" href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons>î¡±</i> Ghastly </a><a class="mdl-color-text--accent mdl-navigation__link" title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons>î¡¯</i> Pelican Plugins </a><a class="mdl-color-text--accent mdl-navigation__link" href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons>î‚·</i> Contact </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons>î€¯</i> Archives </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons>îƒ¥</i> RSS </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons>îƒ¥</i> Atom </a></nav></div></header><div class="eevee-mobile-header mdl-layout__drawer mdl-color--white" aria-hidden=true><span class=mdl-layout-title> <h2 class="eevee-mobile-logo mdl-color-text--accent">kura.gg</h2> </span><div class="mdl-navigation mdl-color--white"><nav aria-label="Header navigation" class="eevee-nav mdl-navigation" itemscope itemtype=http://schema.org/SiteNavigationElement><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons> î¢Š </i> Home </a><a class="mdl-color-text--accent mdl-navigation__link" href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons>î¡¯</i> Blackhole </a><a class="mdl-color-text--accent mdl-navigation__link" href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons>î¡±</i> Eevee </a><a class="mdl-color-text--accent mdl-navigation__link" href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons>î¡±</i> Hauntr </a><a class="mdl-color-text--accent mdl-navigation__link" href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons>î¡±</i> Ghastly </a><a class="mdl-color-text--accent mdl-navigation__link" title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons>î¡¯</i> Pelican Plugins </a><a class="mdl-color-text--accent mdl-navigation__link" href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons>î‚·</i> Contact </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons>î€¯</i> Archives </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons>îƒ¥</i> RSS </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons>îƒ¥</i> Atom </a></nav></div></div><div class="eevee-ribbon mdl-color--primary-dark" role=presentation></div><main class="eevee-main mdl-layout__content"><div class="eevee-container mdl-grid"><div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone" role=presentation></div><div aria-label="Main content" class="eevee-content mdl-color--white mdl-shadow--2dp mdl-color-text--grey-800 mdl-cell mdl-cell--8-col"><article itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=apache,cache,debian,howto,nginx,php,ubuntu,wordpress itemprop=keywords><meta content=tutorials itemprop=keywords><div class=eevee-share><ul class="social-share mdl-navigation"><li class="social-share__link social-share__link--twitter"><a onclick="window.open(this.href, 'twitter-share', 'width=550,height=235'); return false;" title="Share 'nginx, proxy_cache and reverse proxying explained & benchmarked' on Twitter" href=https://twitter.com/intent/tweet?text=nginx%2C%20proxy_cache%20and%20reverse%20proxying%20explained%20%26%20benchmarked&url=https%3A//kura.gg/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/> <i aria-hidden=true class=fa>ï‚™</i> </a><li class="social-share__link social-share__link--facebook"><a onclick="window.open(this.href, 'facebook-share', 'width=580,height=296'); return false;" title="Share 'nginx, proxy_cache and reverse proxying explained & benchmarked' on Facebook" href=https://www.facebook.com/sharer/sharer.php?u=https%3A//kura.gg/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/> <i aria-hidden=true class=fa>ï‚š</i> </a><li class="social-share__link social-share__link--email"><a title="Share 'nginx, proxy_cache and reverse proxying explained & benchmarked' via email" href=mailto:?subject=nginx%2C%20proxy_cache%20and%20reverse%20proxying%20explained%20%26%20benchmarked&body=I%20thought%20you%20might%20like%20'nginx%2C%20proxy_cache%20and%20reverse%20proxying%20explained%20%26%20benchmarked'%20--%20https%3A//kura.gg/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/> <i aria-hidden=true class=material-icons> îƒ¡ </i> </a></ul></div><div class=eevee-article><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2010-02-07T10:27:00+00:00 itemprop=datePublished> 07 Feb 2010 </time>Â â€” 7 min read</div><h1 itemprop=name><a title="Permalink to 'nginx, proxy_cache and reverse proxying explained &Â benchmarked'" href=https://kura.gg/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/ itemprop=url rel=bookmark> nginx, proxy_cache and reverse proxying explained <span class=amp>&</span>Â benchmarked </a></h1><section class=eevee-toc><h2 id=toc>Contents</h2><nav class=eevee-toc-ribbon><div class=toc><p class=topic-title><a class="reference internal" href=#top>Contents</a><ul class=simple><li><a class="reference internal" href=#the-beginning id=toc-entry-1>TheÂ beginning</a><li><a class="reference internal" href=#everything-has-changed id=toc-entry-2>Everything hasÂ changed?</a><li><a class="reference internal" href=#so-what-does-it-do id=toc-entry-3>So what does itÂ do?</a><li><a class="reference internal" href=#controlling-the-cache id=toc-entry-4>Controlling theÂ cache</a><li><a class="reference internal" href=#the-numbers id=toc-entry-5>TheÂ numbers</a><li><a class="reference internal" href=#the-conclusion id=toc-entry-6>TheÂ conclusion</a></ul></div></nav></section><section class=article-content itemprop=articleBody><div class=section id=the-beginning><h2>TheÂ beginning</h2><p>Where to begin? nginx would be a good start I suppose. Itâ€™s far easier and makes much for sense for you to actually read about nginx from itâ€™s own website - <a class="reference external" href=https://nginx.org/en/>https://nginx.org/en/</a> - but just to give a simple explanation too; `nginx is king of static content <span class=caps>HTTP</span>Â servers.`<p>Anyone that has dealt with Apache on medium to high traffic websites will know that Apache is bit of a `wheezy, old geezer` when it comes to content serving using itâ€™s mpm-worker (threaded). Very often high traffic will cause server load to go through the roof but for serving dynamic content, there really is no better <span class=caps>HTTP</span> server than Apache, so this leaves us in a bit of a predicament; a high powered website with dynamic content and lots of static files like <span class=caps>JS</span>, <span class=caps>CSS</span> and imagery, what do weÂ do?!<p>In this example `dynamic content` means content that is drawn from the <span class=caps>SQL</span> <span class=caps>DB</span> and used to generate pages using <span class=caps>PHP</span>; pages of products, category trees, etc, a typical ecommerceÂ platform.<p>I opted to use nginx to reverse proxy to Apache and serve up just the static content through nginx itself long ago and, looking down through the `Related Posts` section of this page you will find at least half a dozen articles about it, including my original article on how to get nginx to actually reverse proxy and use <span class=caps>WP</span>-Super-Cache to actually generate cached <span class=caps>HTML</span> content that nginx could serve. This article takes thatÂ further.<p>If youâ€™ve not read the aforementioned article I would strongly suggest you do before continuing with this one - <a class="reference external" href=/2010/01/11/debian-apache-2-nginx-wordpress-mu/>Debian, Apache 2, Nginx, WordPress <span class=caps>MU</span> <span class=amp>&</span> <span class=caps>WP</span>-Super-Cache</a>.</div><div class=section id=everything-has-changed><h2>Everything hasÂ changed?</h2><p>So now that youâ€™ve read that itâ€™s time to explain whatâ€™s different and, quite simply, everything is. Everything?Â Everything.<p>Gone are the location checks and file checks, all replaced with several lines that tell nginx that it needs to cache the pageÂ content.<p>Before I get stuck in on the changes itâ€™s worth pointing out that this is only possible with version of nginx >= 0.7.65 and within the 0.8.* branch. According to the nginx website there was a bug in the proxy caching engine that meant nginx would ignore comma separate cache controls. So upgrade before attemptingÂ this.<p>Back to the changes, lets take a look at a small change I made to the actual nginx main configuration file, on Debian/Ubuntu this isÂ in<blockquote>/etc/nginx/nginx.conf</blockquote><div class=highlight><pre><span></span><span class=k>proxy_cache_path</span><span class=w> </span><span class=s>/var/www/syslog.tv/cache</span><span class=w> </span><span class=s>levels=1:2</span><span class=w> </span><span class=s>keys_zone=one:8m</span><span class=w> </span><span class=s>max_size=1000m</span><span class=w> </span><span class=s>inactive=600m</span><span class=p>;</span>
<span class=k>proxy_temp_path</span><span class=w> </span><span class=s>/tmp</span><span class=p>;</span>
</pre></div><p>These 2 lines need to be within the main nginx configuration before any of your server {} definitions, otherwise nginxâ€™s config test will fail and nginx wonâ€™tÂ start.<p>The biggest chain was in this siteâ€™s server definition, it now looks likeÂ this<div class=highlight><pre><span></span><span class=k>server</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=kn>listen</span><span class=w> </span><span class=n>174.143.241.61</span><span class=p>:</span><span class=mi>80</span><span class=p>;</span>
<span class=w>    </span><span class=kn>server_name</span><span class=w> </span><span class=s>syslog.tv</span><span class=p>;</span>
<span class=w>    </span><span class=kn>access_log</span><span class=w> </span><span class=s>/var/log/nginx/syslog.tv.access.log</span><span class=p>;</span>

<span class=w>    </span><span class=kn>location</span><span class=w> </span><span class=s>/</span><span class=w> </span><span class=p>{</span>
<span class=w>        </span><span class=kn>root</span><span class=w> </span><span class=s>/var/www/syslog.tv</span><span class=p>;</span><span class=w> </span><span class=c1>#the path to your actual site, used for serving static files</span>
<span class=w>        </span><span class=kn>proxy_redirect</span><span class=w> </span><span class=no>off</span><span class=p>;</span>
<span class=w>        </span><span class=kn>proxy_set_header</span><span class=w> </span><span class=s>Host</span><span class=w> </span><span class=nv>$host</span><span class=p>;</span>
<span class=w>        </span><span class=kn>proxy_set_header</span><span class=w> </span><span class=s>X-Real-IP</span><span class=w> </span><span class=nv>$remote_addr</span><span class=p>;</span>
<span class=w>        </span><span class=kn>proxy_set_header</span><span class=w> </span><span class=s>X-Forwarded-For</span><span class=w> </span><span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
<span class=w>        </span><span class=kn>proxy_cache</span><span class=w> </span><span class=no>on</span><span class=s>e</span><span class=p>;</span>
<span class=w>        </span><span class=kn>proxy_cache_key</span><span class=w> </span><span class=s>syslog.tv</span><span class=nv>$request_uri</span><span class=p>;</span>
<span class=w>        </span><span class=kn>proxy_cache_valid</span><span class=w> </span><span class=mi>200</span><span class=w> </span><span class=mi>302</span><span class=w> </span><span class=mi>60m</span><span class=p>;</span>
<span class=w>        </span><span class=kn>proxy_cache_valid</span><span class=w> </span><span class=mi>404</span><span class=w> </span><span class=mi>1m</span><span class=p>;</span>
<span class=w>        </span><span class=kn>proxy_pass</span><span class=w> </span><span class=s>https://apache.syslog.tv</span><span class=p>;</span>
<span class=w>    </span><span class=p>}</span>
<span class=p>}</span>
</pre></div><p>The server definition should be relatively easy to understand, we have the general listen, server_name, access_log and root which are used everywhere, the only difference now is that I am serving root from /var/www/syslog.tv/cache which is where nginx is configured to store itâ€™sÂ cache.<p>We set several proxy specific options, proxy_redirect and three proxy_set_header instances, these are really quite self explanatory; do not redirect proxy requests, ever and the three headers are passed over to Apache so it is able to properly log access and see the original <span class=caps>IP</span> rather than seeing nginxâ€™s <span class=caps>IP</span>.<p>The new and important part is from proxy_cache down to proxy_pass, proxy_pass exists in my original config file but here it is now used in conjunction with proxy_cache, which sets the zone (zone definition are in the two lines added to nginx.conf), set the key, sets some timers on valid responses, in this case 200, 302 and 404 and then passed back to Apache withÂ proxy_pass.</div><div class=section id=so-what-does-it-do><h2>So what does itÂ do?</h2><p>Iâ€™m going to assume that youâ€™re with me so far if youâ€™re reading this, Iâ€™ve not lost you or anything, IÂ hope.<p>So what is the point of this? What does itÂ do?<p>Itâ€™s really quite simple; this tells nginx to cache all proxy responses when they meet the response type requirements for the times defined, thatâ€™sÂ it.<p>When nginx loads it will automatically look for a cached version residing in our root directory before even thinking about reverse proxying back to Apache, if it finds a cached variant that is still valid it will serve it, if not it will proxy back to Apache which generates our page content, which nginx serves and then caches. This means that the load on Apache is greatly reduced and I mean <strong>greatly</strong>Â reduced.</div><div class=section id=controlling-the-cache><h2>Controlling theÂ cache</h2><p>The best thing about this setup is how you actually control what gets cached. Headers. Itâ€™s as simple as that. These are basic <span class=caps>HTTP</span> Cache-ControlÂ headers:<blockquote>Cache-Control: private, max-age=0</blockquote><p>The one above sets Cache-Control to private with a max-age of 0 and the one below sets to public with a max age of oneÂ hour.<blockquote>Cache-Control: public, max-age=3600</blockquote><p>nginx will respect these headers and handle the caching accordingly, you can set these headers through <span class=caps>PHP</span> and have pages not get cached, you can even use .htaccess to set the headers on specific directories, files or file extensions or you could even just set them in your siteâ€™s server definition. AmazingÂ stuff.</div><div class=section id=the-numbers><h2>TheÂ numbers</h2><pre class=literal-block>
Benchmarking this setup actually scared me, I was completely amazed
out how well nginx performed.
Benchmarking syslog.tv (be patient)
...
Finished 10000 requests

Server Software: nginx/0.7.65
Server Hostname: syslog.tv
Server Port: 80
...
Concurrency Level: 200
Time taken for tests: 93.371 seconds
Complete requests: 10000
Failed requests: 0
Write errors: 0
Total transferred: 74634408 bytes
HTML transferred: 72015948 bytes
Requests per second: 107.10 [#/sec] (mean)
Time per request: 1867.419 [ms] (mean)
Time per request: 9.337 [ms] (mean, across all concurrent requests)
Transfer rate: 780.60 [Kbytes/sec] received

Connection Times (ms)
min mean[+/-sd] median max
Connect: 10 611 245.9 600 3640
Processing: 70 1238 142.0 1250 5100
Waiting: 70 611 100.5 600 4100
Total: 80 1849 266.2 1860 6240

Percentage of the requests served within a certain time (ms)
50% 1860
66% 1860
75% 1860
80% 1880
90% 1880
95% 1900
98% 1920
99% 2260
100% 6240 (longest request)
</pre><p>That is very good, the server this website runs on is very underpowered, <span class=caps>256MB</span> of <span class=caps>RAM</span>, single virtual core just in case anyone thinks I cheated and used a 32 coreÂ machine.<p>What is also worth mentioning is the loadÂ average<blockquote>load average: 0.08, 0.06, 0.03</blockquote><p>Iâ€™m hoping your eyes are as wide as mine were when I saw this average, 200 concurrent connections on nginx and the load average doesnâ€™t go above 0.08 the whole time. It served 10,000 requests with 0 failures, 200 at a time in 93.371Â secondsâ€¦<p>I tried the same with proxy_caching disable and also directly against Apache, both times with a KeepAlive On and KeepAliveTimeOut 5 Apache fell over, load went through the roof and I had to hard reset the server both times. Apache couldnâ€™t even handle 50 concurrent requests, let aloneÂ 200.</div><div class=section id=the-conclusion><h2>TheÂ conclusion</h2><p>The conclusion is simple for me; I love nginx and will continue to use it as much as I can to increase performance, this does not mean I have any dislike for Apache at all, in fact I know very well that to do things well in this field you need to have multiple systems in place to handle multiple things, especially with high trafficÂ sites.<p>For me the future is simple, cache as much content as I possibly can and use nginx to serveÂ it.<p>The next steps for me will be using Varnish for caching, nginx for load balancing and also trying caching content to Memcached. As always finding will be reportedÂ here.</div></section></div><div class=eevee-related><section><h2>Related articles</h2><ul><li><a title="Permalink to 'More nginx proxy_cache optimizations and nginx loadÂ balancing'" href=https://kura.gg/2010/02/14/more-nginx-proxy_cache-optimizations-and-nginx-load-balancing/ itemprop=url rel=bookmark> More nginx proxy_cache optimizations and nginx loadÂ balancing </a><li><a title="Permalink to 'Apache 2, Nginx & WordPress MU - FollowÂ up'" href=https://kura.gg/2010/01/12/apache-2-nginx-wordpress-mu-follow-up/ itemprop=url rel=bookmark> Apache 2, Nginx <span class=amp>&</span> WordPress <span class=caps>MU</span> - FollowÂ up </a><li><a title="Permalink to 'Debian, Apache 2, Nginx, WordPress MU & WP-Super-Cache'" href=https://kura.gg/2010/01/11/debian-apache-2-nginx-wordpress-mu/ itemprop=url rel=bookmark> Debian, Apache 2, Nginx, WordPress <span class=caps>MU</span> <span class=amp>&</span> <span class=caps>WP</span>-Super-Cache </a><li><a title="Permalink to 'New syslog.tv nginx wordpress site configurationÂ explained'" href=https://kura.gg/2010/04/18/new-syslog-tv-nginx-wordpress-site-configuration/ itemprop=url rel=bookmark> New syslog.tv nginx wordpress site configurationÂ explained </a><li><a title="Permalink to 'HOWTO: Debian serverÂ security'" href=https://kura.gg/2010/01/14/howto-debian-server-security/ itemprop=url rel=bookmark> <span class=caps>HOWTO</span>: Debian serverÂ security </a></ul></section></div><div class=eevee-ac><header class=eevee-ac__header><div class=eevee-ac-author__text><h2>Kura</h2><p>Anarchist. Pessimist. Bipolar. Hacker. Hyperpolyglot. Musician. Ex-(semi-)pro gamer. They/Them.<p><a title="Read more articles by Kura" href=https://kura.gg/authors/kura/ itemprop=url> Read more articles by Kura </a><nav><ul class=eevee-ac-author__social><li class=eevee-ac-author-social__link><a class="mdl-color-text--accent mdl-navigation__link" title="kura on GitHub" href=https://github.com/kura itemprop=url rel=bookmark> <i aria-hidden=true class=fa>ï‚›</i> </a><li class=eevee-ac-author-social__link><a class="mdl-color-text--accent mdl-navigation__link" title="kura on @kura@noc.social" href=https://noc.social/@kura itemprop=url rel=bookmark> <i aria-hidden=true class=fa>ðŸ¦£</i> </a></ul></nav></div><img alt=Kura class=eevee-ac-author__avatar src=/images/avatar.png></header></div></article><a class="mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--raised mdl-color--accent mdl-color-text--white" title="View 'nginx, proxy_cache and reverse proxying explained &Â benchmarked' on GitHub" href=https://github.com/kura/kura.gg/blob/main/content/nginx-proxy_cache-and-explained-benchmarked.rst id=view-source> <i class=material-icons>î¡¯</i> View Source </a></div></div></main><div class="eevee-pagination__container eevee-container mdl-grid"><div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone" role=presentation></div><div class="mdl-color-text--grey-800 mdl-cell mdl-cell--8-col"><nav class="eevee-pagination mdl-cell mdl-cell--12-col" aria-label=Pagination itemscope itemtype=http://schema.org/SiteNavigationElement><a class=eevee-nav__button href=https://kura.gg/2010/02/11/howto-iptables-on-debian-ubuntu/ itemprop=url rel=bookmark title=Newer> <button class="mdl-button mdl-button--icon mdl-color--white mdl-color-text--grey-900" role=presentation><i class=material-icons>î—„</i></button> Newer </a><div class=eevee-spacer></div><a class=eevee-nav__button href=https://kura.gg/2010/02/06/using-nginx-varnish-and-apache/ itemprop=url rel=bookmark title=Older> Older <button class="mdl-button mdl-button--icon mdl-color--white mdl-color-text--grey-900" role=presentation><i class=material-icons>î—ˆ</i></button> </a></nav></div></div><footer class=mdl-mega-footer itemscope itemtype=http://schema.org/SiteNavigationElement><div class=mdl-mega-footer--top-section><div class=mdl-mega-footer--drop-down-section><ul class=mdl-mega-footer--link-list><li><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></ul></div></div><div aria-label="Footer navigation" class=mdl-mega-footer--middle-section itemscope itemtype=http://schema.org/SiteNavigationElement><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Menu</h1><ul class=mdl-mega-footer--link-list><li><a href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons>î‚·</i> Contact </a><li><a href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons>î€¯</i> Archives </a><li><a href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons>îƒ¥</i> RSS </a><li><a href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons>îƒ¥</i> Atom </a></ul></div><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Social</h1><ul class=mdl-mega-footer--link-list><li><a href=https://github.com/kura itemprop=url rel=bookmark title=GitHub> <i aria-hidden=true class=fa>ï‚›</i> Github </a><li><a href=https://noc.social/@kura itemprop=url rel=me title=@kura@noc.social> <i aria-hidden=true class=fa>ðŸ¦£</i> @kura@noc.social </a></ul></div><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Links</h1><ul class=mdl-mega-footer--link-list><li><a href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons>î¡¯</i> Blackhole </a><li><a href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons>î¡±</i> Eevee </a><li><a href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons>î¡±</i> Hauntr </a><li><a href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons>î¡±</i> Ghastly </a><li><a title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons>î¡¯</i> Pelican Plugins </a></ul></div></div><div class=mdl-mega-footer--bottom-section><div class=mdl-logo><a href=https://kura.gg itemprop=url rel=bookmark title=kura.gg> kura.gg </a></div><ul class="eevee-footer mdl-mega-footer--link-list"><li>Powered by love & rainbow sparkles.<li>Source code and content released under the <a title="MIT license" href=/license/>MIT license</a>.</ul></div></footer></div>