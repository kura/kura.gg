<!DOCTYPE html><!--

                                      |
                                     /|
                                   ,' |
                                  .   |
                                    | |
                                 ' '| |
                                / / | |
       _,.-\"\"--._              / /  | |
     ,'          `.           j '   ' '
   ,'              `.         ||   / ,                         ___..--,
  /                  \\        ' `.'`.-.,-\".  .       _..---\"\"'' __, ,'
 /                    \\        \\` .\"`      `\"'\\   ,'\"_..--''\"\"\"'.'.'
.                      .      .'-'             \\,' ,'         ,','
|                      |      ,`               ' .`         .' /
|                      |     /          ,\"`.  ' `-. _____.-' .'
'                      |..---.|,\".      | | .  .-'\"\"   __.,-'
 .                   ,'       ||,|      |.' |    |\"\"`'\"
  `-._   `._.._____  |        || |      `._,'    |
      `.   .       `\".     ,'\"| \"  `'           ,+.
        \\  '         |    '   |   .....        .'  `.
         .'          '     7  \".              ,'     \\
                   ,'      |    `..        _,'      F
                  .        |,      `'----''         |
                  |      ,\"j  /                   | '
                  `     |  | .                 | `,'
                   .    |  `.|                 |/
                    `-..'   ,'                .'
                            | \\             ,''
                            |  `,'.      _,' /
                            |    | ^.  .'   /
                             `-'.' j` V    /
                                   |      /
                                   |     /
                                   |   ,'
                                    `\"\"

//--><html lang=en> <head><meta charset=utf-8><meta name=viewport content="width=device-width, initial-scale=1.0, minimum-scale=1.0"><link rel=alternate href=https://kura.gg hreflang=en><link rel=dns-prefetch href=https://kura.gg><link rel=dns-prefetch href=//disqus.com><link rel=dns-prefetch href=//a.disquscdn.com><link rel=dns-prefetch href=//syslogtv.disqus.com><link rel=dns-prefetch href=//glitter-services.disqus.com><link href=https://kura.gg/feeds/rss.xml type=application/rss+xml rel=alternate title=kura.gg><link href=https://kura.gg/feeds/atom.xml type=application/atom+xml rel=alternate title=kura.gg><meta property=og:site_name content=kura.gg><meta property=og:type content=article><meta property=og:title content=kura.gg><meta property=og:url content=https://kura.gg/tag/apache/index.html><meta property=og:image content=https://kura.gg/tag/apache/index.png><meta property=og:image:width content=1920><meta property=og:image:height content=1080><meta property=twitter:site content=@kuramanga><meta property=twitter:title content=kura.gg><meta property=twitter:url content=https://kura.gg/tag/apache/index.html><meta property=twitter:image content=https://kura.gg/tag/apache/index.png><meta property=twitter:card content=summary_large_image><meta property=twitter:image:width content=1920><meta property=twitter:image:height content=1080><link rel=icon href=/favicon.png type=image/png sizes="16x16 32x32 48x48 64x64 128x128 256x256"><link rel=icon href=/favicon.ico type=image/vnd.microsoft.icon sizes="16x16 32x32 48x48 64x64 128x128 256x256"><title>Articles with the 'apache' tag</title></head> <body> <div class="eevee-layout mdl-layout mdl-js-layout mdl-color--grey-50"> <header class="eevee-header mdl-color--grey-50 mdl-color-text--grey-800" itemscope itemtype=http://schema.org/WPHeader> <div class=mdl-layout__header-row> <div aria-expanded=false role=button tabindex=0 class="mdl-layout__drawer-button mdl-color-text--accent eevee-mobile-button mdl-layout--small-screen-only"> <i class=material-icons>&#xE5D2;</i> </div> <span class="eevee-logo mdl-color-text--accent mdl-layout-title"> <h2 id=top> <a href=https://kura.gg rel=bookmark title=kura.gg> kura.gg </a> </h2> </span> <div class=mdl-layout-spacer role=presentation></div> <nav class="eevee-nav mdl-navigation mdl-layout--large-screen-only" itemscope itemtype=http://schema.org/SiteNavigationElement aria-label="Header navigation"> <a class="mdl-color-text--accent mdl-navigation__link" href=/eevee/ itemprop=url rel=bookmark title=Eevee> <i class=material-icons aria-hidden=true>&#xE871;</i> Eevee </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/contact/ itemprop=url rel=bookmark title=Contact> <i class=material-icons aria-hidden=true>&#xE0B7;</i> Contact </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/software/ itemprop=url rel=bookmark title=Software> <i class=material-icons aria-hidden=true>&#xE86F;</i> Software </a> <a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons>&#xE02F;</i> Archives </a> <a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/rss.xml title=RSS itemprop=url> <i class=material-icons>&#xE0E5;</i> RSS </a> </nav> </div> </header> <div class="eevee-mobile-header mdl-layout__drawer mdl-color--white" aria-hidden=true> <span class=mdl-layout-title> <h2 class="eevee-mobile-logo mdl-color-text--accent"> kura.gg </h2> </span> <div class="mdl-navigation mdl-color--white"> <nav class="eevee-nav mdl-navigation" itemscope itemtype=http://schema.org/SiteNavigationElement aria-label="Header navigation"> <a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg itemprop=url rel=bookmark> <i class=material-icons aria-hidden=true> &#xE88A; </i> Home </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/eevee/ itemprop=url rel=bookmark title=Eevee> <i class=material-icons aria-hidden=true>&#xE871;</i> Eevee </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/contact/ itemprop=url rel=bookmark title=Contact> <i class=material-icons aria-hidden=true>&#xE0B7;</i> Contact </a> <a class="mdl-color-text--accent mdl-navigation__link" href=/software/ itemprop=url rel=bookmark title=Software> <i class=material-icons aria-hidden=true>&#xE86F;</i> Software </a> <a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons>&#xE02F;</i> Archives </a> <a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/rss.xml title=RSS itemprop=url> <i class=material-icons>&#xE0E5;</i> RSS </a> </nav> </div> </div> <div class="eevee-ribbon mdl-color--primary-dark" role=presentation> </div> <main class="eevee-main mdl-layout__content"> <div class="eevee-container mdl-grid"> <div role=presentation class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone"> </div> <div class="eevee-content mdl-color--white mdl-shadow--2dp mdl-color-text--grey-800 mdl-cell mdl-cell--8-col" aria-label="Main content"> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content="apache,load balancer,nginx,pound,reaip,x-forwarded-for"> <meta itemprop=keywords content=tutorials> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2011-08-10T12:34:00+01:00 itemprop=datePublished> 10 Aug 2011 </time>&nbsp;-- < 1 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2011/08/10/nginx-log-real-ip-from-pound/ rel=bookmark title="Permalink to 'nginx log real IP from Pound'" itemprop=url> nginx log real <span class=caps>IP</span> from&nbsp;Pound </a> </h2> <section itemprop=articleBody class=summary-content> <p>Recently I started using Pound as a load balancer to a cluster of nginx servers and found my access logs were filled with the <span class=caps>IP</span> address of the load balancer. I did some digging and found the correct way to “fix” this.</p> <p>First thing you need to do is make sure you remove X-Forwarded-For from Pound</p> <pre class=literal-block>
ListenHTTP
    # ... snip ...
    # ... snip ...
    HeadRemove "X-Forwarded-For"
End
</pre> <p>Once this is done, reload Pound.</p> <p>Next you need nginx compiled with realip module - <a class="reference external" href=https://wiki.nginx.org/NginxHttpRealIpModule>https://wiki.nginx.org/NginxHttpRealIpModule</a></p> <p>On Ubuntu/Debian servers this module comes by default, otherwise you may have to compile it in yourself using the following option:</p> <div class=highlight><pre><span></span>--with-http_realip_module
</pre></div> <p>Once this is all done modify your nginx vhosts and add the following 2 lines</p> <div class=highlight><pre><span></span><span class=k>set_real_ip_from</span> <span class=s>[IP]</span><span class=p>;</span>
<span class=k>real_ip_header</span> <span class=s>X-Forwarded-For</span><span class=p>;</span>
</pre></div> <p>Where [<span class=caps>IP</span>] is the <span class=caps>IP</span> address of your load balancer.</p> <p>To configure this to work with Apache you need the …</p> </section> <div class="eevee-divider mdl-color--accent" role=presentation></div> <div class=eevee-divider-to-top> <a href=#top title="Back to the top of the page" itemprop=url> Back to the top of the page </a> </div> </article> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content=apache,nginx,varnish,wordpress> <meta itemprop=keywords content=tutorials> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-09-26T19:41:00+01:00 itemprop=datePublished> 26 Sep 2010 </time>&nbsp;-- 6 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2010/09/26/nginx-varnish-apache2/ rel=bookmark title="Permalink to 'WordPress + nginx + Varnish + Apache 2'" itemprop=url> WordPress + nginx + Varnish + Apache&nbsp;2 </a> </h2> <section itemprop=articleBody class=summary-content> <p>Lately I’ve been doing a lot of work with Varnish, this includes testing it within a load balanced environment, putting it behind nginx, putting it in front of Solr, the list goes on.</p> <p>This blog post will hopefully give you an insight in to a simple way of combining nginx, Varnish and Apache to create a powerful Wordpress environment that can really take a hammering.</p> <p>I’m going to assume you already have Apache and nginx working together, if not I suggest you read my other articles on these subjects to learn how to combine them.</p> <div class=section id=installing-varnish> <h2>Installing Varnish</h2> <div class=highlight><pre><span></span>sudo apt-get install varnish
</pre></div> </div> <div class=section id=configuring-apache> <h2>Configuring Apache</h2> <p>I suggest binding Apache to port 81, this is easy to change, open the following file in your favourite editor.</p> <blockquote> /etc/apache2/ports.conf</blockquote> <p>Change the Listen and NameVirtualHost lines to:</p> <div class=highlight><pre><span></span><span class=nb>Listen</span> <span class=m>81</span>
<span class=nb>NameVirtualHost</span> *:81
</pre></div> <p>This will mean you need to go and change all …</p></div> </section> <div class="eevee-divider mdl-color--accent" role=presentation></div> <div class=eevee-divider-to-top> <a href=#top title="Back to the top of the page" itemprop=url> Back to the top of the page </a> </div> </article> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content=apache,cache,nginx,proxy,proxy_cache,wordpress> <meta itemprop=keywords content=tutorials> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-04-18T12:51:00+01:00 itemprop=datePublished> 18 Apr 2010 </time>&nbsp;-- 4 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2010/04/18/new-syslog-tv-nginx-wordpress-site-configuration/ rel=bookmark title="Permalink to 'New syslog.tv nginx wordpress site configuration explained'" itemprop=url> New syslog.tv nginx wordpress site configuration&nbsp;explained </a> </h2> <section itemprop=articleBody class=summary-content> <div class=section id=configuration-changes> <h2>Configuration changes</h2> <p>I made some modifications to my nginx configuration this weekend to improve performance and clear up some bugs.</p> <div class=highlight><pre><span></span><span class=k>upstream</span> <span class=s>backend</span> <span class=p>{</span>
    <span class=kn>server</span> <span class=n>127.0.0.1</span><span class=p>:</span><span class=mi>81</span> <span class=s>fail_timeout=120s</span><span class=p>;</span>
<span class=p>}</span>

<span class=k>server</span> <span class=p>{</span>
    <span class=kn>listen</span> <span class=mi>80</span><span class=p>;</span>
    <span class=kn>server_name</span> <span class=s>syslog.tv</span><span class=p>;</span>

    <span class=kn>access_log</span> <span class=s>/var/log/nginx/access.syslog.tv.log</span><span class=p>;</span>

    <span class=kn>gzip</span> <span class=no>on</span><span class=p>;</span>
    <span class=kn>gzip_disable</span> <span class=s>msie6</span><span class=p>;</span>
    <span class=kn>gzip_static</span> <span class=no>on</span><span class=p>;</span>
    <span class=kn>gzip_comp_level</span> <span class=mi>9</span><span class=p>;</span>
    <span class=kn>gzip_proxied</span> <span class=s>any</span><span class=p>;</span>
    <span class=kn>gzip_types</span> <span class=s>text/plain</span> <span class=s>text/css</span> <span class=s>application/x-javascript</span> <span class=s>text/xml</span>
    <span class=s>application/xml</span> <span class=s>application/xml+rss</span> <span class=s>text/javascript</span><span class=p>;</span>

   <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
        <span class=kn>root</span> <span class=s>/var/www/syslog.tv</span><span class=p>;</span>

        <span class=kn>set</span> <span class=nv>$wordpress_logged_in</span> <span class=s>""</span><span class=p>;</span>
        <span class=kn>set</span> <span class=nv>$comment_author_email</span> <span class=s>""</span><span class=p>;</span>
        <span class=kn>set</span> <span class=nv>$comment_author</span> <span class=s>""</span><span class=p>;</span>

        <span class=kn>if</span> <span class=s>(</span><span class=nv>$http_cookie</span> <span class=p>~</span><span class=sr>*</span> <span class=s>"wordpress_logged_in_[^=]*=([^%]+)%7C")</span> <span class=p>{</span>
             <span class=kn>set</span> <span class=nv>$wordpress_logged_in</span> <span class=s>wordpress_logged_in_</span><span class=nv>$1</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=kn>if</span> <span class=s>(</span><span class=nv>$http_cookie</span> <span class=p>~</span><span class=sr>*</span> <span class=s>"comment_author_email_[^=]*=([^</span><span class=p>;</span><span class=kn>]+)(</span><span class=p>;</span><span class=kn>|$)")</span> <span class=p>{</span>
            <span class=kn>set</span> <span class=nv>$comment_author_email</span> <span class=s>comment_author_email_</span><span class=nv>$1</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=kn>if</span> <span class=s>(</span><span class=nv>$http_cookie</span> <span class=p>~</span><span class=sr>*</span> <span class=s>"comment_author_[^=]*=([^</span><span class=p>;</span><span class=kn>]+)(</span><span class=p>;</span><span class=kn>|$)")</span> <span class=p>{</span>
            <span class=kn>set</span> <span class=nv>$comment_author</span> <span class=s>comment_author_</span><span class=nv>$1</span><span class=p>;</span>
        <span class=p>}</span>

        <span class=kn>set</span> <span class=nv>$my_cache_key</span> <span class=s>"</span><span class=nv>$scheme://$host$uri$is_args$args$wordpress_logged_in$comment …</span></pre></div></div> </section> <div class="eevee-divider mdl-color--accent" role=presentation></div> <div class=eevee-divider-to-top> <a href=#top title="Back to the top of the page" itemprop=url> Back to the top of the page </a> </div> </article> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content="apache,load average"> <meta itemprop=keywords content=tutorials> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-03-27T19:29:00+00:00 itemprop=datePublished> 27 Mar 2010 </time>&nbsp;-- 2 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2010/03/27/apache-internal-dummy-connection/ rel=bookmark title="Permalink to 'Apache internal dummy connection'" itemprop=url> Apache internal dummy&nbsp;connection </a> </h2> <section itemprop=articleBody class=summary-content> <p>Recently I found that one of the servers I look after that runs a high profile site was generating semi-high load at traffic peaks. You could generally say that this would be understandable but the server was shooting up to a load of around 10 for a few seconds and with that load jump I was able to graph an increase of Apache processes on top of it. Again though, this would generally be considered normal, but knowing how well the server performs and having nginx sitting on top handling all static content I knew something wasn’t quite right.</p> <p>Looking through the logs I found quite a lot of requests from a badly written spider which was generating a lot of server load when it hit the server, but after <span class=caps>IP</span> banning the culprit I also found several instances of Apache waking it’s child processes.</p> <pre class=literal-block>
127.0.0 …</pre> </section> <div class="eevee-divider mdl-color--accent" role=presentation></div> <div class=eevee-divider-to-top> <a href=#top title="Back to the top of the page" itemprop=url> Back to the top of the page </a> </div> </article> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content=apache,log,nginx,proxy> <meta itemprop=keywords content=tutorials> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-03-20T19:24:00+00:00 itemprop=datePublished> 20 Mar 2010 </time>&nbsp;-- < 1 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2010/03/20/show-ip-in-apache-logs-from-nginx-reverse-proxy/ rel=bookmark title="Permalink to 'Show IP in Apache logs from nginx reverse proxy'" itemprop=url> Show <span class=caps>IP</span> in Apache logs from nginx reverse&nbsp;proxy </a> </h2> <section itemprop=articleBody class=summary-content> <p>This is a very quick blog to show you how to show a users <span class=caps>IP</span> address in your Apache access logs when the site in question is being reverse proxied to Apache through nginx.</p> <p>You need the rpaf module for Apache, on Debian and Ubuntu this is simple to install</p> <div class=highlight><pre><span></span>sudo apt-get install libapache2-mod-rpaf
sudo a2enmod rpaf
sudo /etc/init.d/apache2 restart
</pre></div> <p>This set of commands will do the following;</p> <ol class="arabic simple"> <li>Update apt package list</li> <li>Install libapache2-mod-rpaf</li> <li>Enable mod-rpaf</li> <li>Gracefully restart Apache (doesn’t kill connections)</li> </ol> <p>Once installed you simple need to be sure to pass the correct headers through, so open up one of your nginx site configuration files and add the following within the server definition.</p> <div class=highlight><pre><span></span><span class=k>proxy_set_header</span> <span class=s>X-Forwarded-For</span> <span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
</pre></div> <p>So you should have something that looks like this, but without the “… snip …”</p> <div class=highlight><pre><span></span><span class=k>server</span> <span class=p>{</span>
    <span class=c1># ...snip...</span>
    <span class=kn>location</span> <span class=s>/</span> <span class=p>{</span>
        <span class=c1># ...snip...</span>
        <span class=kn>proxy_set_header</span> <span class=s>X-Forwarded-For</span> <span class=nv>$proxy_add …</span></pre></div> </section> <div class="eevee-divider mdl-color--accent" role=presentation></div> <div class=eevee-divider-to-top> <a href=#top title="Back to the top of the page" itemprop=url> Back to the top of the page </a> </div> </article> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content=apache,certificate,crt,der,pem,ssl> <meta itemprop=keywords content=tutorials> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-03-03T17:26:00+00:00 itemprop=datePublished> 03 Mar 2010 </time>&nbsp;-- < 1 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2010/03/03/convert-der-certificate-to-pem/ rel=bookmark title="Permalink to 'Convert DER certificate to PEM'" itemprop=url> Convert <span class=caps>DER</span> certificate to <span class=caps>PEM</span> </a> </h2> <section itemprop=articleBody class=summary-content> <p>Some times as an administrator you will be given a certificate from a third party that will be in the <span class=caps>DER</span> format, which cannot be loaded in to Apache.</p> <p>Converting it is a simple process:</p> <div class=highlight><pre><span></span>openssl x509 -in certificate.crt -inform DER -out certificate.pem -outform PEM
</pre></div> </section> <div class="eevee-divider mdl-color--accent" role=presentation></div> <div class=eevee-divider-to-top> <a href=#top title="Back to the top of the page" itemprop=url> Back to the top of the page </a> </div> </article> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content="apache,cache,debian,howto,load balancing,nginx,ubuntu,wordpress"> <meta itemprop=keywords content=tutorials> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-02-14T14:27:00+00:00 itemprop=datePublished> 14 Feb 2010 </time>&nbsp;-- 4 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2010/02/14/more-nginx-proxy_cache-optimizations-and-nginx-load-balancing/ rel=bookmark title="Permalink to 'More nginx proxy_cache optimizations and nginx load balancing'" itemprop=url> More nginx proxy_cache optimizations and nginx load&nbsp;balancing </a> </h2> <section itemprop=articleBody class=summary-content> <p>This is yet another follow up to post to several previous posts about using nginx as a reverse proxy with caching. It is actually a direct addition to my post from a week or so ago which outlined how to actually using nginx’s proxy caching feature which can be read here — <a href=https://syslog.tv/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/ class="reference external">/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/</a>.</p> <div class=section id=even-more-changes> <h2>Even more changes?</h2> <p>Yes, even more changes, these are basic changes that are there to improve the caching capabilities and also implement load balancing.</p> <div class=section id=cache-changes> <h3>Cache changes</h3> <p>The first set of changes are in the main nginx configuration file</p> <blockquote> /etc/nginx/nginx.conf</blockquote> <p>These changes basically just change the proxy_cache key</p> <div class=highlight><pre><span></span><span class=k>proxy_cache_path</span> <span class=s>/var/www/nginx_cache</span> <span class=s>levels=1:2</span> <span class=s>keys_zone=cache:8m</span> <span class=s>max_size=1000m</span> <span class=s>inactive=600m</span><span class=p>;</span>
<span class=k>proxy_temp_path</span> <span class=s>/tmp/nginx</span><span class=p>;</span>
<span class=k>proxy_cache_key</span> <span class=s>"</span><span class=nv>$scheme://$host$request_uri"</span><span class=p>;</span>
</pre></div> <p>I’ve decided to put the temporary caches file in to …</p></div></div> </section> <div class="eevee-divider mdl-color--accent" role=presentation></div> <div class=eevee-divider-to-top> <a href=#top title="Back to the top of the page" itemprop=url> Back to the top of the page </a> </div> </article> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content=apache,code_swarm,postgresql,python> <meta itemprop=keywords content=misc> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-02-13T23:01:00+00:00 itemprop=datePublished> 13 Feb 2010 </time>&nbsp;-- < 1 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2010/02/13/code_swarm-apache-python-and-postgresql-commit-visualization/ rel=bookmark title="Permalink to 'code_swarm - Apache, Python and PostgreSQL commit visualization'" itemprop=url> code_swarm - Apache, Python and PostgreSQL commit&nbsp;visualization </a> </h2> <section itemprop=articleBody class=summary-content> <p>These videos are pretty old now and I had forgotten about them until a colleague tweeted about a Twitter code_swarm visualization which made me remember.</p> <p>So here they are, best viewed in full screen mode.</p> <div class=section id=apache> <h2>Apache</h2> <div align=center class=vimeo><iframe allowfullscreen frameborder=0 height=500 mozallowfullscreen src=https://player.vimeo.com/video/1076588 webkitallowfullscreen width=800></iframe></div></div> <div class=section id=python> <h2>Python</h2> <div align=center class=vimeo><iframe allowfullscreen frameborder=0 height=500 mozallowfullscreen src=https://player.vimeo.com/video/1093745 webkitallowfullscreen width=800></iframe></div></div> <div class=section id=postgresql> <h2>PostgreSQL</h2> <div align=center class=vimeo><iframe allowfullscreen frameborder=0 height=500 mozallowfullscreen src=https://player.vimeo.com/video/1081680 webkitallowfullscreen width=800></iframe></div></div> </section> <div class="eevee-divider mdl-color--accent" role=presentation></div> <div class=eevee-divider-to-top> <a href=#top title="Back to the top of the page" itemprop=url> Back to the top of the page </a> </div> </article> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content=apache,cache,debian,howto,nginx,php,ubuntu,wordpress> <meta itemprop=keywords content=tutorials> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-02-07T10:27:00+00:00 itemprop=datePublished> 07 Feb 2010 </time>&nbsp;-- 7 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/ rel=bookmark title="Permalink to 'nginx, proxy_cache and reverse proxying explained & benchmarked'" itemprop=url> nginx, proxy_cache and reverse proxying explained <span class=amp>&amp;</span>&nbsp;benchmarked </a> </h2> <section itemprop=articleBody class=summary-content> <div class=section id=the-beginning> <h2>The beginning</h2> <p>Where to begin? nginx would be a good start I suppose. It’s far easier and makes much for sense for you to actually read about nginx from it’s own website - <a href=https://nginx.org/en/ class="reference external">https://nginx.org/en/</a> - but just to give a simple explanation too; `nginx is king of static content <span class=caps>HTTP</span> servers.`</p> <p>Anyone that has dealt with Apache on medium to high traffic websites will know that Apache is bit of a `wheezy, old geezer` when it comes to content serving using it’s mpm-worker (threaded). Very often high traffic will cause server load to go through the roof but for serving dynamic content, there really is no better <span class=caps>HTTP</span> server than Apache, so this leaves us in a bit of a predicament; a high powered website with dynamic content and lots of static files like <span class=caps>JS</span>, <span class=caps>CSS</span> and imagery, what do we do?!</p> <p>In this example `dynamic …</p></div> </section> <div class="eevee-divider mdl-color--accent" role=presentation></div> <div class=eevee-divider-to-top> <a href=#top title="Back to the top of the page" itemprop=url> Back to the top of the page </a> </div> </article> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content=apache,cache,nginx,varnish> <meta itemprop=keywords content=tutorials> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-02-06T10:36:00+00:00 itemprop=datePublished> 06 Feb 2010 </time>&nbsp;-- 4 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2010/02/06/using-nginx-varnish-and-apache/ rel=bookmark title="Permalink to 'Using nginx, Varnish and Apache'" itemprop=url> Using nginx, Varnish and&nbsp;Apache </a> </h2> <section itemprop=articleBody class=summary-content> <div class=section id=the-problem> <h2>The problem</h2> <p>So lets get to the problem first. I have several lightly to medium loaded sites running on some virtual servers, they servers themselves are highly configured to run beautifully on our host environments, very, very <span class=caps>RAM</span> intensive but low disk I/O and low <span class=caps>CPU</span> usage.</p> <p>As mentioned, the sites are relatively low loaded, they’ll generally hang around at between 3,000-5,000 unique hits a day and are run through Apache using <span class=caps>PHP</span>, various <span class=caps>PHP</span> modules and MySQL, a simple generic <span class=caps>LAMP</span> environment, yet customised to suit it’s surroundings and host.</p> <p>The sites themselves run fine on that setup, no issues at all on normal days, but on set days of the week these sites can double in unique hits or even more than double, with KeepAlive enabled and a KeepAliveTimeout set low Apache has problems handling this kind of load (I should point out …</p></div> </section> <div class="eevee-divider mdl-color--accent" role=presentation></div> <div class=eevee-divider-to-top> <a href=#top title="Back to the top of the page" itemprop=url> Back to the top of the page </a> </div> </article> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content=apache,debian,eth0,howto,mod_ssl,networking,ssl,vhost> <meta itemprop=keywords content=tutorials> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-01-15T06:24:00+00:00 itemprop=datePublished> 15 Jan 2010 </time>&nbsp;-- 1 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2010/01/15/howto-debian-apache2-ssl-multiple-vhosts/ rel=bookmark title="Permalink to 'HOWTO: Debian - Apache 2 SSL on multiple virtual hosts'" itemprop=url> <span class=caps>HOWTO</span>: Debian - Apache 2 <span class=caps>SSL</span> on multiple virtual&nbsp;hosts </a> </h2> <section itemprop=articleBody class=summary-content> <p>Figured I’d write this one up quickly as it proved to annoy the hell out of me at 4:30am this morning getting it working on a live server.</p> <p>Apache 2 can serve <span class=caps>SSL</span> content to multiple vhosts on your setup, provided they use different <span class=caps>IP</span> addresses, this post will give you a quick run down on how to do it.</p> <p>First up we need to actually add the new <span class=caps>IP</span> to the machine in /etc/network/interfaces.</p> <pre class=literal-block>
auto eth0
iface eth0 inet static
    address 10.1.1.7
    netmask 255.255.255.0
    gateway 10.1.1.1

auto eth0:1
iface eth0:1 inet static
    address 10.1.1.8
    netmask 255.255.255.0
</pre> <p>Replace my IPs with your own.</p> <p>Restart networking.</p> <div class=highlight><pre><span></span>sudo /etc/init.d/networking restart
</pre></div> <p>Next task is Apache 2 to configure it to listen on both IPs.</p> <blockquote> /etc/apache2/ports.conf</blockquote> <p>My …</p> </section> <div class="eevee-divider mdl-color--accent" role=presentation></div> <div class=eevee-divider-to-top> <a href=#top title="Back to the top of the page" itemprop=url> Back to the top of the page </a> </div> </article> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content=apache,debian,denyhosts,howto,logwatch,php,security> <meta itemprop=keywords content=tutorials> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-01-14T19:57:00+00:00 itemprop=datePublished> 14 Jan 2010 </time>&nbsp;-- 4 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2010/01/14/howto-debian-server-security/ rel=bookmark title="Permalink to 'HOWTO: Debian server security'" itemprop=url> <span class=caps>HOWTO</span>: Debian server&nbsp;security </a> </h2> <section itemprop=articleBody class=summary-content> <p>Server security is something I’ve always tried to keep myself up-to-date on. I have at least a dozen <span class=caps>RSS</span> feeds that I read daily to learn about the latest flaws, holes releases etc. That being said I am by no means an “expert”, I’ve learned what I’ve needed to learn over time. I like to think that over the years I’ve gained enough knowledge to almost completely secure servers with all the programs installed that I generally use.</p> <p>The aim of this article is to introduce you to some of the programs I use for security and some config changes that can be made to other programs to make them more secure. It is aimed at web servers but other changes work anywhere, like the <span class=caps>SSH</span> changes.</p> <div class=section id=ssh> <h2><span class=caps>SSH</span></h2> <p>We’ll start with a very simple change that makes a very big difference, a change to the …</p></div> </section> <div class="eevee-divider mdl-color--accent" role=presentation></div> <div class=eevee-divider-to-top> <a href=#top title="Back to the top of the page" itemprop=url> Back to the top of the page </a> </div> </article> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content=apache,debian,mod_ssl,ssl> <meta itemprop=keywords content=tutorials> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-01-12T22:57:00+00:00 itemprop=datePublished> 12 Jan 2010 </time>&nbsp;-- 4 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2010/01/12/howto-debian-apache-2-amp-mod_ssl/ rel=bookmark title="Permalink to 'HOWTO: Debian, Apache 2 & mod_ssl with self signed cert. or officially signed cert.'" itemprop=url> <span class=caps>HOWTO</span>: Debian, Apache 2 <span class=amp>&amp;</span> mod_ssl with self signed cert. or officially signed&nbsp;cert. </a> </h2> <section itemprop=articleBody class=summary-content> <p>This is gonna be quite a simple tutorial that should be the same (excluding pathing and apt) across other Linux distros.</p> <div class=section id=installation> <h2>Installation</h2> <p>First off we’ll get Apache and mod_ssl install</p> <div class=highlight><pre><span></span>sudo apt-get install apache2
</pre></div> <p><span class=caps>SSL</span> should be enabled by default, if not run the following</p> <div class=highlight><pre><span></span>sudo a2enmod ssl
</pre></div> </div> <div class=section id=ssl-certificate> <h2><span class=caps>SSL</span> certificate</h2> <p>There are several ways of doing this, the first you need to figure out is if you want a self signed certificate or one signed by a provider like GeoTrust, this type is not free. In this article I’ll cover both, starting with self signed.</p> <div class=section id=self-signed> <h3>Self signed</h3> <div class=highlight><pre><span></span>sudp mkdir /etc/apache2/ssl
sudo /usr/sbin/make-ssl-cert /usr/share/ssl-cert/ssleay.cnf /etc/apache2/ssl/apache.pem
</pre></div> </div> <div class=section id=provider-signed> <h3>Provider signed</h3> <p>Please note, this type of certificate has to be paid for, prices at time of writing range from £15/year to £2,000/year.</p> <p>There are actually some more …</p></div></div> </section> <div class="eevee-divider mdl-color--accent" role=presentation></div> <div class=eevee-divider-to-top> <a href=#top title="Back to the top of the page" itemprop=url> Back to the top of the page </a> </div> </article> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content=apache,cache,debian,nginx,wordpress> <meta itemprop=keywords content=tutorials> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-01-12T00:37:00+00:00 itemprop=datePublished> 12 Jan 2010 </time>&nbsp;-- 2 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2010/01/12/apache-2-nginx-wordpress-mu-follow-up/ rel=bookmark title="Permalink to 'Apache 2, Nginx & WordPress MU - Follow up'" itemprop=url> Apache 2, Nginx <span class=amp>&amp;</span> WordPress <span class=caps>MU</span> - Follow&nbsp;up </a> </h2> <section itemprop=articleBody class=summary-content> <p>This is a quick follow up to a previous post about getting this blog <a href=/2010/01/11/debian-apache-2-nginx-wordpress-mu/ class="reference external">running on nginx with a reverse proxy to Apache 2</a>.</p> <p>It seems the issue stems from 3 mods I had installed and enabled</p> <ol class="arabic simple"> <li>mod-spamhaus</li> <li>mod-evasive and</li> <li>mod-security</li> </ol> <p>The 3, when running together are a fantastic way to strengthen any web server from attack, be it <span class=caps>DOS</span>, injection, <span class=caps>XLS</span> etc. I’ve sworn by all 3 of them for years now and I thought I had them cracked for security:performance ratio, when it comes to reverse proxying requests from nginx to Apache 2 where WordPress is concerned, apparently I was very wrong.</p> <p>The issue wasn’t so bad when the cache was full, but seeing as my cache is only alive for an hour that leaves an open point for the cache to be recreated when a user views the page. This in itself isn’t …</p> </section> <div class="eevee-divider mdl-color--accent" role=presentation></div> <div class=eevee-divider-to-top> <a href=#top title="Back to the top of the page" itemprop=url> Back to the top of the page </a> </div> </article> <article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting> <meta itemprop=accessibilityControl content=fullKeyboardControl> <meta itemprop=accessibilityControl content=fullMouseControl> <meta itemprop=accessibilityControl content=bookmarks> <meta itemprop=accessibilityControl content=captions> <meta itemprop=accessibilityControl content=alternativeText> <meta itemprop=accessibilityControl content=index> <meta itemprop=accessibilityControl content=readingOrder> <meta itemprop=accessibilityControl content=structuralNavigation> <meta itemprop=accessibilityControl content=tableOfContents> <meta itemprop=accessibilityHazard content=noFlashingHazard> <meta itemprop=accessibilityHazard content=noMotionSimulationHazard> <meta itemprop=accessibilityHazard content=noSoundHazard> <meta itemprop=accessibilityAPI content=ARIA> <div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation /> <a href=https://kura.gg/authors/kura/ class=hidden itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a> </div> <meta itemprop=keywords content=apache,cache,debian,nginx,wordpress> <meta itemprop=keywords content=tutorials> <div class="eevee-meta mdl-color-text--grey-500"> <time datetime=2010-01-11T19:58:00+00:00 itemprop=datePublished> 11 Jan 2010 </time>&nbsp;-- 5 min read </div> <h2 itemprop=name class=article-title> <a href=https://kura.gg/2010/01/11/debian-apache-2-nginx-wordpress-mu/ rel=bookmark title="Permalink to 'Debian, Apache 2, Nginx, WordPress MU & WP-Super-Cache'" itemprop=url> Debian, Apache 2, Nginx, WordPress <span class=caps>MU</span> <span class=amp>&amp;</span> <span class=caps>WP</span>-Super-Cache </a> </h2> <section itemprop=articleBody class=summary-content> <p><em>This is a rather old article, for more up-to-date information please see;</em></p> <ol class="arabic simple"> <li><a href=/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/ class="reference external">/2010/02/07/nginx-proxy_cache-and-explained-benchmarked/</a></li> <li><a href=/2010/02/14/more-nginx-proxy_cache-optimizations-and-nginx-load-balancing/ class="reference external">/2010/02/14/more-nginx-proxy_cache-optimizations-and-nginx-load-balancing/</a></li> </ol> <p>I’ve started collecting a few blogs on my servers now and figured from this one on I would consolidate it in to one workable, usable location. Removing my need to update multiple plugins, themes and WordPress itself, over and over.</p> <p>This time round I thought I’d do it properly, and properly in my book is as complicated and “awesome” as it can possibly be, without growing legs and running off to stomp a city.</p> <div class=section id=love> <h2>Love</h2> <p>I’ve fallen in-love with nginx (<a href=https://nginx.org/ class="reference external">https://nginx.org/</a>) over the last 6 months or so, I’d been an avid user of LighTTPD for a very long time before but started to look in to nginx mid year as a replacement. I learned that at my new job they used …</p></div> </section> </article> <div class=eevee-page-spacer role=presentation></div> </div> </div> </main> <div class="eevee-pagination__container eevee-container mdl-grid"> <div role=presentation class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone"> </div> <div class="mdl-color-text--grey-800 mdl-cell mdl-cell--8-col"> <nav class="eevee-pagination mdl-cell mdl-cell--12-col" itemscope itemtype=http://schema.org/SiteNavigationElement aria-label=Pagination> <div class=eevee-spacer></div> </nav> </div> </div> <footer class=mdl-mega-footer itemscope itemtype=http://schema.org/SiteNavigationElement> <div class=mdl-mega-footer--top-section> <div class=mdl-mega-footer--drop-down-section> <ul class=mdl-mega-footer--link-list> <li> <a href=#top itemprop=url title="Back to the top of the page"> Back to the top of the page </a> </li> </ul> </div> </div> <div class=mdl-mega-footer--middle-section itemscope itemtype=http://schema.org/SiteNavigationElement aria-label="Footer navigation"> <div class=mdl-mega-footer--drop-down-section> <h1 class=mdl-mega-footer--heading>Menu</h1> <ul class=mdl-mega-footer--link-list> <li> <a href=/eevee/ itemprop=url rel=bookmark title=Eevee> <i class=material-icons aria-hidden=true>&#xE871;</i> Eevee </a> </li> <li> <a href=/contact/ itemprop=url rel=bookmark title=Contact> <i class=material-icons aria-hidden=true>&#xE0B7;</i> Contact </a> </li> <li> <a href=/software/ itemprop=url rel=bookmark title=Software> <i class=material-icons aria-hidden=true>&#xE86F;</i> Software </a> </li> <li> <a href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons>&#xE02F;</i> Archives </a> </li> <li> <a href=https://kura.gg/feeds/rss.xml title=RSS itemprop=url> <i class=material-icons>&#xE0E5;</i> RSS </a> </li> </ul> </div> <div class=mdl-mega-footer--drop-down-section> <h1 class=mdl-mega-footer--heading>Social</h1> <ul class=mdl-mega-footer--link-list> <li> <a href=https://github.com/kura itemprop=url rel=bookmark title=GitHub> <i class=fa aria-hidden=true>&#xF09B;</i> Github </a> </li> </ul> </div> <div class=mdl-mega-footer--drop-down-section> <h1 class=mdl-mega-footer--heading>Links</h1> <ul class=mdl-mega-footer--link-list> <li> <a href=https://kura.gg/blackhole itemprop=url rel=bookmark title=Blackhole> <i class=material-icons aria-hidden=true>&#xE86F;</i> Blackhole </a> </li> <li> <a href=https://kura.gg/yarg itemprop=url rel=bookmark title=Yarg> <i class=material-icons aria-hidden=true>&#xE86F;</i> Yarg </a> </li> <li> <a href=https://kura.gg/eevee itemprop=url rel=bookmark title=Eevee> <i class=material-icons aria-hidden=true>&#xE871;</i> Eevee </a> </li> <li> <a href=https://kura.gg/hauntr itemprop=url rel=bookmark title=Hauntr> <i class=material-icons aria-hidden=true>&#xE871;</i> Hauntr </a> </li> <li> <a href=https://kura.gg/ghastly itemprop=url rel=bookmark title=Ghastly> <i class=material-icons aria-hidden=true>&#xE871;</i> Ghastly </a> </li> </ul> </div> </div> <div class=mdl-mega-footer--bottom-section> <div class=mdl-logo> <a href=https://kura.gg rel=bookmark itemprop=url title=kura.gg> kura.gg </a> </div> <ul class="eevee-footer mdl-mega-footer--link-list"> <li>Powered by love &amp; rainbow sparkles.</li> <li>Source code and content released under the <a href=/license/ title="MIT license">MIT license</a>.</li> </ul> </div> </footer> </div> <link rel=stylesheet href=https://kura.gg/theme/css/eevee.min.css?e96887dc> <script async src=https://kura.gg/theme/js/eevee.min.js?9eda6833></script> </body> </html>