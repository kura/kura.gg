<!doctype html><html lang=en><meta charset=utf-8><meta content=width=device-width,initial-scale=1.0,minimum-scale=1.0 name=viewport><link href=https://kura.gg hreflang=en rel=alternate><link href=https://kura.gg rel=dns-prefetch><link href=https://kura.gg/theme/css/eevee.min.css?1c9d8344 rel=stylesheet><script async src=https://kura.gg/theme/js/eevee.min.js?1841d254></script><link href=https://kura.gg/feeds/rss.xml rel=alternate title=kura.gg type=application/rss+xml><link href=https://kura.gg/feeds/atom.xml rel=alternate title=kura.gg type=application/atom+xml><meta content=kura.gg property=og:site_name><meta content=article property=og:type><meta content=kura.gg property=og:title><meta content=https://kura.gg/authors/kura/page/3/index.html property=og:url><meta content=https://kura.gg/authors/kura/page/3/index.png property=og:image><meta content=1920 property=og:image:width><meta content=1080 property=og:image:height><meta content=kura.gg property=twitter:title><meta content=https://kura.gg/authors/kura/page/3/index.html property=twitter:url><meta content=https://kura.gg/authors/kura/page/3/index.png property=twitter:image><meta content=summary_large_image property=twitter:card><meta content=1920 property=twitter:image:width><meta content=1080 property=twitter:image:height><link sizes="16x16 32x32 48x48 64x64 128x128 256x256" href=/favicon.png rel=icon type=image/png><link sizes="16x16 32x32 48x48 64x64 128x128 256x256" href=/favicon.ico rel=icon type=image/vnd.microsoft.icon><title>kura</title><body><div class="eevee-layout mdl-layout mdl-js-layout mdl-color--grey-50"><header class="eevee-header mdl-color--grey-50 mdl-color-text--grey-800" itemscope itemtype=http://schema.org/WPHeader><div class=mdl-layout__header-row><div class="mdl-layout__drawer-button mdl-color-text--accent eevee-mobile-button mdl-layout--small-screen-only" aria-expanded=false role=button tabindex=0><i class=material-icons></i></div><span class="eevee-logo mdl-color-text--accent mdl-layout-title"> <h2 id=top><a href=https://kura.gg rel=bookmark title=kura.gg> kura.gg </a></h2> </span><div class=mdl-layout-spacer role=presentation></div><nav aria-label="Header navigation" class="eevee-nav mdl-navigation mdl-layout--large-screen-only" itemscope itemtype=http://schema.org/SiteNavigationElement><a class="mdl-color-text--accent mdl-navigation__link" href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons></i> Blackhole </a><a class="mdl-color-text--accent mdl-navigation__link" href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons></i> Eevee </a><a class="mdl-color-text--accent mdl-navigation__link" href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons></i> Hauntr </a><a class="mdl-color-text--accent mdl-navigation__link" href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons></i> Ghastly </a><a class="mdl-color-text--accent mdl-navigation__link" title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons></i> Pelican Plugins </a><a class="mdl-color-text--accent mdl-navigation__link" href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons></i> Contact </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons></i> Archives </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons></i> RSS </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons></i> Atom </a></nav></div></header><div class="eevee-mobile-header mdl-layout__drawer mdl-color--white" aria-hidden=true><span class=mdl-layout-title> <h2 class="eevee-mobile-logo mdl-color-text--accent">kura.gg</h2> </span><div class="mdl-navigation mdl-color--white"><nav aria-label="Header navigation" class="eevee-nav mdl-navigation" itemscope itemtype=http://schema.org/SiteNavigationElement><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons>  </i> Home </a><a class="mdl-color-text--accent mdl-navigation__link" href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons></i> Blackhole </a><a class="mdl-color-text--accent mdl-navigation__link" href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons></i> Eevee </a><a class="mdl-color-text--accent mdl-navigation__link" href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons></i> Hauntr </a><a class="mdl-color-text--accent mdl-navigation__link" href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons></i> Ghastly </a><a class="mdl-color-text--accent mdl-navigation__link" title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons></i> Pelican Plugins </a><a class="mdl-color-text--accent mdl-navigation__link" href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons></i> Contact </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons></i> Archives </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons></i> RSS </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons></i> Atom </a></nav></div></div><div class="eevee-ribbon mdl-color--primary-dark" role=presentation></div><main class="eevee-main mdl-layout__content"><div class="eevee-container mdl-grid"><div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone" role=presentation></div><div aria-label="Main content" class="eevee-content mdl-color--white mdl-shadow--2dp mdl-color-text--grey-800 mdl-cell mdl-cell--8-col"><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=bash,dash,ps1,git itemprop=keywords><meta content=coding itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-08-18T17:25:00+01:00 itemprop=datePublished> 18 Aug 2013 </time> — < 1 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'My $PS1 with git branch, new files, staged files and commit status'" href=https://kura.gg/2013/08/18/my-ps1-with-git-branch-new-files-staged-files-and-commit-status/ itemprop=url rel=bookmark> My $<span class=caps>PS1</span> with git branch, new files, staged files and commit status </a></h2><section class=summary-content itemprop=articleBody><p>I love my prompt, always have and always will. I spend so much of my life in a terminal, usually with half a dozen mini terminals open in each tab. As such I like to tweak it and get it as perfect as possible for my life, needs and even mood.<p>In the past I’ve had quite a large <span class=caps>PS1</span> that covers multiple lines and gives a lot of information, after having that <span class=caps>PS1</span> in one form or another for some time I decided it was time for a change, to a smaller <span class=caps>PS1</span> that takes up a lot less space.<p>So here it is, the first image is my standard <span class=caps>PS1</span> when in a git repository, the red @ means a file hasn’t been added to Git, a blue @ means a tracked file has been modified but not stage and finally a green @ means a file is staged …</section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=python,blackhole,setup.py,entry_points,mock,tests,testing itemprop=keywords><meta content=coding itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-08-18T12:00:00+01:00 itemprop=datePublished> 18 Aug 2013 </time> — 6 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Blackhole 1.8.0 development, Mock and Python entry_points'" href=https://kura.gg/2013/08/18/blackhole-1.8.0-development-mock-and-python-entry-points/ itemprop=url rel=bookmark> Blackhole 1.8.0 development, Mock and Python entry_points </a></h2><section class=summary-content itemprop=articleBody><p>Over the last week I’ve been doing a huge amount of refactoring of <a class="reference external" href=https://blackhole.io>Blackhole</a> as well as writing dozens of additional tests. To make Blackhole more testable I needed to make a big change to how the program is launched and controlled.<div class=section id=setup-py-scripts-vs-entry-points><h2>setup.py scripts vs. entry_points</h2><p>Whenever I’ve written Python programs that require some kind of command line script I’ve always used distutils’ scripts, this can be seen <a class="reference external" href=https://github.com/kura/blackhole/blob/05c6647aeb25ecfcc17d9df535db330a68016a24/setup.py#L37-L39>in blackhole’s setup.py on GitHub</a> or in the three line example below.<div class=highlight><pre><span></span><span class=n>scripts</span><span class=o>=</span><span class=p>[</span>
    <span class=s1>'blackhole/bin/blackhole'</span><span class=p>,</span>
<span class=p>],</span>
</pre></div><p>In doing so, it allowed me to be lazy and write a lot of prodecural code in the main “binary” which made it pretty much impossible to test. You can also see that <a class="reference external" href=https://github.com/kura/blackhole/blob/bb6cccca3a75def324ed5cb64a32fd2e5773a038/blackhole/bin/blackhole>on GitHub in the main “binary”</a>.<p>I’ve noticed that most people who write Python packages that have some kind of command line entry point use distutils …</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=python,pelican,youtube,vimeo itemprop=keywords><meta content=coding itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-08-09T17:38:00+01:00 itemprop=datePublished> 09 Aug 2013 </time> — 3 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Writing a Vimeo and YouTube plugin for Pelican'" href=https://kura.gg/2013/08/09/writing-a-vimeo-and-youtube-plugin-for-pelican/ itemprop=url rel=bookmark> Writing a Vimeo and YouTube plugin for Pelican </a></h2><section class=summary-content itemprop=articleBody><p><a class="reference external" href=https://getpelican.com/>Pelican</a> is a Python-powered static blog generator that processes <a class="reference external" href=https://docutils.sourceforge.net/rst.html>ReStructuredText</a> and <a class="reference external" href=https://daringfireball.net/projects/markdown/>Markdown</a> articles and pages and converts them to <span class=caps>HTML</span>. I use Pelican to power this blog.<p>There is a YouTube <span class=caps>RST</span> directive built in to Pelican core but it really shouldn’t exist there.<p>I submitted a pull request for Pelican core to enable Vimeo videos in articles but that request was declined because it didn’t belong in the core. So I decided I would write it as a plugin instead and while I was doing it, also wrote a plugin for YouTube so that it could be removed from the core.<p><a class="reference external" href=https://docs.getpelican.com/en/3.2/plugins.html#how-to-create-plugins>There is a decent amount of detail in the Pelican documentation on how to write plugins</a>, I’m not going to cover the whole process but I thought I would cover a little of what I did.<div class=section id=adding-an-rst-directive><h2>Adding an <span class=caps>RST</span> directive</h2><p>Really all we’re doing …</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=python,tornado,iostream,ssl,starttls,blackhole itemprop=keywords><meta content=coding itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-07-31T13:36:00+01:00 itemprop=datePublished> 31 Jul 2013 </time> — 4 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Writing the STARTTLS command in to Blackhole'" href=https://kura.gg/2013/07/31/writing-the-starttls-command-in-to-blackhole/ itemprop=url rel=bookmark> Writing the <span class=caps>STARTTLS</span> command in to Blackhole </a></h2><section class=summary-content itemprop=articleBody><p>Blackhole has always been able to handle unencrypted <span class=caps>SMTP</span> and for a long time it’s been able to handle encrypted <span class=caps>SMTP</span> via TLSv1.<p>One thing Blackhole hasn’t been able to do until the 1.7.0 release is handle <cite><span class=caps>STARTTLS</span></cite>.<p>In the past the <cite><span class=caps>STARTTLS</span></cite> command would cause Blackhole to return the standard <cite>250 <span class=caps>OK</span></cite> response but would continue to operate on unencrypted <span class=caps>SMTP</span>.<p>I wanted to fix this and do it properly, but this meant learning how to do so with Tornado, which itself proved to be tricky. I ended up deciding to go to my local coding spot - the pub and hash it out.<div class=section id=connection-stream><h2>connection_stream</h2><p>The first thing I had to do was refactor the code that created the instance of <cite>tornado.iostream.IOStream</cite> and <cite>tornado.iostream.SSLIOStream</cite> so that it didn’t actually do the ssl wrapping.<div class=highlight><pre><span></span><span class=k>def</span> <span class=nf>connection_stream</span><span class=p>(</span><span class=n>connection</span><span class=p>):</span>
<span class=w>    </span><span class=sd>"""</span>
<span class=sd>    Detect which socket the connection …</span></pre></div></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=python,tornado,iostream,ssl,blackhole itemprop=keywords><meta content=coding itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-07-29T20:00:00+01:00 itemprop=datePublished> 29 Jul 2013 </time> — 2 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Wrapping a Tornado IOStream with SSL'" href=https://kura.gg/2013/07/29/wrapping-a-tornado-iostream-with-ssl/ itemprop=url rel=bookmark> Wrapping a Tornado IOStream with <span class=caps>SSL</span> </a></h2><section class=summary-content itemprop=articleBody><p>As part of my effort to make <a class="reference external" href=https://blackhole.io/>Blackhole</a> as useful and usable as possible, I needed to be able to support <span class=caps>SSL</span>/<span class=caps>TLS</span> enabled connections.<p>Tornado itself has two built-in IOStreams that help us do the job; the first is the standard <a class="reference external" href=https://www.tornadoweb.org/en/stable/iostream.html#tornado.iostream.IOStream>IOStream</a> and the second is the <a class="reference external" href=https://www.tornadoweb.org/en/stable/iostream.html#tornado.iostream.SSLIOStream>SSLIOStream</a>.<p>With this in mind we simply need to spawn two sockets, by default these listen on port 25 for standard <span class=caps>SMTP</span> and port 465 for <span class=caps>SSL</span>/<span class=caps>TLS</span> encrypted <span class=caps>SMTP</span>. With these two sockets bound we’re then very simply able to listen for incoming connections on either socket and use <cite>socket.socket.getsockname()</cite> to figure out if the connection is to the encrypted or unencrypted socket.<div class=section id=code><h2>Code</h2><div class=highlight><pre><span></span><span class=k>def</span> <span class=nf>connection_stream</span><span class=p>(</span><span class=n>connection</span><span class=p>):</span>
<span class=w>    </span><span class=sd>"""</span>
<span class=sd>    Detect which socket the connection is being made on,</span>
<span class=sd>    create and iostream for the connection, wrapping it</span>
<span class=sd>    in SSL if connected over the SSL socket.</span>

<span class=sd>    The parameter 'connection' is an instance …</span></pre></div></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=haproxy,stats itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-07-19T13:00:00+01:00 itemprop=datePublished> 19 Jul 2013 </time> — < 1 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'haproxy stats'" href=https://kura.gg/2013/07/19/haproxy-stats/ itemprop=url rel=bookmark> haproxy stats </a></h2><section class=summary-content itemprop=articleBody><p>I recently wrote an article on <a class="reference external" href=/2013/07/15/haproxy-nginx-and-spdy-with-ssl-termination-debian-7/>using haproxy, <span class=caps>SSL</span> and <span class=caps>SPDY</span> with nginx backend servers</a>.<p>This article is a little extra on top of that to explain how to enable statistics for haproxy so you can monitor the backend statuses etc.<div class=section id=example-stats-page><h2>Example stats page</h2><img alt="Moar stats!" src=/images/haproxy-stats.png></div><div class=section id=enabling-stats><h2>Enabling stats</h2><pre class=literal-block>
listen stats :8000
    mode http
    stats enable
    stats hide-version
    stats realm haproxy\ stats
    stats uri /
    stats auth admin:admin
</pre><p>Place the above content in the haproxy configuration file (<em>/etc/haproxy/haproxy.cfg</em>).<p>Be sure to replace <em>admin:admin</em> with your a proper username and password, username first, password after the colon.<p>Restart haproxy, and then browse to <a class="reference external" href=https://yoursite.com:8000>https://yousite.com:8000</a>.</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=python,pypy,blackhole,blackhole.io,mta,email,honeypot itemprop=keywords><meta content=talks itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-07-17T21:00:00+01:00 itemprop=datePublished> 17 Jul 2013 </time> — < 1 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'DJUGL June 2013 talk on blackhole and blackhole.io'" href=https://kura.gg/2013/07/17/djugl-june-2013-talk-on-blackhole-and-blackhole-io/ itemprop=url rel=bookmark> <span class=caps>DJUGL</span> June 2013 talk on blackhole and blackhole.io </a></h2><section class=summary-content itemprop=articleBody><p>I have been a frequent audience member of <a class="reference external" href=https://www.djugl.org/item/443153><span class=caps>DJUGL</span></a> for a few years now and spend most of the time asking questions, playing devils advocate and generally being my annoying self.<p>I have repeatedly said I would do a talk but never got round to it until <a class="reference external" href=https://twitter.com/JonWebJobs>Jon</a> basically forced me to get round to it.<p>My talk was on <a class="reference external" href=https://blackhole.io>blackhole/blackhole.io</a> and covered several topics including <a class="reference external" href=https://pypy.org>PyPy</a>, <a class="reference external" href=/simplemta/>SimpleMTA</a> and moved on to talking about spamming and starting work on my honey pot suite called <a class="reference external" href=https://nectar.blackhole.io>Nectar</a>.<p>You can find the slides on <a class="reference external" href=https://speakerdeck.com/kura/djugl-june-2013>Speaker Deck</a>, sadly I ran out of time when creating them and although I was promised time to finish them at work, I got busy. So I replaced content with “Taylor Replacements(tm)”.<p>The event, attendees and other speakers are listen on the <a class="reference external" href=https://lanyrd.com/2013/djugl-june/>Lanyrd event page</a>.<p>Several people took photos of the event, I don’t remember …</section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content="debian,ubuntu,haproxy,nginx,spdy,ssl,ssl termination" itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-07-15T22:30:00+01:00 itemprop=datePublished> 15 Jul 2013 </time> — 5 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'haproxy, nginx and SPDY with SSL termination (Debian 7)'" href=https://kura.gg/2013/07/15/haproxy-nginx-and-spdy-with-ssl-termination-debian-7/ itemprop=url rel=bookmark> haproxy, nginx and <span class=caps>SPDY</span> with <span class=caps>SSL</span> termination (Debian 7) </a></h2><section class=summary-content itemprop=articleBody><p><a class="reference external" href=/2013/07/10/nginx-spdy-and-ngx-pagespeed/>I wrote an article last week</a> explaining that I had changed my blog and built my own nginx packages with <a class="reference external" href=https://www.chromium.org/spdy><span class=caps>SPDY</span></a> built in.<p>I decided I would take things a little further and poke around with haproxy some more. The initial plan was to compile the latest dev source of haproxy with <span class=caps>SSL</span> termination enabled.<p>In doing so I realised I would lose <span class=caps>SPDY</span> support, which upset me a little. After some digging I found that the 1.5-dev branch of haproxy supports npn and thus can handle <span class=caps>SPDY</span>.<p>I tweaked my builds a little more and managed to get haproxy running as an <span class=caps>SSL</span> terminating load balancer, with <span class=caps>SPDY</span> connections being sent off to my nginx servers with <span class=caps>SPDY</span> enabled and all other non-<span class=caps>SPDY</span> connections were passed on to an nginx virtual host with <span class=caps>SPDY</span> disabled.<div class=section id=requirements><h2>Requirements</h2><p>I have released my haproxy build as a debian file below …</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=debian,ubuntu,nginx,spdy,pagespeed,ngx_pagespeed,mod_pagespeed itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-07-10T22:30:00+01:00 itemprop=datePublished> 10 Jul 2013 </time> — 2 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'nginx, SPDY and ngx_pagespeed (Debian/Ubuntu)'" href=https://kura.gg/2013/07/10/nginx-spdy-and-ngx-pagespeed/ itemprop=url rel=bookmark> nginx, <span class=caps>SPDY</span> and ngx_pagespeed (Debian/Ubuntu) </a></h2><section class=summary-content itemprop=articleBody><p>I decided to rebuild syslog.tv as pure <span class=caps>HTML</span> using <span class=caps>RST</span> and <a class="reference external" href=https://blog.getpelican.com/>Pelican</a> and rebrand it as kura.gg.<p>In doing so I decided I would go all out and use <a class="reference external" href=https://www.chromium.org/spdy><span class=caps>SPDY</span></a> and <a class="reference external" href=https://nginx.org/en/docs/http/ngx_http_spdy_module.html>ngx_pagespeed</a> (<a class="reference external" href=https://developers.google.com/speed/>mod_pagespeed</a>) for fun to see exactly what I could do.<p>Sadly no version of nginx has been officially released with <span class=caps>SPDY</span> or ngx_pagespeed enabled, you can compile nginx from source to enable <span class=caps>SPDY</span> so I thought I would go ahead and do it, releasing some Debian packages in the process.<p>After compiling nginx from the source package available at the <a class="reference external" href=https://launchpad.net/~nginx>Ubuntu <span class=caps>PPA</span></a>, I decided I would go further and compile in ngx_pagespeed.<div class=section id=installing><h2>Installing</h2><p>I have released the 4 required debian packages below (please note they are only available for amd64);<table class=docutils><thead><tr><th class=head><span class=caps>FILE</span><th class=head><span class=caps>GPG</span><th class=head><span class=caps>MD5</span><th class=head><span class=caps>SHA1</span><tbody><tr><td><a class="reference external" href=/files/nginx_1.4.1_all.deb>nginx_1.4.1_all.deb</a><td><a class="reference external" href=/files/nginx_1.4.1_all.deb.asc>owGMl1NwLw…</a><td><a class="reference external" href=/files/nginx_1.4.1_all.deb.md5>42f790a1f6…</a><td><a class="reference external" href=/files/nginx_1.4.1_all.deb.sha1>f4495055e9…</a><tr><td><a class="reference external" href=/files/nginx-common_1.4.1_all.deb>nginx-common_1.4.1_all.deb</a><td><a class="reference external" href=/files/nginx-common_1.4.1_all.deb.asc>owGMt1NwJU…</a><td><a class="reference external" href=/files/nginx-common_1.4.1_all.deb.md5>ca4ec5688d…</a><td><a class="reference external" href=/files/nginx-common_1.4.1_all.deb.sha1>633bfc2eaa…</a><tr><td><a class="reference external" href=/files/nginx-full_1.4.1_amd64.deb>nginx-full_1.4.1_amd64.deb</a><td><a class="reference external" href=/files/nginx-full_1.4.1_amd64.deb.asc>owG09ndUk1…</a><td><a class="reference external" href=/files/nginx-full_1.4.1_amd64.deb.md5>4776dc6c7f…</a><td><a class="reference external" href=/files/nginx-full_1.4.1_amd64.deb.sha1>0e4e124acc…</a><tr><td><a class="reference external" href=/files/nginx-doc_1.4.1_all.deb>nginx-doc_1 …</a></table></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content="autocompletion,bash,port forwarding" itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-03-12T18:00:00+00:00 itemprop=datePublished> 12 Mar 2013 </time> — < 1 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Bash portforwarding with autocompletion'" href=https://kura.gg/2013/03/12/bash-portforwarding-with-autocompletion/ itemprop=url rel=bookmark> Bash portforwarding with autocompletion </a></h2><section class=summary-content itemprop=articleBody><p>I spend a <span class=caps>LOT</span> of time with tunnels open to multiple machines, connecting directly to PostgreSQL, RabbitMQ and many other services all via <span class=caps>SSH</span>.<p>I have written several helper functions and this is the final version that I created in a small competition with <a class="reference external" href=https://twitter.com/codeinthehole>@codeinthehole.</a><p>Gist removed. Sorry.<div class=section id=installation><h2>Installation</h2><p>Simply add the contents to <em>~/.bashrc</em></div><div class=section id=usage><h2>Usage</h2><p>Usage is pretty simply, just called portforward from the command line, pressing <<span class=caps>TAB</span>> as you type in a server name from your ~/.ssh/config file and the same with the port.<div class=highlight><pre><span></span>portforward<span class=w> </span>sy&LTTAB>
</pre></div><p>Will become:<div class=highlight><pre><span></span>portforward<span class=w> </span>syslog.tv
</pre></div><p>And finally<div class=highlight><pre><span></span>portforward<span class=w> </span>syslog.tv<span class=w> </span><span class=m>15672</span>
</pre></div></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=denyhosts,unban itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2012-11-13T17:45:00+00:00 itemprop=datePublished> 13 Nov 2012 </time> — < 1 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Unbanning an IP, multiple IPs or a block of IPs from DenyHost'" href=https://kura.gg/2012/11/13/unbanning-an-ip-a-block-of-ips-or-a-block-of-ips-from-denyhost/ itemprop=url rel=bookmark> Unbanning an <span class=caps>IP</span>, multiple IPs or a block of IPs from DenyHost </a></h2><section class=summary-content itemprop=articleBody><p>I wrote this little Python program a while ago and now people are starting to email me about it, asking for it to be part of the DenyHosts Debian packages so I figured I’d write a quick article on it.<p>If you’re like my developers, you’ll find yourself getting banned from servers all the time and have to come speak to someone like me (your sys engineer/admin), or maybe you are an admin and are sick of people banning themselves and want and easy way to unban them.<p>So give this a try:<p><a class="reference external" href=https://github.com/kura/denyhosts-unban>https://github.com/kura/denyhosts-unban</a><p>From the GitHub page you can download either the tarballs, zipballs or a Debian .deb package. Install it using the instructions in the <span class=caps>README</span> and you’re good to go.<div class=section id=unban><h2>Unban</h2><p>Unbanning is simple, you can either unban a single <span class=caps>IP</span> using:<div class=highlight><pre><span></span>sudo<span class=w> </span>denyhosts-unban<span class=w> </span><span class=m>10</span>.0.0.1 …</pre></div></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2012-11-08T11:47:00+00:00 itemprop=datePublished> 08 Nov 2012 </time> — 1 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Java 6 on Ubuntu 12.04 (including Tomcat 6)'" href=https://kura.gg/2012/11/08/java-6-on-ubuntu-12-04-including-tomcat-6/ itemprop=url rel=bookmark> Java 6 on Ubuntu 12.04 (including Tomcat 6) </a></h2><section class=summary-content itemprop=articleBody><p>If like me you run in to issue when using OpenJDK, my issues come from it’s memory problems when you’re allocating and using large amounts of memory - mostly for Solr where we’re concerned but obviously I’d switch for other high memory usage instances too.<p>So without further ado, lets get the installation going.<p>You’ll need Debian’s “add-apt-repository”, on servers this doesn’t usually come by default so we’ll need to install it.<div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>python-software-properties
</pre></div><p>Next we need to add Java’s <span class=caps>PPA</span>.<div class=highlight><pre><span></span>sudo<span class=w> </span>add-apt-repository<span class=w> </span>ppa:sun-java-community-team/sun-java6
</pre></div><p>Once this is done we’ll need to update our apt caches and install Java 6.<div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>sun-java6-jdk
</pre></div><p>Now that this is installed we should get the Java version, remember it for future.<div class=highlight><pre><span></span>java<span class=w> </span>-version
</pre></div><p>You’ll get something like this<div class=highlight><pre><span></span>java<span class=w> </span>version<span class=w> </span><span class=s2>"1.6.0_20"</span><span class=w> </span>OpenJDK<span class=w> </span>Runtime<span class=w> </span>Environment<span class=w> </span><span class=o>(</span>IcedTea6<span class=w> </span><span class=m>1</span>.9 …</pre></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=/etc/shadow,mkpasswd,password,sha-512,sha512 itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2012-10-11T09:56:00+01:00 itemprop=datePublished> 11 Oct 2012 </time> — < 1 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'How to generate an /etc/shadow compatible password'" href=https://kura.gg/2012/10/11/how-to-generate-an-etcshadow-compatible-password/ itemprop=url rel=bookmark> How to generate an /etc/shadow compatible password </a></h2><section class=summary-content itemprop=articleBody><p>You’ll need mkpasswd, on Debian 6 and Ubuntu 12.04 you can install this using:<div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>whois
</pre></div><p>It is pretty weird that it comes with the whois package though…<p>And then run<div class=highlight><pre><span></span>mkpasswd<span class=w> </span>-m<span class=w> </span>sha-512
</pre></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=blackhole,blackhole.io,email,mail itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2012-06-26T23:05:00+01:00 itemprop=datePublished> 26 Jun 2012 </time> — 3 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Send all email to a blackhole (never gets delivered), test delivery speed and much more using blackhole.io'" href=https://kura.gg/2012/06/26/send-all-email-to-a-blackhole-never-gets-delivered-test-delivery-speed-and-much-more-using-blackhole-io/ itemprop=url rel=bookmark> Send all email to a blackhole (never gets delivered), test delivery speed and much more using blackhole.io </a></h2><section class=summary-content itemprop=articleBody><p>I have built and released an open-source email server in the past for testing send rates and speeds, this project was called SimpleMTA and is available <a class="reference external" href=https://syslog.tv/simplemta/>here</a>.<p>Recently I have rebuilt this project for an internal project at work using the <a class="reference external" href=https://www.tornadoweb.org/>Tornado framework</a>. Sadly this project as a whole cannot be released but a version of this code will be released in the near future.<p>Until that is released I have launched a new service called <a class="reference external" href=https://blackhole.io>blackhole.io</a><div class=section id=what-is-blackhole-io><h2>What is blackhole.io?</h2><p>blackhole.io is a completely open mail relay that forgets anything that is sent to it, meaning there is no auth requirements and no storage of email data within the service. Literally anyone can send anything to it and have it never get delivered.<p>You can even send commands out of order, meaning you can call the <span class=caps>DATA</span> command without ever using <span class=caps>HELO</span>, <span class=caps>MAIL</span> <span class=caps>FROM</span> or <span class=caps>RCPT</span> <span class=caps>TO …</span></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=aws,fstab,fuse,mount,s3,s3fs itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2012-03-03T16:05:00+00:00 itemprop=datePublished> 03 Mar 2012 </time> — 3 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Mount Amazon S3 bucket locally on Debian 5 & 6/Ubuntu 10.04'" href=https://kura.gg/2012/03/03/mount-amazon-s3-bucket-locally/ itemprop=url rel=bookmark> Mount Amazon S3 bucket locally on Debian 5 <span class=amp>&</span> 6/Ubuntu 10.04 </a></h2><section class=summary-content itemprop=articleBody><p>I’ve recently been toying with my <a class="reference external" href=https://rpi.syslog.tv/>Raspberry Pi mirror</a> including moving it out on to Amazon’s S3. I’ve written an article on <a class="reference external" href=https://syslog.tv/2012/02/29/backup-a-linux-server-to-amazon-s3-on-debian-6ubuntu-10-04/>how to back up to S3</a>, but that isn’t enough when it comes to serving data from S3.<p>I needed the ability to <span class=caps>RSYNC</span> data from the official Raspberry Pi servers on to mine and then in to S3 and for that I used <a class="reference external" href=https://code.google.com/p/s3fs/>s3fs</a> and <a class="reference external" href=https://fuse.sourceforge.net/><span class=caps>FUSE</span></a>.<div class=section id=fuse-1><h2><span class=caps>FUSE</span></h2><p>You can actually do this successfully without requiring <span class=caps>FUSE</span>, just by installing the s3fs binary on to your system, but this only allows the user who mounted to access the mounted bucket and also is not possible via /etc/fstab.<p><span class=caps>FUSE</span> allows you to implement a filesystem within a userspace program, thus allowing us to give other users access and auto-mount using /etc/fstab.</div><div class=section id=installation><h2>Installation</h2><div class=section id=fuse-2><h3>Fuse</h3><p>Installing <span class=caps>FUSE</span> is simple<div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>fuse-utils
</pre></div></div><div class=section id=s3fs-1><h3>s3fs</h3><p>We …</div></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=bruteforce,ssh itemprop=keywords><meta content=misc itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2012-03-02T18:36:00+00:00 itemprop=datePublished> 02 Mar 2012 </time> — < 1 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Visualised: 24 hours of SSH attacks against a single server'" href=https://kura.gg/2012/03/02/visualised-24-hours-of-ssh-attacks-against-a-single-server/ itemprop=url rel=bookmark> Visualised: 24 hours of <span class=caps>SSH</span> attacks against a single server </a></h2><section class=summary-content itemprop=articleBody><p>24 hours of <span class=caps>SSH</span> attacks against a single server, visualised on a world map using Python.<p>When a country stays lit up for more than 1 tick of the clock in the left hand corner it means that multiple attacks are happening from different <span class=caps>IP</span> addresses. An attacker is banned after;<ul class=simple><li>1 failed root login,<li>3 failed user logins (including invalid users) and<li>3 failed system logins.</ul><div align=center class=vimeo><iframe allowfullscreen frameborder=0 height=500 mozallowfullscreen src=https://player.vimeo.com/video/37818131 webkitallowfullscreen width=800></iframe></div><div class=section id=direct-links><h2>Direct links</h2><ul class=simple><li><a class="reference external" href=https://vimeo.com/37818131>Vimeo</a><li><a class="reference external" href=https://www.youtube.com/watch?v=S_p0G2oLuDU>YouTube</a> - older version of the video with yellow colouring instead of red.</ul></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=amazon,aws,backup,debian,s3,ubuntu itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2012-02-29T20:55:00+00:00 itemprop=datePublished> 29 Feb 2012 </time> — 2 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Backup a Linux server to Amazon S3 on Debian 6/Ubuntu 10.04'" href=https://kura.gg/2012/02/29/backup-a-linux-server-to-amazon-s3-on-debian-6ubuntu-10-04/ itemprop=url rel=bookmark> Backup a Linux server to Amazon S3 on Debian 6/Ubuntu 10.04 </a></h2><section class=summary-content itemprop=articleBody><p>I have several servers powering syslog including it’s <a class="reference external" href=https://rpi.syslog.tv/>Raspberry Pi</a> mirror, load balancer and email servers. All of my servers are hosted using <a class="reference external" href=https://www.linode.com/?r=8d58820f89940a1a68832c0cdd53109727cfa622>Linode</a> in their London data centre and have Linode’s back-up system doing both daily and weekly snapshots.<p>For the app and database servers I do server-side backups storing each website and it’s database in it’s own folder within /backup in case I require a quick back-up to fix something, rather than the server has died.<p>This is all well and good but I like having an off-site backup too and for that I use <a class="reference external" href=https://aws.amazon.com/s3/>S3</a>…<div class=section id=about-s3><h2>About S3</h2><p>Amazon’s S3 is pretty cheap and very easy to use. Because only data is going in you don’t pay a transfer fee and the cost of storage is very affordable, you can see a <a class="reference external" href=https://aws.amazon.com/s3/#pricing>pricing list here</a>.<p>To do the backup I use a …</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content="automatic update,debian,unattended-upgrades,update" itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2012-01-28T17:41:00+00:00 itemprop=datePublished> 28 Jan 2012 </time> — 2 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Automatic/Unattended updates on Debian 6 (Squeeze)'" href=https://kura.gg/2012/01/28/automaticunattended-updates-on-debian-6-squeeze/ itemprop=url rel=bookmark> Automatic/Unattended updates on Debian 6 (Squeeze) </a></h2><section class=summary-content itemprop=articleBody><p>The unattended-upgrades package used on Debian is based on the one from Ubuntu. It is generally pretty safe in my opinion but I only ever enable it for security upgrades.<div class=section id=installation><h2>Installation</h2><div class=highlight><pre><span></span>apt-get<span class=w> </span>install<span class=w> </span>unattended-upgrades<span class=w> </span>apticron
</pre></div><p><em>unattended-upgrades</em> handles the actual updates, <em>apticron</em> is used for emailing you of available updates - it is not required but I like it.</div><div class=section id=configuring-unattended-upgrades><h2>Configuring unattended-upgrades</h2><p>Open up <strong>/etc/apt/apt.conf.d/50unattended-upgrades</strong> and change it to the content below.<pre class=literal-block>
APT::Periodic::Enable "1";
APT::Periodic::Update-Package-Lists "1";
APT::Periodic::AutocleanInterval "7";
APT::Periodic::Unattended-Upgrade "1";
Unattended-Upgrade::Mail "**YOUR_EMAIL_HERE**";

// Automatically upgrade packages from these (origin, archive) pairs
Unattended-Upgrade::Allowed-Origins {
    "${distro_id} stable";
    "${distro_id} ${distro_codename}-security";
};

// Automatically reboot *WITHOUT CONFIRMATION* if a
 // the file /var/run/reboot-required is found after the upgrade
 Unattended-Upgrade::Automatic-Reboot "false";
</pre><p>So lets explain the above. As you can see we enable periodic updates, enable update package lists (triggers an apt-get update), enable autoclean …</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=debian,keyserver,pgp,sks,ubuntu itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-12-17T15:58:00+00:00 itemprop=datePublished> 17 Dec 2011 </time> — < 1 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Running your own PGP keyserver with SKS on Debian 6/Ubuntu 10.04'" href=https://kura.gg/2011/12/17/running-your-own-pgp-keyserver-with-sks-on-debian-6ubuntu-10-04/ itemprop=url rel=bookmark> Running your own <span class=caps>PGP</span> keyserver with <span class=caps>SKS</span> on Debian 6/Ubuntu 10.04 </a></h2><section class=summary-content itemprop=articleBody><div class=section id=installation><h2>Installation</h2><p>To install we need to run the following command:<div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>sks
</pre></div><p>Now we build the key database:<div class=highlight><pre><span></span>sudo<span class=w> </span>sks<span class=w> </span>build
</pre></div><p>And change the permissions for the sks user:<div class=highlight><pre><span></span>sudo<span class=w> </span>chown<span class=w> </span>-R<span class=w> </span>debian-sks:debian-sks<span class=w> </span>/var/lib/sks/DB
</pre></div><p>Next we need to make sks start from init, open up <strong>/etc/default/sks</strong> in your favourite editor and <strong>*initstart*</strong> to look like below:<div class=highlight><pre><span></span><span class=nv>initstart</span><span class=o>=</span>yes
</pre></div><p>Now we can start the service with:<div class=highlight><pre><span></span>sudo<span class=w> </span>/etc/init.d/sks<span class=w> </span>start
</pre></div><p>Your keyserver will now be up and running on port 11371.</div><div class=section id=web-interface><h2>Web interface</h2><p>We’ll need to create a web folder within sks with the following command:<div class=highlight><pre><span></span>sudo<span class=w> </span>mkdir<span class=w> </span>-p<span class=w> </span>/var/lib/sks/www/
</pre></div><p>Change it’s permissions so the sks user can access it.<div class=highlight><pre><span></span>sudo<span class=w> </span>chown<span class=w> </span>-R<span class=w> </span>debian-sks:debian-sks<span class=w> </span>/var/lib/sks/www
</pre></div><p>And finally we need create a single <span class=caps>HTML</span> file for the interface, I have provided that …</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=debian,git,gitosis,gitweb,ubuntu itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-12-17T15:40:00+00:00 itemprop=datePublished> 17 Dec 2011 </time> — 4 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Host git repositories with git, gitosis and gitweb on Debian 6/Ubuntu 10.04'" href=https://kura.gg/2011/12/17/host-git-repositories-with-git-gitosis-and-gitweb-on-debian-6ubuntu-10-04/ itemprop=url rel=bookmark> Host git repositories with git, gitosis and gitweb on Debian 6/Ubuntu 10.04 </a></h2><section class=summary-content itemprop=articleBody><div class=section id=installation><h2>Installation</h2><p>First up we’ll need to install git and some Python tools to get Gitosis installed.<div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>-y<span class=w> </span>git-core<span class=w> </span>gitweb<span class=w> </span>python-setuptools
</pre></div><p>Next we have to clone gitosis from it’s git repository and install it.<div class=highlight><pre><span></span><span class=nb>cd</span><span class=w> </span>/tmp
git<span class=w> </span>clone<span class=w> </span>git://eagain.net/gitosis.git
<span class=nb>cd</span><span class=w> </span>gitosis
sudo<span class=w> </span>python<span class=w> </span>setup.py<span class=w> </span>install
</pre></div></div><div class=section id=adding-your-git-user><h2>Adding your git user</h2><div class=highlight><pre><span></span>sudo<span class=w> </span>adduser<span class=w> </span>--system<span class=w> </span>--shell<span class=w> </span>/bin/sh<span class=w> </span>--gecos<span class=w> </span><span class=s1>'git version control'</span><span class=w> </span>--group<span class=w> </span>--disabled-password<span class=w> </span>--home<span class=w> </span>/home/git<span class=w> </span>git
</pre></div><p>The above command creates a new system user with <strong>/bin/sh</strong> as it’s shell with <strong>no password</strong> and a homedir of <strong>/home/git/</strong> and also creates a group with the same name.</div><div class=section id=initialising-gitosis><h2>Initialising gitosis</h2><p>You’ll need an <span class=caps>SSH</span> key for this, if you have one simply copy the contents of it to your new git server, if you do not have one then you can generate one on your machine using<div class=highlight><pre><span></span>ssh-keygen
</pre></div><p>And then …</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content="kernel panic,oom,reboot" itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-10-25T10:26:00+01:00 itemprop=datePublished> 25 Oct 2011 </time> — 1 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Rebooting on OOM'" href=https://kura.gg/2011/10/25/rebooting-on-oom/ itemprop=url rel=bookmark> Rebooting on <span class=caps>OOM</span> </a></h2><section class=summary-content itemprop=articleBody><p><strong>*I would generally not advise using this unless you have skill at debugging why <span class=caps>OOM</span> has spawned and also debugging kernel panics after they happen, from logs.*</strong><p>It is possible to configure your kernel to panic when <span class=caps>OOM</span> is spawned, which in itself is not useful but, coupled with a kernel option for auto-rebooting a system when the kernel panics it can be a very useful tool.<p>Think before implementing this and use at your own risk, I take zero responsibility for you using this.<div class=highlight><pre><span></span>sudo<span class=w> </span>sysctl<span class=w> </span>vm.panic_on_oom<span class=o>=</span><span class=m>1</span>
sudo<span class=w> </span>sysctl<span class=w> </span>kernel.panic<span class=o>=</span>X<span class=w> </span><span class=c1># X is the amount of seconds to wait before rebooting</span>
</pre></div><p><strong>*<span class=caps>DO</span> <span class=caps>NOT</span> <span class=caps>FORGET</span> <span class=caps>TO</span> <span class=caps>CHANGE</span> X*</strong><p>This will inject the changes in to a system that is currently running but will be forgotten on reboot so use the lines below to save permanently.<div class=highlight><pre><span></span>sudo<span class=w> </span><span class=nb>echo</span><span class=w> </span><span class=s2>"vm.panic_on_oom=1"</span><span class=w> </span>>><span class=w> </span>/etc/sysctl.conf
sudo<span class=w> </span><span class=nb>echo</span><span class=w> </span><span class=s2>"kernel.panic …</span></pre></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content="mk livestatus,nagios,nagios 3,nagios broker,xinetd" itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-10-13T23:17:00+01:00 itemprop=datePublished> 13 Oct 2011 </time> — 2 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Nagios3 + MK Livestatus + xinetd on Debian 6/Ubuntu'" href=https://kura.gg/2011/10/13/nagios3-mk-livestatus-xinetd/ itemprop=url rel=bookmark> Nagios3 + <span class=caps>MK</span> Livestatus + xinetd on Debian 6/Ubuntu </a></h2><section class=summary-content itemprop=articleBody><div class=section id=preparation><h2>Preparation</h2><p>First we need to make sure we have all the stuff we need to compile mk livestatus and run it<div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>make<span class=w> </span>build-essential<span class=w> </span>xinetd<span class=w> </span>ucspi-unix
</pre></div></div><div class=section id=mk-livestatus><h2><span class=caps>MK</span> Livestatus</h2><p>Grab the mk livestatus source from <a class="reference external" href=https://mathias-kettner.de/check_mk_download.html>here</a>, currently it’s version 1.1.10p3 but update the commands below to match your version.<div class=highlight><pre><span></span>wget<span class=w> </span>https://mathias-kettner.de/download/mk-livestatus-1.1.10p3.tar.gz
tar<span class=w> </span>xvzf<span class=w> </span>mk-livestatus-1.1.10p3.tar.gz
<span class=nb>cd</span><span class=w> </span>mk-livestatus-1.1.10p3
./configure
make
sudo<span class=w> </span>make<span class=w> </span>install
</pre></div></div><div class=section id=xinetd><h2>Xinetd</h2><p>Now that it’s compiled we need to write a xinetd config for it, create a new file called <strong>/etc/xinetd.d/livestatus</strong> and put the following in it<pre class=literal-block>
service livestatus {
    type = UNLISTED
    port = 6557
    socket_type = stream
    protocol = tcp
    wait = no
    cps = 100 3
    instances = 500
    per_source = 250
    flags = NODELAY
    user = nagios
    server = /usr/bin/unixcat
    server_args = /var/lib/nagios3/rw/live
    only_from = 127.0.0.1 # modify this to …</pre></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=apache2,nginx,wordpress,wp-super-cache itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-09-30T23:21:00+01:00 itemprop=datePublished> 30 Sep 2011 </time> — 2 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'nginx config for reverse proxying Wordpress & WP Super Cache and keeping the load off Apache2'" href=https://kura.gg/2011/09/30/nginx-config-for-reverse-proxying-wordpress-wp-super-cache-and-keeping-the-load-off-apache2/ itemprop=url rel=bookmark> nginx config for reverse proxying Wordpress <span class=amp>&</span> <span class=caps>WP</span> Super Cache and keeping the load off Apache2 </a></h2><section class=summary-content itemprop=articleBody><div class=section id=the-point><h2>The point</h2><p>The whole point of this is to get as much load off of Apache as possible to keep the server running nice and smoothly.</div><div class=section id=configuration><h2>Configuration</h2><p>The configuration below will mean that nginx will serve basically everything;<ul class=simple><li>static files<li>uploaded files and<li>cached content</ul><p>simply replace the <strong><span class=caps>VARIABLES</span></strong> below and everything should be good to go, if copy-pasting from below isn’t working properly you can download a full copy from <a class="reference external" href=/files/2011/09/server.txt>here</a>.<div class=highlight><pre><span></span><span class=k>server</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kn>listen</span><span class=w> </span><span class=mi>80</span><span class=p>;</span>
<span class=w>  </span><span class=kn>server_name</span><span class=w> </span><span class=s>**DOMAIN_HERE**</span><span class=p>;</span>
<span class=w>  </span><span class=kn>access_log</span><span class=w> </span><span class=s>/var/log/nginx/access.**DOMAIN_HERE**.log</span><span class=p>;</span>

<span class=w>  </span><span class=kn>gzip</span><span class=w> </span><span class=no>on</span><span class=p>;</span>
<span class=w>  </span><span class=kn>gzip_disable</span><span class=w> </span><span class=s>msie6</span><span class=p>;</span><span class=w> </span><span class=c1># disable gzip for IE6</span>
<span class=w>  </span><span class=kn>gzip_static</span><span class=w> </span><span class=no>on</span><span class=p>;</span>
<span class=w>  </span><span class=kn>gzip_comp_level</span><span class=w> </span><span class=mi>9</span><span class=p>;</span><span class=w> </span><span class=c1># highest level of compression</span>
<span class=w>  </span><span class=kn>gzip_proxied</span><span class=w> </span><span class=s>any</span><span class=p>;</span>
<span class=w>  </span><span class=kn>gzip_types</span><span class=w> </span><span class=s>text/plain</span><span class=w> </span><span class=s>text/css</span><span class=w> </span><span class=s>application/x-javascript</span><span class=w> </span><span class=s>text/xml</span><span class=w> </span><span class=s>application/xml</span><span class=w> </span><span class=s>application/xml+rss</span><span class=w> </span><span class=s>text/javascript</span><span class=p>;</span>

<span class=w>  </span><span class=kn>proxy_redirect</span><span class=w> </span><span class=no>off</span><span class=p>;</span>
<span class=w>  </span><span class=kn>proxy_set_header</span><span class=w> </span><span class=s>Host</span><span class=w> </span><span class=nv>$host</span><span class=p>;</span>
<span class=w>  </span><span class=kn>proxy_set_header</span><span class=w> </span><span class=s>X-Real-IP</span><span class=w> </span><span class=nv>$remote_addr</span><span class=p>;</span>
<span class=w>  </span><span class=kn>proxy_set_header</span><span class=w> </span><span class=s>X-Forwarded-For</span><span class=w> </span><span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
<span class=w>  </span><span class=kn>proxy_pass_header</span><span class=w> </span><span class=s>Set-Cookie</span><span class=p>;</span><span class=kn>root</span><span class=w> </span><span class=s>**/PATH/TO/WORDPRESS**</span><span class=p>;</span>

<span class=w>  </span><span class=c1># default location, used for the basic proxying</span>
<span class=w>  </span><span class=kn>location</span><span class=w> </span><span class=s>/</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1># if we're requesting a file and …</span></pre></div></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content="http,https,load,load balancing,pound,ssl,ssl offloading,ssl termination" itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-09-29T23:15:00+01:00 itemprop=datePublished> 29 Sep 2011 </time> — 2 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Load balancing HTTP/HTTPS with Pound on Debian 6/Ubuntu'" href=https://kura.gg/2011/09/29/load-balancing-httphttps-with-pound-on-debian-6ubuntu/ itemprop=url rel=bookmark> Load balancing <span class=caps>HTTP</span>/<span class=caps>HTTPS</span> with Pound on Debian 6/Ubuntu </a></h2><section class=summary-content itemprop=articleBody><p>Pound is a great little load balancer, it’s fast, opensource and supports <span class=caps>SSL</span> termination, which is great!<div class=section id=install><h2>Install</h2><div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>pound
</pre></div></div><div class=section id=configuration><h2>Configuration</h2><p>The default configuration should be pretty good for most purposes, but feel free to tweak as you require.<div class=section id=http><h3><span class=caps>HTTP</span></h3><p>We’ll first look at load balancing <span class=caps>HTTP</span>, in case you don’t want or need <span class=caps>HTTPS</span> load balancing.<p>We’ll need delete all the content within <em>ListenHTTP</em> block, once done it should look like this<pre class=literal-block>
ListenHTTP
End
</pre><p>Now we add an address and port to listen on and finally a line to remove an <span class=caps>HTTP</span> header<pre class=literal-block>
ListenHTTP
    Address 0.0.0.0 # all interfaces
    Port 80
    HeadRemove "X-Forwarded-For"
End
</pre><p>This is a basic configuration, for each backend we want to load balance we’ll need to add a service within that listener.<p>You’ll notice we’re removing incoming headers called <em>X-Forwarded-For</em>, this is to make …</div></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=debian,email,greylist,mail,postfix,postgrey,spam,ubuntu itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-09-24T21:29:00+01:00 itemprop=datePublished> 24 Sep 2011 </time> — 2 min read</div><h2 class=article-title itemprop=name><a title="Permalink to 'Postfix spam protection with greylisting using Postgrey on Debian 6/Ubuntu'" href=https://kura.gg/2011/09/24/postfix-spam-protection-with-greylisting-using-postgrey-on-debian-6ubuntu/ itemprop=url rel=bookmark> Postfix spam protection with greylisting using Postgrey on Debian 6/Ubuntu </a></h2><section class=summary-content itemprop=articleBody><p>A simple yet effective method for protecting your mail server from spam is to use greylisting. In simple terms, when an email is received the server will temporarily reject it with a 450 response code claiming that the server is busy, the sending server should then attempt to try to deliver at a later point in time, if enough time has passed the recipient server will then accept the incoming mail and whitelist the send address for a period of time.<p>This is effective because most spam servers are configured not to retry the send whereas real mail servers generally will retry. This sadly does not protect against spam coming from comprised mail servers or accounts like on Hotmail.com.<div class=section id=installation><h2>Installation</h2><div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>postgrey
</pre></div></div><div class=section id=configuring-postgrey><h2>Configuring Postgrey</h2><p>By default Postgrey runs on <em>127.0.0.1:60000</em>, which is the local loopback interface so it is not exposed to the …</div></section></article><div class=eevee-page-spacer role=presentation></div></div></div></main><div class="eevee-pagination__container eevee-container mdl-grid"><div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone" role=presentation></div><div class="mdl-color-text--grey-800 mdl-cell mdl-cell--8-col"><nav class="eevee-pagination mdl-cell mdl-cell--12-col" aria-label=Pagination itemscope itemtype=http://schema.org/SiteNavigationElement><a class=eevee-nav__button href=https://kura.gg/authors/kura/page/2/ itemprop=url rel=bookmark title=Newer> <button class="mdl-button mdl-button--icon mdl-color--white mdl-color-text--grey-900" role=presentation><i class=material-icons></i></button> Newer </a><div class=eevee-spacer></div><a class=eevee-nav__button href=https://kura.gg/authors/kura/page/4/ itemprop=url rel=bookmark title=Older> Older <button class="mdl-button mdl-button--icon mdl-color--white mdl-color-text--grey-900" role=presentation><i class=material-icons></i></button> </a></nav></div></div><footer class=mdl-mega-footer itemscope itemtype=http://schema.org/SiteNavigationElement><div class=mdl-mega-footer--top-section><div class=mdl-mega-footer--drop-down-section><ul class=mdl-mega-footer--link-list><li><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></ul></div></div><div aria-label="Footer navigation" class=mdl-mega-footer--middle-section itemscope itemtype=http://schema.org/SiteNavigationElement><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Menu</h1><ul class=mdl-mega-footer--link-list><li><a href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons></i> Contact </a><li><a href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons></i> Archives </a><li><a href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons></i> RSS </a><li><a href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons></i> Atom </a></ul></div><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Social</h1><ul class=mdl-mega-footer--link-list><li><a href=https://github.com/kura itemprop=url rel=bookmark title=GitHub> <i aria-hidden=true class=fa></i> Github </a><li><a href=https://noc.social/@kura itemprop=url rel=me title=@kura@noc.social> <i aria-hidden=true class=fa>🦣</i> @kura@noc.social </a></ul></div><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Links</h1><ul class=mdl-mega-footer--link-list><li><a href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons></i> Blackhole </a><li><a href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons></i> Eevee </a><li><a href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons></i> Hauntr </a><li><a href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons></i> Ghastly </a><li><a title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons></i> Pelican Plugins </a></ul></div></div><div class=mdl-mega-footer--bottom-section><div class=mdl-logo><a href=https://kura.gg itemprop=url rel=bookmark title=kura.gg> kura.gg </a></div><ul class="eevee-footer mdl-mega-footer--link-list"><li>Powered by love & rainbow sparkles.<li>Source code and content released under the <a title="MIT license" href=/license/>MIT license</a>.</ul></div></footer></div>