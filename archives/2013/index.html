<!doctype html><html lang=en><meta charset=utf-8><meta content=width=device-width,initial-scale=1.0,minimum-scale=1.0 name=viewport><link href=https://kura.gg hreflang=en rel=alternate><link href=https://kura.gg rel=dns-prefetch><link href=https://kura.gg/theme/css/eevee.min.css?1c9d8344 rel=stylesheet><script async src=https://kura.gg/theme/js/eevee.min.js?1841d254></script><link href=https://kura.gg/feeds/rss.xml rel=alternate title=kura.gg type=application/rss+xml><link href=https://kura.gg/feeds/atom.xml rel=alternate title=kura.gg type=application/atom+xml><meta content=kura.gg property=og:site_name><meta content=article property=og:type><meta content=kura.gg property=og:title><meta content=https://kura.gg/archives/2013/index.html property=og:url><meta content=https://kura.gg/archives/2013/index.png property=og:image><meta content=1920 property=og:image:width><meta content=1080 property=og:image:height><meta content=kura.gg property=twitter:title><meta content=https://kura.gg/archives/2013/index.html property=twitter:url><meta content=https://kura.gg/archives/2013/index.png property=twitter:image><meta content=summary_large_image property=twitter:card><meta content=1920 property=twitter:image:width><meta content=1080 property=twitter:image:height><link sizes="16x16 32x32 48x48 64x64 128x128 256x256" href=/favicon.png rel=icon type=image/png><link sizes="16x16 32x32 48x48 64x64 128x128 256x256" href=/favicon.ico rel=icon type=image/vnd.microsoft.icon><title>Archives for 2013</title><body><div class="eevee-layout mdl-layout mdl-js-layout mdl-color--grey-50"><header class="eevee-header mdl-color--grey-50 mdl-color-text--grey-800" itemscope itemtype=http://schema.org/WPHeader><div class=mdl-layout__header-row><div class="mdl-layout__drawer-button mdl-color-text--accent eevee-mobile-button mdl-layout--small-screen-only" aria-expanded=false role=button tabindex=0><i class=material-icons></i></div><span class="eevee-logo mdl-color-text--accent mdl-layout-title"> <h2 id=top><a href=https://kura.gg rel=bookmark title=kura.gg> kura.gg </a></h2> </span><div class=mdl-layout-spacer role=presentation></div><nav aria-label="Header navigation" class="eevee-nav mdl-navigation mdl-layout--large-screen-only" itemscope itemtype=http://schema.org/SiteNavigationElement><a class="mdl-color-text--accent mdl-navigation__link" href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons></i> Blackhole </a><a class="mdl-color-text--accent mdl-navigation__link" href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons></i> Eevee </a><a class="mdl-color-text--accent mdl-navigation__link" href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons></i> Hauntr </a><a class="mdl-color-text--accent mdl-navigation__link" href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons></i> Ghastly </a><a class="mdl-color-text--accent mdl-navigation__link" title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons></i> Pelican Plugins </a><a class="mdl-color-text--accent mdl-navigation__link" href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons></i> Contact </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons></i> Archives </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons></i> RSS </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons></i> Atom </a></nav></div></header><div class="eevee-mobile-header mdl-layout__drawer mdl-color--white" aria-hidden=true><span class=mdl-layout-title> <h2 class="eevee-mobile-logo mdl-color-text--accent">kura.gg</h2> </span><div class="mdl-navigation mdl-color--white"><nav aria-label="Header navigation" class="eevee-nav mdl-navigation" itemscope itemtype=http://schema.org/SiteNavigationElement><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons>  </i> Home </a><a class="mdl-color-text--accent mdl-navigation__link" href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons></i> Blackhole </a><a class="mdl-color-text--accent mdl-navigation__link" href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons></i> Eevee </a><a class="mdl-color-text--accent mdl-navigation__link" href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons></i> Hauntr </a><a class="mdl-color-text--accent mdl-navigation__link" href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons></i> Ghastly </a><a class="mdl-color-text--accent mdl-navigation__link" title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons></i> Pelican Plugins </a><a class="mdl-color-text--accent mdl-navigation__link" href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons></i> Contact </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons></i> Archives </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons></i> RSS </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons></i> Atom </a></nav></div></div><div class="eevee-ribbon mdl-color--primary-dark" role=presentation></div><main class="eevee-main mdl-layout__content"><div class="eevee-container mdl-grid"><div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone" role=presentation></div><div aria-label="Main content" class="eevee-content mdl-color--white mdl-shadow--2dp mdl-color-text--grey-800 mdl-cell mdl-cell--8-col"><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=python,pypi,shields itemprop=keywords><meta content=coding itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-12-24T14:07:00+00:00 itemprop=datePublished> 24 Dec 2013 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Shields for PyPI packages'" href=https://kura.gg/2013/12/24/shields-for-pypi-packages/ itemprop=url rel=bookmark> Shields for PyPI packages </a></h2><section class=summary-content itemprop=articleBody><p>Some time back in April 2013 I was bored and looking for a new project to keep my attention, if only for a short period of time.<p>My colleague <a class="reference external" href=https://twitter.com/codeinthehole>@codeinthehole</a> had an idea but no time to implement it, this idea was to have shields like those of <a class="reference external" href=https://travis-ci.org>travis-ci</a> (shown below) but displaying package download counts.</p><img alt="Status of blackhole on Travis CI" src=https://api.travis-ci.org/kura/blackhole.png?branch=master><div class=section id=tech-stack><h2>Tech stack</h2><p>From the very start I decided to use <a class="reference external" href=https://www.tornadoweb.org/en/stable/>Tornado framework</a>, although this may change in the future.<p>The original plan was to generate the images using Pillow (<span class=caps>PIL</span>) and then simply cache them to disk. I decided it would make far more sense to do this using <a class="reference external" href=https://www.varnish-cache.org/>Varnish</a> and not have to worry about it working as expected.</div><div class=section id=manually-generating-the-images><h2>Manually generating the images</h2><p>The images were originally generated from a base template using Pillow, but sadly Python’s image manipulation is not very good, especially it’s text manipulation and the shields could …</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content="google analytics,duckduckgo,open web analytics,owa" itemprop=keywords><meta content=misc itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-09-17T18:00:00+01:00 itemprop=datePublished> 17 Sep 2013 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Bye bye Google Analytics, hello self-hosted Open Web Analytics & DuckDuckGo search'" href=https://kura.gg/2013/09/17/bye-bye-google-analytics-hello-self-hosted-open-web-analytics-duckduckgo-search/ itemprop=url rel=bookmark> Bye bye Google Analytics, hello self-hosted Open Web Analytics <span class=amp>&</span> DuckDuckGo search </a></h2><section class=summary-content itemprop=articleBody><p>Today I can happily announce that <a class="reference external" href=https://github.com/kura/kura.gg/commit/5e82c14bab3922d81b430549dd258a2047d1367f>the Google Analytics tracking code has been removed from this website</a>.<div class=section id=goodybye-google-analytics-hello-open-web-analytics><h2>Goodybye Google Analytics <span class=amp>&</span> hello Open Web Analytics</h2><p>I’ve been planning on doing it from a while because I do not like Google Analytics, I don’t like being tracked and I actively stopped trying to use Google services for my own reasons.<p>The company I work for uses <a class="reference external" href=https://piwik.org/>Piwik</a> for some of our clients, I am not a fan of Piwik or how it works and does things. I did some research and found some service providers but their free options were limited or I felt they weren’t a good fit, eventually I stumbled upon <a class="reference external" href=https://www.openwebanalytics.com>Open Web Analytics</a> and decided that it not only suited my purposes, but it meant servers I control would hold the analytical data, rather than some third party.</div><div class=section id=hello-duckduckgo><h2>Hello DuckDuckGo</h2><p>After launching the new version of …</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=bash,dash,ps1,git itemprop=keywords><meta content=coding itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-08-18T17:25:00+01:00 itemprop=datePublished> 18 Aug 2013 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'My $PS1 with git branch, new files, staged files and commit status'" href=https://kura.gg/2013/08/18/my-ps1-with-git-branch-new-files-staged-files-and-commit-status/ itemprop=url rel=bookmark> My $<span class=caps>PS1</span> with git branch, new files, staged files and commit status </a></h2><section class=summary-content itemprop=articleBody><p>I love my prompt, always have and always will. I spend so much of my life in a terminal, usually with half a dozen mini terminals open in each tab. As such I like to tweak it and get it as perfect as possible for my life, needs and even mood.<p>In the past I’ve had quite a large <span class=caps>PS1</span> that covers multiple lines and gives a lot of information, after having that <span class=caps>PS1</span> in one form or another for some time I decided it was time for a change, to a smaller <span class=caps>PS1</span> that takes up a lot less space.<p>So here it is, the first image is my standard <span class=caps>PS1</span> when in a git repository, the red @ means a file hasn’t been added to Git, a blue @ means a tracked file has been modified but not stage and finally a green @ means a file is staged …</section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=python,blackhole,setup.py,entry_points,mock,tests,testing itemprop=keywords><meta content=coding itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-08-18T12:00:00+01:00 itemprop=datePublished> 18 Aug 2013 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Blackhole 1.8.0 development, Mock and Python entry_points'" href=https://kura.gg/2013/08/18/blackhole-1.8.0-development-mock-and-python-entry-points/ itemprop=url rel=bookmark> Blackhole 1.8.0 development, Mock and Python entry_points </a></h2><section class=summary-content itemprop=articleBody><p>Over the last week I’ve been doing a huge amount of refactoring of <a class="reference external" href=https://blackhole.io>Blackhole</a> as well as writing dozens of additional tests. To make Blackhole more testable I needed to make a big change to how the program is launched and controlled.<div class=section id=setup-py-scripts-vs-entry-points><h2>setup.py scripts vs. entry_points</h2><p>Whenever I’ve written Python programs that require some kind of command line script I’ve always used distutils’ scripts, this can be seen <a class="reference external" href=https://github.com/kura/blackhole/blob/05c6647aeb25ecfcc17d9df535db330a68016a24/setup.py#L37-L39>in blackhole’s setup.py on GitHub</a> or in the three line example below.<div class=highlight><pre><span></span><span class=n>scripts</span><span class=o>=</span><span class=p>[</span>
    <span class=s1>'blackhole/bin/blackhole'</span><span class=p>,</span>
<span class=p>],</span>
</pre></div><p>In doing so, it allowed me to be lazy and write a lot of prodecural code in the main “binary” which made it pretty much impossible to test. You can also see that <a class="reference external" href=https://github.com/kura/blackhole/blob/bb6cccca3a75def324ed5cb64a32fd2e5773a038/blackhole/bin/blackhole>on GitHub in the main “binary”</a>.<p>I’ve noticed that most people who write Python packages that have some kind of command line entry point use distutils …</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=python,pelican,youtube,vimeo itemprop=keywords><meta content=coding itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-08-09T17:38:00+01:00 itemprop=datePublished> 09 Aug 2013 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Writing a Vimeo and YouTube plugin for Pelican'" href=https://kura.gg/2013/08/09/writing-a-vimeo-and-youtube-plugin-for-pelican/ itemprop=url rel=bookmark> Writing a Vimeo and YouTube plugin for Pelican </a></h2><section class=summary-content itemprop=articleBody><p><a class="reference external" href=https://getpelican.com/>Pelican</a> is a Python-powered static blog generator that processes <a class="reference external" href=https://docutils.sourceforge.net/rst.html>ReStructuredText</a> and <a class="reference external" href=https://daringfireball.net/projects/markdown/>Markdown</a> articles and pages and converts them to <span class=caps>HTML</span>. I use Pelican to power this blog.<p>There is a YouTube <span class=caps>RST</span> directive built in to Pelican core but it really shouldn’t exist there.<p>I submitted a pull request for Pelican core to enable Vimeo videos in articles but that request was declined because it didn’t belong in the core. So I decided I would write it as a plugin instead and while I was doing it, also wrote a plugin for YouTube so that it could be removed from the core.<p><a class="reference external" href=https://docs.getpelican.com/en/3.2/plugins.html#how-to-create-plugins>There is a decent amount of detail in the Pelican documentation on how to write plugins</a>, I’m not going to cover the whole process but I thought I would cover a little of what I did.<div class=section id=adding-an-rst-directive><h2>Adding an <span class=caps>RST</span> directive</h2><p>Really all we’re doing …</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=python,tornado,iostream,ssl,starttls,blackhole itemprop=keywords><meta content=coding itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-07-31T13:36:00+01:00 itemprop=datePublished> 31 Jul 2013 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Writing the STARTTLS command in to Blackhole'" href=https://kura.gg/2013/07/31/writing-the-starttls-command-in-to-blackhole/ itemprop=url rel=bookmark> Writing the <span class=caps>STARTTLS</span> command in to Blackhole </a></h2><section class=summary-content itemprop=articleBody><p>Blackhole has always been able to handle unencrypted <span class=caps>SMTP</span> and for a long time it’s been able to handle encrypted <span class=caps>SMTP</span> via TLSv1.<p>One thing Blackhole hasn’t been able to do until the 1.7.0 release is handle <cite><span class=caps>STARTTLS</span></cite>.<p>In the past the <cite><span class=caps>STARTTLS</span></cite> command would cause Blackhole to return the standard <cite>250 <span class=caps>OK</span></cite> response but would continue to operate on unencrypted <span class=caps>SMTP</span>.<p>I wanted to fix this and do it properly, but this meant learning how to do so with Tornado, which itself proved to be tricky. I ended up deciding to go to my local coding spot - the pub and hash it out.<div class=section id=connection-stream><h2>connection_stream</h2><p>The first thing I had to do was refactor the code that created the instance of <cite>tornado.iostream.IOStream</cite> and <cite>tornado.iostream.SSLIOStream</cite> so that it didn’t actually do the ssl wrapping.<div class=highlight><pre><span></span><span class=k>def</span> <span class=nf>connection_stream</span><span class=p>(</span><span class=n>connection</span><span class=p>):</span>
<span class=w>    </span><span class=sd>"""</span>
<span class=sd>    Detect which socket the connection …</span></pre></div></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=python,tornado,iostream,ssl,blackhole itemprop=keywords><meta content=coding itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-07-29T20:00:00+01:00 itemprop=datePublished> 29 Jul 2013 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Wrapping a Tornado IOStream with SSL'" href=https://kura.gg/2013/07/29/wrapping-a-tornado-iostream-with-ssl/ itemprop=url rel=bookmark> Wrapping a Tornado IOStream with <span class=caps>SSL</span> </a></h2><section class=summary-content itemprop=articleBody><p>As part of my effort to make <a class="reference external" href=https://blackhole.io/>Blackhole</a> as useful and usable as possible, I needed to be able to support <span class=caps>SSL</span>/<span class=caps>TLS</span> enabled connections.<p>Tornado itself has two built-in IOStreams that help us do the job; the first is the standard <a class="reference external" href=https://www.tornadoweb.org/en/stable/iostream.html#tornado.iostream.IOStream>IOStream</a> and the second is the <a class="reference external" href=https://www.tornadoweb.org/en/stable/iostream.html#tornado.iostream.SSLIOStream>SSLIOStream</a>.<p>With this in mind we simply need to spawn two sockets, by default these listen on port 25 for standard <span class=caps>SMTP</span> and port 465 for <span class=caps>SSL</span>/<span class=caps>TLS</span> encrypted <span class=caps>SMTP</span>. With these two sockets bound we’re then very simply able to listen for incoming connections on either socket and use <cite>socket.socket.getsockname()</cite> to figure out if the connection is to the encrypted or unencrypted socket.<div class=section id=code><h2>Code</h2><div class=highlight><pre><span></span><span class=k>def</span> <span class=nf>connection_stream</span><span class=p>(</span><span class=n>connection</span><span class=p>):</span>
<span class=w>    </span><span class=sd>"""</span>
<span class=sd>    Detect which socket the connection is being made on,</span>
<span class=sd>    create and iostream for the connection, wrapping it</span>
<span class=sd>    in SSL if connected over the SSL socket.</span>

<span class=sd>    The parameter 'connection' is an instance …</span></pre></div></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=haproxy,stats itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-07-19T13:00:00+01:00 itemprop=datePublished> 19 Jul 2013 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'haproxy stats'" href=https://kura.gg/2013/07/19/haproxy-stats/ itemprop=url rel=bookmark> haproxy stats </a></h2><section class=summary-content itemprop=articleBody><p>I recently wrote an article on <a class="reference external" href=/2013/07/15/haproxy-nginx-and-spdy-with-ssl-termination-debian-7/>using haproxy, <span class=caps>SSL</span> and <span class=caps>SPDY</span> with nginx backend servers</a>.<p>This article is a little extra on top of that to explain how to enable statistics for haproxy so you can monitor the backend statuses etc.<div class=section id=example-stats-page><h2>Example stats page</h2><img alt="Moar stats!" src=/images/haproxy-stats.png></div><div class=section id=enabling-stats><h2>Enabling stats</h2><pre class=literal-block>
listen stats :8000
    mode http
    stats enable
    stats hide-version
    stats realm haproxy\ stats
    stats uri /
    stats auth admin:admin
</pre><p>Place the above content in the haproxy configuration file (<em>/etc/haproxy/haproxy.cfg</em>).<p>Be sure to replace <em>admin:admin</em> with your a proper username and password, username first, password after the colon.<p>Restart haproxy, and then browse to <a class="reference external" href=https://yoursite.com:8000>https://yousite.com:8000</a>.</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=python,pypy,blackhole,blackhole.io,mta,email,honeypot itemprop=keywords><meta content=talks itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-07-17T21:00:00+01:00 itemprop=datePublished> 17 Jul 2013 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'DJUGL June 2013 talk on blackhole and blackhole.io'" href=https://kura.gg/2013/07/17/djugl-june-2013-talk-on-blackhole-and-blackhole-io/ itemprop=url rel=bookmark> <span class=caps>DJUGL</span> June 2013 talk on blackhole and blackhole.io </a></h2><section class=summary-content itemprop=articleBody><p>I have been a frequent audience member of <a class="reference external" href=https://www.djugl.org/item/443153><span class=caps>DJUGL</span></a> for a few years now and spend most of the time asking questions, playing devils advocate and generally being my annoying self.<p>I have repeatedly said I would do a talk but never got round to it until <a class="reference external" href=https://twitter.com/JonWebJobs>Jon</a> basically forced me to get round to it.<p>My talk was on <a class="reference external" href=https://blackhole.io>blackhole/blackhole.io</a> and covered several topics including <a class="reference external" href=https://pypy.org>PyPy</a>, <a class="reference external" href=/simplemta/>SimpleMTA</a> and moved on to talking about spamming and starting work on my honey pot suite called <a class="reference external" href=https://nectar.blackhole.io>Nectar</a>.<p>You can find the slides on <a class="reference external" href=https://speakerdeck.com/kura/djugl-june-2013>Speaker Deck</a>, sadly I ran out of time when creating them and although I was promised time to finish them at work, I got busy. So I replaced content with “Taylor Replacements(tm)”.<p>The event, attendees and other speakers are listen on the <a class="reference external" href=https://lanyrd.com/2013/djugl-june/>Lanyrd event page</a>.<p>Several people took photos of the event, I don’t remember …</section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content="debian,ubuntu,haproxy,nginx,spdy,ssl,ssl termination" itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-07-15T22:30:00+01:00 itemprop=datePublished> 15 Jul 2013 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'haproxy, nginx and SPDY with SSL termination (Debian 7)'" href=https://kura.gg/2013/07/15/haproxy-nginx-and-spdy-with-ssl-termination-debian-7/ itemprop=url rel=bookmark> haproxy, nginx and <span class=caps>SPDY</span> with <span class=caps>SSL</span> termination (Debian 7) </a></h2><section class=summary-content itemprop=articleBody><p><a class="reference external" href=/2013/07/10/nginx-spdy-and-ngx-pagespeed/>I wrote an article last week</a> explaining that I had changed my blog and built my own nginx packages with <a class="reference external" href=https://www.chromium.org/spdy><span class=caps>SPDY</span></a> built in.<p>I decided I would take things a little further and poke around with haproxy some more. The initial plan was to compile the latest dev source of haproxy with <span class=caps>SSL</span> termination enabled.<p>In doing so I realised I would lose <span class=caps>SPDY</span> support, which upset me a little. After some digging I found that the 1.5-dev branch of haproxy supports npn and thus can handle <span class=caps>SPDY</span>.<p>I tweaked my builds a little more and managed to get haproxy running as an <span class=caps>SSL</span> terminating load balancer, with <span class=caps>SPDY</span> connections being sent off to my nginx servers with <span class=caps>SPDY</span> enabled and all other non-<span class=caps>SPDY</span> connections were passed on to an nginx virtual host with <span class=caps>SPDY</span> disabled.<div class=section id=requirements><h2>Requirements</h2><p>I have released my haproxy build as a debian file below …</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=debian,ubuntu,nginx,spdy,pagespeed,ngx_pagespeed,mod_pagespeed itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-07-10T22:30:00+01:00 itemprop=datePublished> 10 Jul 2013 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'nginx, SPDY and ngx_pagespeed (Debian/Ubuntu)'" href=https://kura.gg/2013/07/10/nginx-spdy-and-ngx-pagespeed/ itemprop=url rel=bookmark> nginx, <span class=caps>SPDY</span> and ngx_pagespeed (Debian/Ubuntu) </a></h2><section class=summary-content itemprop=articleBody><p>I decided to rebuild syslog.tv as pure <span class=caps>HTML</span> using <span class=caps>RST</span> and <a class="reference external" href=https://blog.getpelican.com/>Pelican</a> and rebrand it as kura.gg.<p>In doing so I decided I would go all out and use <a class="reference external" href=https://www.chromium.org/spdy><span class=caps>SPDY</span></a> and <a class="reference external" href=https://nginx.org/en/docs/http/ngx_http_spdy_module.html>ngx_pagespeed</a> (<a class="reference external" href=https://developers.google.com/speed/>mod_pagespeed</a>) for fun to see exactly what I could do.<p>Sadly no version of nginx has been officially released with <span class=caps>SPDY</span> or ngx_pagespeed enabled, you can compile nginx from source to enable <span class=caps>SPDY</span> so I thought I would go ahead and do it, releasing some Debian packages in the process.<p>After compiling nginx from the source package available at the <a class="reference external" href=https://launchpad.net/~nginx>Ubuntu <span class=caps>PPA</span></a>, I decided I would go further and compile in ngx_pagespeed.<div class=section id=installing><h2>Installing</h2><p>I have released the 4 required debian packages below (please note they are only available for amd64);<table class=docutils><thead><tr><th class=head><span class=caps>FILE</span><th class=head><span class=caps>GPG</span><th class=head><span class=caps>MD5</span><th class=head><span class=caps>SHA1</span><tbody><tr><td><a class="reference external" href=/files/nginx_1.4.1_all.deb>nginx_1.4.1_all.deb</a><td><a class="reference external" href=/files/nginx_1.4.1_all.deb.asc>owGMl1NwLw…</a><td><a class="reference external" href=/files/nginx_1.4.1_all.deb.md5>42f790a1f6…</a><td><a class="reference external" href=/files/nginx_1.4.1_all.deb.sha1>f4495055e9…</a><tr><td><a class="reference external" href=/files/nginx-common_1.4.1_all.deb>nginx-common_1.4.1_all.deb</a><td><a class="reference external" href=/files/nginx-common_1.4.1_all.deb.asc>owGMt1NwJU…</a><td><a class="reference external" href=/files/nginx-common_1.4.1_all.deb.md5>ca4ec5688d…</a><td><a class="reference external" href=/files/nginx-common_1.4.1_all.deb.sha1>633bfc2eaa…</a><tr><td><a class="reference external" href=/files/nginx-full_1.4.1_amd64.deb>nginx-full_1.4.1_amd64.deb</a><td><a class="reference external" href=/files/nginx-full_1.4.1_amd64.deb.asc>owG09ndUk1…</a><td><a class="reference external" href=/files/nginx-full_1.4.1_amd64.deb.md5>4776dc6c7f…</a><td><a class="reference external" href=/files/nginx-full_1.4.1_amd64.deb.sha1>0e4e124acc…</a><tr><td><a class="reference external" href=/files/nginx-doc_1.4.1_all.deb>nginx-doc_1 …</a></table></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content="autocompletion,bash,port forwarding" itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2013-03-12T18:00:00+00:00 itemprop=datePublished> 12 Mar 2013 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Bash portforwarding with autocompletion'" href=https://kura.gg/2013/03/12/bash-portforwarding-with-autocompletion/ itemprop=url rel=bookmark> Bash portforwarding with autocompletion </a></h2><section class=summary-content itemprop=articleBody><p>I spend a <span class=caps>LOT</span> of time with tunnels open to multiple machines, connecting directly to PostgreSQL, RabbitMQ and many other services all via <span class=caps>SSH</span>.<p>I have written several helper functions and this is the final version that I created in a small competition with <a class="reference external" href=https://twitter.com/codeinthehole>@codeinthehole.</a><p>Gist removed. Sorry.<div class=section id=installation><h2>Installation</h2><p>Simply add the contents to <em>~/.bashrc</em></div><div class=section id=usage><h2>Usage</h2><p>Usage is pretty simply, just called portforward from the command line, pressing <<span class=caps>TAB</span>> as you type in a server name from your ~/.ssh/config file and the same with the port.<div class=highlight><pre><span></span>portforward<span class=w> </span>sy&LTTAB>
</pre></div><p>Will become:<div class=highlight><pre><span></span>portforward<span class=w> </span>syslog.tv
</pre></div><p>And finally<div class=highlight><pre><span></span>portforward<span class=w> </span>syslog.tv<span class=w> </span><span class=m>15672</span>
</pre></div></div></section></article><div class=eevee-page-spacer role=presentation></div></div></div></main><div class="eevee-pagination__container eevee-container mdl-grid"><div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone" role=presentation></div><div class="mdl-color-text--grey-800 mdl-cell mdl-cell--8-col"><nav class="eevee-pagination mdl-cell mdl-cell--12-col" aria-label=Pagination itemscope itemtype=http://schema.org/SiteNavigationElement><div class=eevee-spacer></div></nav></div></div><footer class=mdl-mega-footer itemscope itemtype=http://schema.org/SiteNavigationElement><div class=mdl-mega-footer--top-section><div class=mdl-mega-footer--drop-down-section><ul class=mdl-mega-footer--link-list><li><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></ul></div></div><div aria-label="Footer navigation" class=mdl-mega-footer--middle-section itemscope itemtype=http://schema.org/SiteNavigationElement><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Menu</h1><ul class=mdl-mega-footer--link-list><li><a href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons></i> Contact </a><li><a href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons></i> Archives </a><li><a href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons></i> RSS </a><li><a href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons></i> Atom </a></ul></div><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Social</h1><ul class=mdl-mega-footer--link-list><li><a href=https://github.com/kura itemprop=url rel=bookmark title=GitHub> <i aria-hidden=true class=fa></i> Github </a><li><a href=https://noc.social/@kura itemprop=url rel=me title=@kura@noc.social> <i aria-hidden=true class=fa>🦣</i> @kura@noc.social </a></ul></div><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Links</h1><ul class=mdl-mega-footer--link-list><li><a href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons></i> Blackhole </a><li><a href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons></i> Eevee </a><li><a href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons></i> Hauntr </a><li><a href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons></i> Ghastly </a><li><a title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons></i> Pelican Plugins </a></ul></div></div><div class=mdl-mega-footer--bottom-section><div class=mdl-logo><a href=https://kura.gg itemprop=url rel=bookmark title=kura.gg> kura.gg </a></div><ul class="eevee-footer mdl-mega-footer--link-list"><li>Powered by love & rainbow sparkles.<li>Source code and content released under the <a title="MIT license" href=/license/>MIT license</a>.</ul></div></footer></div>