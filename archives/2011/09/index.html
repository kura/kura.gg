<!doctype html><html lang=en><meta charset=utf-8><meta content=width=device-width,initial-scale=1.0,minimum-scale=1.0 name=viewport><link href=https://kura.gg hreflang=en rel=alternate><link href=https://kura.gg rel=dns-prefetch><link href=https://kura.gg/theme/css/eevee.min.css?1c9d8344 rel=stylesheet><script async src=https://kura.gg/theme/js/eevee.min.js?1841d254></script><link href=https://kura.gg/feeds/rss.xml rel=alternate title=kura.gg type=application/rss+xml><link href=https://kura.gg/feeds/atom.xml rel=alternate title=kura.gg type=application/atom+xml><meta content=kura.gg property=og:site_name><meta content=article property=og:type><meta content=kura.gg property=og:title><meta content=https://kura.gg/archives/2011/09/index.html property=og:url><meta content=https://kura.gg/archives/2011/09/index.png property=og:image><meta content=1920 property=og:image:width><meta content=1080 property=og:image:height><meta content=kura.gg property=twitter:title><meta content=https://kura.gg/archives/2011/09/index.html property=twitter:url><meta content=https://kura.gg/archives/2011/09/index.png property=twitter:image><meta content=summary_large_image property=twitter:card><meta content=1920 property=twitter:image:width><meta content=1080 property=twitter:image:height><link sizes="16x16 32x32 48x48 64x64 128x128 256x256" href=/favicon.png rel=icon type=image/png><link sizes="16x16 32x32 48x48 64x64 128x128 256x256" href=/favicon.ico rel=icon type=image/vnd.microsoft.icon><title>Archives for September 2011</title><body><div class="eevee-layout mdl-layout mdl-js-layout mdl-color--grey-50"><header class="eevee-header mdl-color--grey-50 mdl-color-text--grey-800" itemscope itemtype=http://schema.org/WPHeader><div class=mdl-layout__header-row><div class="mdl-layout__drawer-button mdl-color-text--accent eevee-mobile-button mdl-layout--small-screen-only" aria-expanded=false role=button tabindex=0><i class=material-icons>î—’</i></div><span class="eevee-logo mdl-color-text--accent mdl-layout-title"> <h2 id=top><a href=https://kura.gg rel=bookmark title=kura.gg> kura.gg </a></h2> </span><div class=mdl-layout-spacer role=presentation></div><nav aria-label="Header navigation" class="eevee-nav mdl-navigation mdl-layout--large-screen-only" itemscope itemtype=http://schema.org/SiteNavigationElement><a class="mdl-color-text--accent mdl-navigation__link" href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons>î¡¯</i> Blackhole </a><a class="mdl-color-text--accent mdl-navigation__link" href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons>î¡±</i> Eevee </a><a class="mdl-color-text--accent mdl-navigation__link" href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons>î¡±</i> Hauntr </a><a class="mdl-color-text--accent mdl-navigation__link" href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons>î¡±</i> Ghastly </a><a class="mdl-color-text--accent mdl-navigation__link" title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons>î¡¯</i> Pelican Plugins </a><a class="mdl-color-text--accent mdl-navigation__link" href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons>î‚·</i> Contact </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons>î€¯</i> Archives </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons>îƒ¥</i> RSS </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons>îƒ¥</i> Atom </a></nav></div></header><div class="eevee-mobile-header mdl-layout__drawer mdl-color--white" aria-hidden=true><span class=mdl-layout-title> <h2 class="eevee-mobile-logo mdl-color-text--accent">kura.gg</h2> </span><div class="mdl-navigation mdl-color--white"><nav aria-label="Header navigation" class="eevee-nav mdl-navigation" itemscope itemtype=http://schema.org/SiteNavigationElement><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons> î¢Š </i> Home </a><a class="mdl-color-text--accent mdl-navigation__link" href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons>î¡¯</i> Blackhole </a><a class="mdl-color-text--accent mdl-navigation__link" href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons>î¡±</i> Eevee </a><a class="mdl-color-text--accent mdl-navigation__link" href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons>î¡±</i> Hauntr </a><a class="mdl-color-text--accent mdl-navigation__link" href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons>î¡±</i> Ghastly </a><a class="mdl-color-text--accent mdl-navigation__link" title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons>î¡¯</i> Pelican Plugins </a><a class="mdl-color-text--accent mdl-navigation__link" href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons>î‚·</i> Contact </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons>î€¯</i> Archives </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons>îƒ¥</i> RSS </a><a class="mdl-color-text--accent mdl-navigation__link" href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons>îƒ¥</i> Atom </a></nav></div></div><div class="eevee-ribbon mdl-color--primary-dark" role=presentation></div><main class="eevee-main mdl-layout__content"><div class="eevee-container mdl-grid"><div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone" role=presentation></div><div aria-label="Main content" class="eevee-content mdl-color--white mdl-shadow--2dp mdl-color-text--grey-800 mdl-cell mdl-cell--8-col"><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=apache2,nginx,wordpress,wp-super-cache itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-09-30T23:21:00+01:00 itemprop=datePublished> 30 Sep 2011 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'nginx config for reverse proxying Wordpress & WP Super Cache and keeping the load offÂ Apache2'" href=https://kura.gg/2011/09/30/nginx-config-for-reverse-proxying-wordpress-wp-super-cache-and-keeping-the-load-off-apache2/ itemprop=url rel=bookmark> nginx config for reverse proxying Wordpress <span class=amp>&</span> <span class=caps>WP</span> Super Cache and keeping the load offÂ Apache2 </a></h2><section class=summary-content itemprop=articleBody><div class=section id=the-point><h2>TheÂ point</h2><p>The whole point of this is to get as much load off of Apache as possible to keep the server running nice andÂ smoothly.</div><div class=section id=configuration><h2>Configuration</h2><p>The configuration below will mean that nginx will serve basicallyÂ everything;<ul class=simple><li>staticÂ files<li>uploaded filesÂ and<li>cachedÂ content</ul><p>simply replace the <strong><span class=caps>VARIABLES</span></strong> below and everything should be good to go, if copy-pasting from below isnâ€™t working properly you can download a full copy from <a class="reference external" href=/files/2011/09/server.txt>here</a>.<div class=highlight><pre><span></span><span class=k>server</span><span class=w> </span><span class=p>{</span>
<span class=w>  </span><span class=kn>listen</span><span class=w> </span><span class=mi>80</span><span class=p>;</span>
<span class=w>  </span><span class=kn>server_name</span><span class=w> </span><span class=s>**DOMAIN_HERE**</span><span class=p>;</span>
<span class=w>  </span><span class=kn>access_log</span><span class=w> </span><span class=s>/var/log/nginx/access.**DOMAIN_HERE**.log</span><span class=p>;</span>

<span class=w>  </span><span class=kn>gzip</span><span class=w> </span><span class=no>on</span><span class=p>;</span>
<span class=w>  </span><span class=kn>gzip_disable</span><span class=w> </span><span class=s>msie6</span><span class=p>;</span><span class=w> </span><span class=c1># disable gzip for IE6</span>
<span class=w>  </span><span class=kn>gzip_static</span><span class=w> </span><span class=no>on</span><span class=p>;</span>
<span class=w>  </span><span class=kn>gzip_comp_level</span><span class=w> </span><span class=mi>9</span><span class=p>;</span><span class=w> </span><span class=c1># highest level of compression</span>
<span class=w>  </span><span class=kn>gzip_proxied</span><span class=w> </span><span class=s>any</span><span class=p>;</span>
<span class=w>  </span><span class=kn>gzip_types</span><span class=w> </span><span class=s>text/plain</span><span class=w> </span><span class=s>text/css</span><span class=w> </span><span class=s>application/x-javascript</span><span class=w> </span><span class=s>text/xml</span><span class=w> </span><span class=s>application/xml</span><span class=w> </span><span class=s>application/xml+rss</span><span class=w> </span><span class=s>text/javascript</span><span class=p>;</span>

<span class=w>  </span><span class=kn>proxy_redirect</span><span class=w> </span><span class=no>off</span><span class=p>;</span>
<span class=w>  </span><span class=kn>proxy_set_header</span><span class=w> </span><span class=s>Host</span><span class=w> </span><span class=nv>$host</span><span class=p>;</span>
<span class=w>  </span><span class=kn>proxy_set_header</span><span class=w> </span><span class=s>X-Real-IP</span><span class=w> </span><span class=nv>$remote_addr</span><span class=p>;</span>
<span class=w>  </span><span class=kn>proxy_set_header</span><span class=w> </span><span class=s>X-Forwarded-For</span><span class=w> </span><span class=nv>$proxy_add_x_forwarded_for</span><span class=p>;</span>
<span class=w>  </span><span class=kn>proxy_pass_header</span><span class=w> </span><span class=s>Set-Cookie</span><span class=p>;</span><span class=kn>root</span><span class=w> </span><span class=s>**/PATH/TO/WORDPRESS**</span><span class=p>;</span>

<span class=w>  </span><span class=c1># default location, used for the basic proxying</span>
<span class=w>  </span><span class=kn>location</span><span class=w> </span><span class=s>/</span><span class=w> </span><span class=p>{</span>
<span class=w>    </span><span class=c1># if we're requesting a file and â€¦</span></pre></div></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content="http,https,load,load balancing,pound,ssl,ssl offloading,ssl termination" itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-09-29T23:15:00+01:00 itemprop=datePublished> 29 Sep 2011 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Load balancing HTTP/HTTPS with Pound on DebianÂ 6/Ubuntu'" href=https://kura.gg/2011/09/29/load-balancing-httphttps-with-pound-on-debian-6ubuntu/ itemprop=url rel=bookmark> Load balancing <span class=caps>HTTP</span>/<span class=caps>HTTPS</span> with Pound on DebianÂ 6/Ubuntu </a></h2><section class=summary-content itemprop=articleBody><p>Pound is a great little load balancer, itâ€™s fast, opensource and supports <span class=caps>SSL</span> termination, which isÂ great!<div class=section id=install><h2>Install</h2><div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>pound
</pre></div></div><div class=section id=configuration><h2>Configuration</h2><p>The default configuration should be pretty good for most purposes, but feel free to tweak as youÂ require.<div class=section id=http><h3><span class=caps>HTTP</span></h3><p>Weâ€™ll first look at load balancing <span class=caps>HTTP</span>, in case you donâ€™t want or need <span class=caps>HTTPS</span> loadÂ balancing.<p>Weâ€™ll need delete all the content within <em>ListenHTTP</em> block, once done it should look likeÂ this<pre class=literal-block>
ListenHTTP
End
</pre><p>Now we add an address and port to listen on and finally a line to remove an <span class=caps>HTTP</span>Â header<pre class=literal-block>
ListenHTTP
    Address 0.0.0.0 # all interfaces
    Port 80
    HeadRemove "X-Forwarded-For"
End
</pre><p>This is a basic configuration, for each backend we want to load balance weâ€™ll need to add a service within thatÂ listener.<p>Youâ€™ll notice weâ€™re removing incoming headers called <em>X-Forwarded-For</em>, this is to make â€¦</div></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=debian,email,greylist,mail,postfix,postgrey,spam,ubuntu itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-09-24T21:29:00+01:00 itemprop=datePublished> 24 Sep 2011 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Postfix spam protection with greylisting using Postgrey on DebianÂ 6/Ubuntu'" href=https://kura.gg/2011/09/24/postfix-spam-protection-with-greylisting-using-postgrey-on-debian-6ubuntu/ itemprop=url rel=bookmark> Postfix spam protection with greylisting using Postgrey on DebianÂ 6/Ubuntu </a></h2><section class=summary-content itemprop=articleBody><p>A simple yet effective method for protecting your mail server from spam is to use greylisting. In simple terms, when an email is received the server will temporarily reject it with a 450 response code claiming that the server is busy, the sending server should then attempt to try to deliver at a later point in time, if enough time has passed the recipient server will then accept the incoming mail and whitelist the send address for a period ofÂ time.<p>This is effective because most spam servers are configured not to retry the send whereas real mail servers generally will retry. This sadly does not protect against spam coming from comprised mail servers or accounts like onÂ Hotmail.com.<div class=section id=installation><h2>Installation</h2><div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>postgrey
</pre></div></div><div class=section id=configuring-postgrey><h2>ConfiguringÂ Postgrey</h2><p>By default Postgrey runs on <em>127.0.0.1:60000</em>, which is the local loopback interface so it is not exposed to the â€¦</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=blackhole,blacklist,email,mail,postfix,spam itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-09-24T21:05:00+01:00 itemprop=datePublished> 24 Sep 2011 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Postfix spam protection withÂ blacklists'" href=https://kura.gg/2011/09/24/postfix-spam-protection-with-blacklists/ itemprop=url rel=bookmark> Postfix spam protection withÂ blacklists </a></h2><section class=summary-content itemprop=articleBody><p>This really should be quite a quick and simpleÂ post.<p>I use several tools to protect my mail servers from spam, the most effective of these Iâ€™ve found is using external lists in conjunction with <strong>reject_rbl_client</strong> and <strong>reject_rhsbl_client</strong>.<p>+======================+======================================================================================================+ | Service | description | +======================+======================================================================================================+ | zen.spamhaus.org | A single lookup for querying the <span class=caps>SBL</span>, <span class=caps>XBL</span> and <span class=caps>PBL</span> databases. | | | - <span class=caps>SBL</span> - Verified sources of spam, including spammers and their support services | | | - <span class=caps>XBL</span> - Illegal third-party exploits (e.g. open proxies and Trojan Horses) | | | - <span class=caps>PBL</span> - Static, dial-up <span class=amp>&</span> <span class=caps>DHCP</span> <span class=caps>IP</span> address space that is not meant to be initiating <span class=caps>SMTP</span> connections | +â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+ | dnsbl.sorbs.net | Unsolicited bulk/commercial email senders | +â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+ | spam.dnsbl.sorbs.net | Hosts that have allegedly sent spam to the admins of <span class=caps>SORBS</span> at any time | +â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+ | b1.spamcop.net | <span class=caps>IP</span> addresses which have been used to transmit reported email to SpamCop users | +â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”+ | rhsbl.ahbl.org | Domains sending spam, domains owned by spammers, comment spam domains, spammed URLs â€¦</section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=email,mail,postfix,pyzor,razor,spam,spamassassin itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-09-22T19:17:00+01:00 itemprop=datePublished> 22 Sep 2011 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'SpamAssassin + Razor + Pyzor on DebianÂ 6/Ubuntu'" href=https://kura.gg/2011/09/22/spamassassin-razor-pyzor/ itemprop=url rel=bookmark> SpamAssassin + Razor + Pyzor on DebianÂ 6/Ubuntu </a></h2><section class=summary-content itemprop=articleBody><p>This is part 4 of my series on configuring a mail server, please see <a class="reference external" href=/2011/09/15/postfix-dovecot-imapimaps-sasl-maildir/>part one</a>, <a class="reference external" href=/2011/09/16/postfix-spamassassin-clamav-procmail/>part two</a> and <a class="reference external" href=/2011/09/17/postfix-dk-dkim-spf/>part three</a> if youâ€™re not familiar withÂ them.<p>The content of this article was written to work with the previous three articles but should work on any SpamAssassinÂ set-up.<div class=section id=razor><h2>Razor</h2><p>First off we need to installÂ Razor.<div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>razor
</pre></div><p>Now we need to run three commands to register and configureÂ Razor.<div class=highlight><pre><span></span>sudo<span class=w> </span>razor-admin<span class=w> </span>-home<span class=o>=</span>/etc/spamassassin/.razor<span class=w> </span>-register
sudo<span class=w> </span>razor-admin<span class=w> </span>-home<span class=o>=</span>/etc/spamassassin/.razor<span class=w> </span>-create
sudo<span class=w> </span>razor-admin<span class=w> </span>-home<span class=o>=</span>/etc/spamassassin/.razor<span class=w> </span>-discover
</pre></div><p>These 3 commands should be pretty self explanatory, they register Razor, create itâ€™s configuration and discover the RazorÂ servers.</div><div class=section id=pyzor><h2>Pyzor</h2><p>Now weâ€™ll installÂ Pyzor.<div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>pyzor
</pre></div><p>Now we also need to tell Pyzor to discover itâ€™sÂ servers.<div class=highlight><pre><span></span>pyzor<span class=w> </span>--homedir<span class=w> </span>/etc/mail/spamassassin<span class=w> </span>discover
</pre></div></div><div class=section id=spamassassin><h2>SpamAssassin</h2><p>Add the following lines to the end â€¦</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=apt,debian,security,ubuntu,upgrades itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-09-21T13:21:00+01:00 itemprop=datePublished> 21 Sep 2011 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Debian/Ubuntu upgrade security packages only - a better way to doÂ it'" href=https://kura.gg/2011/09/21/debianubuntu-upgrade-security-packages-only-a-better-way-to-do-it/ itemprop=url rel=bookmark> Debian/Ubuntu upgrade security packages only - a better way to doÂ it </a></h2><section class=summary-content itemprop=articleBody><p><strong>I have created a scripts that handle these tasks for you, availableÂ `here`_.</strong><p>First thing we need to do is create an sources list specifically forÂ security.<div class=highlight><pre><span></span>sudo<span class=w> </span>grep<span class=w> </span><span class=s2>"-security"</span><span class=w> </span>/etc/apt/sources.list<span class=w> </span><span class=p>|</span><span class=w> </span>sudo<span class=w> </span>grep<span class=w> </span>-v<span class=w> </span><span class=s2>"#"</span><span class=w> </span>><span class=w> </span>/etc/apt/security.sources.list
</pre></div><p>Now that this is done we can simply continue to use the command below to trigger security-onlyÂ upgrades<div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>upgrade<span class=w> </span>-o<span class=w> </span>Dir::Etc::SourceList<span class=o>=</span>/etc/apt/security.sources.list
</pre></div><div class=section id=note><h2>Note</h2><p><strong>This will work until you upgrade your distro (e.g. 10.04 -> 12.04), at which point you will need to re-run the first command to regenerate the security.sources.listÂ file.</strong></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=debian,dk,dkim,domainkeys,email,mail,postfix,spf,ubuntu itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-09-17T18:18:00+01:00 itemprop=datePublished> 17 Sep 2011 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Postfix + DK (DomainKeys) + DKIM + SPF on DebianÂ 6/Ubuntu'" href=https://kura.gg/2011/09/17/postfix-dk-dkim-spf/ itemprop=url rel=bookmark> Postfix + <span class=caps>DK</span> (DomainKeys) + <span class=caps>DKIM</span> + <span class=caps>SPF</span> on DebianÂ 6/Ubuntu </a></h2><section class=summary-content itemprop=articleBody><p>This is part 3 of my guide to getting a mail server configured with all the sexy bits to improve deliverability, spam and virusÂ protection.<p>You can view <a class="reference external" href=/2011/09/15/postfix-dovecot-imapimaps-sasl-maildir/>part 1 here</a> and <a class="reference external" href=/2011/09/16/postfix-spamassassin-clamav-procmail/>part 2 here</a>.<div class=section id=the-key-pair><h2>The keyÂ pair</h2><p>We need to create a key pair to sign emailsÂ with:<pre class=literal-block>
.. code-block:: bash
</pre><blockquote>openssl genrsa -out private.key 1024 openssl rsa -in private.key -out public.key -pubout -outform <span class=caps>PEM</span> sudo mkdir /etc/dk/ sudo cp private.key /etc/dk/dk.key</blockquote><p>Now we can move on to <span class=caps>DK</span> and <span class=caps>DKIM</span> signing, make sure you keep the public key forÂ later.</div><div class=section id=dkim><h2><span class=caps>DKIM</span></h2><p>First weâ€™ll need to install an application to sign ourÂ emails.<div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>dkim-filter
</pre></div><p>Once installed we need to configure it, open up <strong>/etc/default/dkim-filter</strong>, modify the file to look like below replacing <<span class=caps>DOMAIN</span>> with the domain you want to sign emailÂ from.<div class=highlight><pre><span></span><span class=nv>DAEMON_OPTS</span><span class=o>=</span><span class=s2>"-l -o X-DomainKeys â€¦</span></pre></div></div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=clamav,clamsmtp,debian,email,mail,postfix,procmail,spamassassin,ubuntu itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-09-16T21:28:00+01:00 itemprop=datePublished> 16 Sep 2011 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Postfix + SpamAssassin + ClamAV + Procmail on DebianÂ 6/Ubuntu'" href=https://kura.gg/2011/09/16/postfix-spamassassin-clamav-procmail/ itemprop=url rel=bookmark> Postfix + SpamAssassin + ClamAV + Procmail on DebianÂ 6/Ubuntu </a></h2><section class=summary-content itemprop=articleBody><p>This is part 2 of my series on mail servers on Debian 6/Ubuntu 10.04, it should work on other versions of each though. <a class="reference external" href=/2011/09/15/postfix-dovecot-imapimaps-sasl-maildir/>Part 1 is available here</a>.<div class=section id=spamassassin><h2>SpamAssassin</h2><p>First off weâ€™ll get SpamAssassin installed andÂ configured.<div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>spamassassin
</pre></div><p>Weâ€™ll be configuring SpamAssassin as a daemon that Postfix interfaces with using <strong>spamc</strong>.<p>SpamAssassin on Debian and Ubuntu runs as root which is <span class=caps>NOT</span> a good thing so weâ€™ll need to make someÂ changes.<p>Weâ€™ll add a group called <strong>spamd</strong> with <span class=caps>GID</span>**5001**.<div class=highlight><pre><span></span>sudo<span class=w> </span>groupadd<span class=w> </span>-g<span class=w> </span><span class=m>5001</span><span class=w> </span>spamd
</pre></div><p>Next we add a user spamd with <span class=caps>UID</span> <strong>5001</strong> and add it to the spamd group, as well as set itâ€™s home directory as <strong>/var/lib/spamassassin</strong> and make sure it has no shell access or <span class=caps>SSH</span>Â access.<div class=highlight><pre><span></span>sudo<span class=w> </span>useradd<span class=w> </span>-u<span class=w> </span><span class=m>5001</span><span class=w> </span>-g<span class=w> </span>spamd<span class=w> </span>-s<span class=w> </span>/usr/sbin/nologin<span class=w> </span>-d<span class=w> </span>/var/lib/spamassassin<span class=w> </span>spamd
</pre></div><p>Now â€¦</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=debian,dovecot,email,imap,imaps,mail,maildir,postfix,sasl,ubuntu itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-09-15T23:04:00+01:00 itemprop=datePublished> 15 Sep 2011 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Postfix + Dovecot (IMAP/IMAPS) + SASL + Maildir on DebianÂ 6/Ubuntu'" href=https://kura.gg/2011/09/15/postfix-dovecot-imapimaps-sasl-maildir/ itemprop=url rel=bookmark> Postfix + Dovecot (<span class=caps>IMAP</span>/<span class=caps>IMAPS</span>) + <span class=caps>SASL</span> + Maildir on DebianÂ 6/Ubuntu </a></h2><section class=summary-content itemprop=articleBody><p>This guide is part 1 of what I plan will be a couple of guides that take you through installing a base mail system, SpamAssassin, <span class=caps>DKIM</span> and much more. StayÂ tuned.<p>This guide was written for Debian 6 but should be the same or similar for Debian 5 and Ubuntu 10.04 andÂ above.<div class=section id=the-installation><h2>TheÂ installation</h2><div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>dovecot-imapd<span class=w> </span>postfix<span class=w> </span>sasl2-bin<span class=w> </span>libsasl2-2<span class=w> </span>libsasl2-modules
</pre></div><p>Choose â€œInternet siteâ€ when prompted and enter the fully qualified name of yourÂ server.<p>Once all this is done installing weâ€™ll need to make some changes, first off will beÂ Postfix.</div><div class=section id=postfix><h2>Postfix</h2><p>Open up <strong>/etc/postfix/main.cf</strong> and add the following to the end of theÂ file<pre class=literal-block>
home_mailbox = Maildir/
smtpd_sasl_auth_enable = yes
smtpd_sasl_security_options = noanonymous
smtpd_sasl_local_domain = $myhostname
broken_sasl_auth_clients = yes

smtpd_sender_restrictions = permit_sasl_authenticated,
    permit_mynetworks,

smtpd_recipient_restrictions = permit_mynetworks,
    permit_sasl_authenticated,
    reject_unauth_destination,
    reject_unknown_sender_domain,
</pre><p>Here we basically tell Postfix to store all email in maildir format in the userâ€™s home directory. We â€¦</div></section><div class="eevee-divider mdl-color--accent" role=presentation></div><div class=eevee-divider-to-top><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></div></article><article class=eevee-padding itemscope itemtype=http://schema.org/BlogPosting><meta content=fullKeyboardControl itemprop=accessibilityControl><meta content=fullMouseControl itemprop=accessibilityControl><meta content=bookmarks itemprop=accessibilityControl><meta content=captions itemprop=accessibilityControl><meta content=alternativeText itemprop=accessibilityControl><meta content=index itemprop=accessibilityControl><meta content=readingOrder itemprop=accessibilityControl><meta content=structuralNavigation itemprop=accessibilityControl><meta content=tableOfContents itemprop=accessibilityControl><meta content=noFlashingHazard itemprop=accessibilityHazard><meta content=noMotionSimulationHazard itemprop=accessibilityHazard><meta content=noSoundHazard itemprop=accessibilityHazard><meta content=ARIA itemprop=accessibilityAPI><div itemprop=author itemscope itemtype=https://schema.org/Person role=presentation><a class=hidden href=https://kura.gg/authors/kura/ itemprop=url role=presentation> <span class=hidden itemprop=name role=presentation> kura </span> </a></div><meta content=apt,apt-get,debian,headers,kernel,ubuntu itemprop=keywords><meta content=tutorials itemprop=keywords><div class="eevee-meta mdl-color-text--grey-500"><time datetime=2011-09-15T13:30:00+01:00 itemprop=datePublished> 15 Sep 2011 </time></div><h2 class=article-title itemprop=name><a title="Permalink to 'Installing kernel headers for current kernel version with ease onÂ Debian/Ubuntu'" href=https://kura.gg/2011/09/15/installing-kernel-headers-for-current-kernel-version-with-ease-on-debianubuntu/ itemprop=url rel=bookmark> Installing kernel headers for current kernel version with ease onÂ Debian/Ubuntu </a></h2><section class=summary-content itemprop=articleBody><p>This is a simple one but I found out that there are people out there that donâ€™t know about it, so here weÂ go.<div class=highlight><pre><span></span>sudo<span class=w> </span>apt-get<span class=w> </span>install<span class=w> </span>linux-headers-<span class=k>$(</span>uname<span class=w> </span>-r<span class=k>)</span>
</pre></div><p>This will install kernel headers for your current active kernel onÂ Debian/Ubuntu.</section></article><div class=eevee-page-spacer role=presentation></div></div></div></main><div class="eevee-pagination__container eevee-container mdl-grid"><div class="mdl-cell mdl-cell--2-col mdl-cell--hide-tablet mdl-cell--hide-phone" role=presentation></div><div class="mdl-color-text--grey-800 mdl-cell mdl-cell--8-col"><nav class="eevee-pagination mdl-cell mdl-cell--12-col" aria-label=Pagination itemscope itemtype=http://schema.org/SiteNavigationElement><div class=eevee-spacer></div></nav></div></div><footer class=mdl-mega-footer itemscope itemtype=http://schema.org/SiteNavigationElement><div class=mdl-mega-footer--top-section><div class=mdl-mega-footer--drop-down-section><ul class=mdl-mega-footer--link-list><li><a title="Back to the top of the page" href=#top itemprop=url> Back to the top of the page </a></ul></div></div><div aria-label="Footer navigation" class=mdl-mega-footer--middle-section itemscope itemtype=http://schema.org/SiteNavigationElement><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Menu</h1><ul class=mdl-mega-footer--link-list><li><a href=/contact/ itemprop=url rel=bookmark title=Contact> <i aria-hidden=true class=material-icons>î‚·</i> Contact </a><li><a href=https://kura.gg/archives/ itemprop=url rel=bookmark title=Archives> <i class=material-icons>î€¯</i> Archives </a><li><a href=https://kura.gg/feeds/rss.xml itemprop=url title=RSS> <i class=material-icons>îƒ¥</i> RSS </a><li><a href=https://kura.gg/feeds/atom.xml itemprop=url title=Atom> <i class=material-icons>îƒ¥</i> Atom </a></ul></div><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Social</h1><ul class=mdl-mega-footer--link-list><li><a href=https://github.com/kura itemprop=url rel=bookmark title=GitHub> <i aria-hidden=true class=fa>ï‚›</i> Github </a><li><a href=https://noc.social/@kura itemprop=url rel=me title=@kura@noc.social> <i aria-hidden=true class=fa>ğŸ¦£</i> @kura@noc.social </a></ul></div><div class=mdl-mega-footer--drop-down-section><h1 class=mdl-mega-footer--heading>Links</h1><ul class=mdl-mega-footer--link-list><li><a href=/blackhole itemprop=url rel=bookmark title=Blackhole> <i aria-hidden=true class=material-icons>î¡¯</i> Blackhole </a><li><a href=/eevee itemprop=url rel=bookmark title=Eevee> <i aria-hidden=true class=material-icons>î¡±</i> Eevee </a><li><a href=/hauntr itemprop=url rel=bookmark title=Hauntr> <i aria-hidden=true class=material-icons>î¡±</i> Hauntr </a><li><a href=/ghastly itemprop=url rel=bookmark title=Ghastly> <i aria-hidden=true class=material-icons>î¡±</i> Ghastly </a><li><a title="Pelican Plugins" href=/pelican-plugins itemprop=url rel=bookmark> <i aria-hidden=true class=material-icons>î¡¯</i> Pelican Plugins </a></ul></div></div><div class=mdl-mega-footer--bottom-section><div class=mdl-logo><a href=https://kura.gg itemprop=url rel=bookmark title=kura.gg> kura.gg </a></div><ul class="eevee-footer mdl-mega-footer--link-list"><li>Powered by love & rainbow sparkles.<li>Source code and content released under the <a title="MIT license" href=/license/>MIT license</a>.</ul></div></footer></div>